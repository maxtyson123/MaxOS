<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Max OS: /home/runner/work/MaxOS/MaxOS/kernel/src/drivers/ethernet/intel_i217.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Max OS<span id="projectnumber">&#160;0.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('intel__i217_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">intel_i217.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="intel__i217_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="intel__i217_8h.html">drivers/ethernet/intel_i217.h</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="keyword">using namespace </span>MaxOS;</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="keyword">using namespace </span>MaxOS::common;</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="keyword">using namespace </span>MaxOS::drivers;</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="keyword">using namespace </span>MaxOS::drivers::ethernet;</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="keyword">using namespace </span>MaxOS::hardwarecommunication;</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="keyword">using namespace </span>memory;</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">// Buffer Sizes</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="intel__i217_8cpp.html#aa3ab55cb1937ef26708a01f9a2870909">   25</a></span><span class="preprocessor">#define buffer8192                 ((2 &lt;&lt; 16) | (1 &lt;&lt; 25))</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="foldopen" id="foldopen00033" data-start="{" data-end="}">
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#ae32e321ff591670236fe0b25986b0596">   33</a></span><a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#ae32e321ff591670236fe0b25986b0596">IntelI217::IntelI217</a>(<a class="code hl_class" href="classMaxOS_1_1hardwarecommunication_1_1PCIDeviceDescriptor.html">PCIDeviceDescriptor</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">device_descriptor</a>)</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>        : <a class="code hl_class" href="classMaxOS_1_1hardwarecommunication_1_1InterruptHandler.html">InterruptHandler</a>(0x20 + <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">device_descriptor</a>-&gt;interrupt) {</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="comment">//Set the registers</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    control_register = 0x0000;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    status_register = 0x0008;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    eprom_register = 0x0014;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    control_ext_register = 0x0018;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    interrupt_mask_register = 0x00D0;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    receive_control_register = 0x0100;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    receive_descriptor_low_register = 0x2800;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    receive_descriptor_high_register = 0x2804;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    receive_descriptor_length_register = 0x2808;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    receive_descriptor_head_register = 0x2810;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    receive_descriptor_tail_register = 0x2818;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    send_control_register = 0x0400;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    send_descriptor_low_register = 0x3800;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    send_descriptor_high_register = 0x3804;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    send_descriptor_length_register = 0x3808;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    send_descriptor_head_register = 0x3810;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    send_descriptor_tail_register = 0x3818;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="comment">// Get BAR0 type, io_base address and MMIO base address</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    bar_type = 1; <span class="comment">// deviceDescriptor -&gt; has_memory_base ? 0 : 1;  @todo Fix memory mapping from PCI as it is unable to get MAC from memory</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    port_base = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">device_descriptor</a>-&gt;port_base;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="comment">//TODO: memBase = deviceDescriptor -&gt; memory_base;</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    init_done = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    active = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="comment">// Clear eprom</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    eprom_present = detect_ee_prom();</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="keywordflow">if</span> (read_mac_address()) {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        own_mac = <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1EthernetDriver.html#a2cfbe13ac9f10a6f9dc0c065ca980cff">create_media_access_control_address</a>(mac_address[0], mac_address[1], mac_address[2], mac_address[3],</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>                                                      mac_address[4], mac_address[5]);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <a class="code hl_define" href="logger_8h.html#adf7b5d69e4c25995b3211b91b27f33b6">ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;ERROR, INIT FAILED, MAC ADDRESS NOT FOUND&quot;</span>);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    }</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 0x80; i++)               <span class="comment">//Loop through all the registers</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        write(0x5200 + i * 4, 0);     <span class="comment">//Clear the receive descriptor array</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>}</div>
</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>IntelI217::~IntelI217() = <span class="keywordflow">default</span>;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="keywordtype">void</span> IntelI217::write(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a> address, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> data)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="comment">//Note: These Ports/MemIO cant be init in the constructor like they normally would as it depends on wether the device is using IO or MemIO, and checking that in every function would be messy</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="keywordflow">if</span> (bar_type == 0) {                                             <span class="comment">// If the base address register is memory mapped</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <a class="code hl_class" href="classMaxOS_1_1memory_1_1MemIO32Bit.html">MemIO32Bit</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">data_mem</a>(mem_base + address);              <span class="comment">// Create a 32-bit memory class at the address</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">data_mem</a>.write(data);                                       <span class="comment">// write the data to the memory address</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <a class="code hl_class" href="classMaxOS_1_1hardwarecommunication_1_1Port32Bit.html">Port32Bit</a> command_port(port_base);            <span class="comment">// Create a 32 bit port at the address</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <a class="code hl_class" href="classMaxOS_1_1hardwarecommunication_1_1Port32Bit.html">Port32Bit</a> data_port(port_base + 4);           <span class="comment">// Create a 32 bit port at the address + 4</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        command_port.write(address);                     <span class="comment">// write the address to the command port</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        data_port.write(data);                                <span class="comment">// write the data to the data port</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    }</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>}</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> IntelI217::read(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a> address)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="comment">//Note: These Ports/MemIO cant be init in the constructor like they normally would as it depends on wether the device is using IO or MemIO, and checking that in every function would be messy</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <span class="keywordflow">if</span> (bar_type == 0) {                                             <span class="comment">// If the base address register is memory mapped</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <a class="code hl_class" href="classMaxOS_1_1memory_1_1MemIO32Bit.html">MemIO32Bit</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">data_mem</a>(mem_base + address);               <span class="comment">// Create a 32-bit memory class at the address</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">data_mem</a>.read();                                      <span class="comment">// read the data from the memory address</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <a class="code hl_class" href="classMaxOS_1_1hardwarecommunication_1_1Port32Bit.html">Port32Bit</a> command_port(port_base);            <span class="comment">// Create a 32 bit port at the address</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        <a class="code hl_class" href="classMaxOS_1_1hardwarecommunication_1_1Port32Bit.html">Port32Bit</a> data_port(port_base + 4);           <span class="comment">// Create a 32 bit port at the address + 4</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        command_port.write(address);                     <span class="comment">// write the address to the command port</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <span class="keywordflow">return</span> data_port.read();                              <span class="comment">// read the data from the data port</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    }</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>}</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="keywordtype">bool</span> IntelI217::detect_ee_prom() {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">val</a> = 0;                                   <span class="comment">// The value to be returned</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    write(eprom_register, 0x1);              <span class="comment">// Set the register to read the EEProm</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1000; i++)     <span class="comment">//Loop 1000 times or until the EEProm is detected</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    {</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">val</a> = read(0x0014);                    <span class="comment">// read the register</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">val</a> &amp; 0x10)</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>}</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> IntelI217::eeprom_read(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a> addr) {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a> data = 0;                                                              <span class="comment">// The data to be returned</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">tmp</a> = 0;                                                               <span class="comment">// A temporary variable</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keywordflow">if</span> (eprom_present)                                                              <span class="comment">// If the EEProm is detected</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        write(eprom_register, (1) | ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>) (addr) &lt;&lt; 8));         <span class="comment">// write the address to the register</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordflow">while</span> (!((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">tmp</a> = read(eprom_register)) &amp; (1 &lt;&lt; 4)));                 <span class="comment">// Wait for the EEProm to be ready</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        write(eprom_register, (1) | ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>) (addr) &lt;&lt; 2));        <span class="comment">// write the address to the register</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>        <span class="keywordflow">while</span> (!((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">tmp</a> = read(eprom_register)) &amp; (1 &lt;&lt; 1)));                <span class="comment">// Wait for the EEProm to be ready</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    }</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    data = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a>) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">tmp</a> &gt;&gt; 16) &amp; 0xFFFF);                                      <span class="comment">// Get the data from the register</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="keywordflow">return</span> data;                                                                  <span class="comment">// Return the data</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>}</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span><span class="keywordtype">bool</span> IntelI217::read_mac_address() {</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="keywordflow">if</span> (eprom_present)                                                                <span class="comment">//If the EPROM exists</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    {</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a>;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> = eeprom_read(</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>                0);                                                   <span class="comment">//read the m_first_memory_chunk 16 bits of the MAC address</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        mac_address[0] = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &amp;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>                         0xff;                                                  <span class="comment">//Get the m_first_memory_chunk 8 bits of the MAC address</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        mac_address[1] =</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &gt;&gt; 8;                                                   <span class="comment">//Get the second 8 bits of the MAC address</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> = eeprom_read(</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                1);                                                  <span class="comment">//read the second 16 bits of the MAC address</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        mac_address[2] =</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &amp; 0xff;                                                  <span class="comment">//Get the third 8 bits of the MAC address</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        mac_address[3] =</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &gt;&gt; 8;                                                   <span class="comment">//Get the fourth 8 bits of the MAC address</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> = eeprom_read(</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                2);                                                  <span class="comment">//read the third 16 bits of the MAC address</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        mac_address[4] =</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &amp; 0xff;                                                  <span class="comment">//Get the fifth 8 bits of the MAC address</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        mac_address[5] =</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &gt;&gt; 8;                                                   <span class="comment">//Get the sixth 8 bits of the MAC address</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    } <span class="keywordflow">else</span>    <span class="comment">//If there is no eprom then read from memory</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    {</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        <span class="keyword">auto</span>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">mem_base_mac_8</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) (mem_base +</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                                           0x5400);                   <span class="comment">//Get the base address of the MAC address</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <span class="keyword">auto</span>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">mem_base_mac_32</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>*) (mem_base + 0x5400);                <span class="comment">//Get the base address of the MAC address</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">mem_base_mac_32</a>[0] != 0) {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++)                                            <span class="comment">//Loop through the MAC address</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                mac_address[i] = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">mem_base_mac_8</a>[i];                                <span class="comment">//Get the MAC address</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        } <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>}</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span><span class="keywordtype">void</span> IntelI217::receive_init() {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>;                                                                                                          <span class="comment">//A pointer to the memory</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <a class="code hl_typedef" href="intel__i217_8h.html#a555ef0aa3df9c8d85d63af2f945553eb">receive_descriptor_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">descs</a>;                                                                                        <span class="comment">//A pointer to the receive descriptors</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) (<a class="code hl_function" href="classMaxOS_1_1memory_1_1MemoryManager.html#a983c849ff604367f7c8a0e70172bb331">MemoryManager::kmalloc</a>(</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="intel__i217_8h.html#a555ef0aa3df9c8d85d63af2f945553eb">receive_descriptor_t</a>) * 32 + 16));           <span class="comment">//Allocate memory for the receive descriptors</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">descs</a> = (<a class="code hl_typedef" href="intel__i217_8h.html#a555ef0aa3df9c8d85d63af2f945553eb">receive_descriptor_t</a>*) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>;                                                                                <span class="comment">//Set the pointer to the receive descriptors</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 32; i++) {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        receive_dsrctrs[i] = (<a class="code hl_typedef" href="intel__i217_8h.html#a555ef0aa3df9c8d85d63af2f945553eb">receive_descriptor_t</a>*) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">descs</a> + i * 16);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        receive_dsrctrs[i]-&gt;buffer_address = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) (<a class="code hl_function" href="classMaxOS_1_1memory_1_1MemoryManager.html#a983c849ff604367f7c8a0e70172bb331">MemoryManager::kmalloc</a>(8192 + 16));</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        receive_dsrctrs[i]-&gt;status = 0;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="comment">//write the send descriptor list address to the register</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    write(send_descriptor_low_register, (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a> &gt;&gt; 32));</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    write(send_descriptor_high_register, (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a> &amp; 0xFFFFFFFF));</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <span class="comment">//write the receive descriptor list address to the register</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    write(receive_descriptor_low_register, (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    write(receive_descriptor_high_register, 0);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="comment">//Set the receive descriptor list length</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    write(receive_descriptor_length_register, 32 * 16);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    write(receive_descriptor_head_register,</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>          0);                                                                       <span class="comment">//Set the head to 0</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    write(receive_descriptor_tail_register,</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>          32 - 1);                                                                    <span class="comment">//Set the tail to 32-1</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    current_receive_buffer = 0;                                                                                                   <span class="comment">//Set the current receive buffer to 0</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    write(receive_control_register, (1 &lt;&lt; 1)    <span class="comment">// Receiver Enable</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>                                  | (1 &lt;&lt; 2)         <span class="comment">// Store Bad Packets</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                                  | (1 &lt;&lt; 3)         <span class="comment">// Uni cast Promiscuous Enabled</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                                  | (1 &lt;&lt; 4)        <span class="comment">// Multicast Promiscuous Enabled</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                                  | (0 &lt;&lt; 6)        <span class="comment">// No Loop back</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                                  | (0 &lt;&lt; 8)        <span class="comment">// Free Buffer Threshold is 1/2 of RDLEN</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                                  | (1 &lt;&lt; 15)       <span class="comment">// Broadcast Accept Mode</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                                  | (1 &lt;&lt; 26)       <span class="comment">// Strip Ethernet CRC</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                                  | <a class="code hl_define" href="intel__i217_8cpp.html#aa3ab55cb1937ef26708a01f9a2870909">buffer8192</a></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    );</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="keyword">delete</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>}</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="keywordtype">void</span> IntelI217::send_init() {</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>;                                                                                                          <span class="comment">//A pointer to the memory</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <a class="code hl_typedef" href="intel__i217_8h.html#a1608b63414538a36ae7dd2d760a3e2fc">send_descriptor_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">descs</a>;                                                                                           <span class="comment">//A pointer to the send descriptors</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) (<a class="code hl_function" href="classMaxOS_1_1memory_1_1MemoryManager.html#a983c849ff604367f7c8a0e70172bb331">MemoryManager::kmalloc</a>(</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="intel__i217_8h.html#a1608b63414538a36ae7dd2d760a3e2fc">send_descriptor_t</a>) * 8 + 16));                <span class="comment">//Allocate memory for the send descriptors</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">descs</a> = (<a class="code hl_typedef" href="intel__i217_8h.html#a1608b63414538a36ae7dd2d760a3e2fc">send_descriptor_t</a>*) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>;                                                                                   <span class="comment">//Set the pointer to the send descriptors</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++) {</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        send_dsrctrs[i] = (<a class="code hl_typedef" href="intel__i217_8h.html#a1608b63414538a36ae7dd2d760a3e2fc">send_descriptor_t</a>*) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">descs</a> + i * 16);</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        send_dsrctrs[i]-&gt;buffer_address = 0;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        send_dsrctrs[i]-&gt;cmd = 0;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        send_dsrctrs[i]-&gt;status = (1 &lt;&lt; 0);    <span class="comment">// Descriptor Done</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="comment">//write the send descriptor list address to the register</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    write(send_descriptor_high_register, (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a> &gt;&gt; 32));</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    write(send_descriptor_low_register, (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>) ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a> &amp; 0xFFFFFFFF));</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="comment">//now setup total length of descriptors</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    write(send_descriptor_length_register, 8 * 16);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="comment">//setup numbers</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    write(send_descriptor_head_register, 0);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    write(send_descriptor_tail_register, 0);</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    current_send_buffer = 0;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    write(send_control_register, (1 &lt;&lt; 1)    <span class="comment">// Transmit Enable</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>                               | (1 &lt;&lt; 3)                 <span class="comment">// Pad Short Packets</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                               | (15 &lt;&lt; 4)                <span class="comment">// Collision Threshold</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                               | (64 &lt;&lt; 12)              <span class="comment">// Collision Distance</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>                               | (1 &lt;&lt; 24)                <span class="comment">// Re-transmit on Late Collision</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    );</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="comment">// In the case of I217 (id = 0x0410) and 82577LM (id = 0x10EA) packets will not be sent if the TCTRL is not configured using the following bits.</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="comment">// write(sendControlRegister,  0b0110000000000111111000011111010);</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    <span class="comment">//write(0x0410,  0x0060200A);</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="keyword">delete</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">ptr</a>;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>}</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="foldopen" id="foldopen00298" data-start="{" data-end="}">
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a60f5c4676c84d5f4e0551880a5942326">  298</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a60f5c4676c84d5f4e0551880a5942326">IntelI217::activate</a>() {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="comment">//Enable interrupts</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    write(interrupt_mask_register, 0x1F6DC);                     <span class="comment">//Enable all interrupts</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    write(interrupt_mask_register, 0xff &amp; ~4);                   <span class="comment">//Enable all interrupts except link status change</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    read(0xc0);                                                     <span class="comment">//Clear all interrupts</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="comment">//while (!initDone);                                           //Wait for the init to be done</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="comment">//Initialise the send and receive descriptors</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    receive_init();</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    send_init();</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    active = <span class="keyword">true</span>;                                               <span class="comment">// Set active to true</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>}</div>
</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="foldopen" id="foldopen00316" data-start="{" data-end="}">
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#aecea26a550aeda675247afca45ee630c">  316</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#aecea26a550aeda675247afca45ee630c">IntelI217::handle_interrupt</a>() {</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    write(interrupt_mask_register, 0x1);      <span class="comment">//Clear the interrupt or it will hang</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> = read(0xc0);                <span class="comment">//read the interrupt status register</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="comment">// if(temp &amp; 0x04)</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="comment">//   m_driver_message_stream-&gt; write(&quot;INTEL i217 START LINK&quot;);//initDone = true;</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="comment">// if(temp &amp; 0x10)</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="comment">//   m_driver_message_stream-&gt; write(&quot;INTEL i217 GOOD THRESHOLD&quot;);</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">temp</a> &amp; 0x80) fetch_data_received();</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>}</div>
</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="keywordtype">void</span> IntelI217::fetch_data_received() {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old_cur</a>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="keywordflow">while</span> ((receive_dsrctrs[current_receive_buffer]-&gt;status &amp; 0x1)) {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        <span class="keyword">auto</span>* buffer = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>*) receive_dsrctrs[current_receive_buffer]-&gt;buffer_address;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a> size = receive_dsrctrs[current_receive_buffer]-&gt;length;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="keywordflow">if</span> (size &gt; 64) {          <span class="comment">// If the size is the size of ethernet 2 frame</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>            size -= 4;          <span class="comment">// remove the checksum</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1EthernetDriver.html#a788f4c5744af1a13a4dd0a09c82d8a1b">fire_data_received</a>(buffer, size);  <span class="comment">//Pass data to handler</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        receive_dsrctrs[current_receive_buffer]-&gt;status = 0;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old_cur</a> = current_receive_buffer;                         <span class="comment">//Save the current receive buffer</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        current_receive_buffer = (current_receive_buffer + 1) % 32; <span class="comment">//Increment the current receive buffer</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        write(receive_descriptor_tail_register, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old_cur</a>); <span class="comment">//write the old current receive buffer to the tail register</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    }</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>}</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="foldopen" id="foldopen00356" data-start="{" data-end="}">
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a12da909ff23c9d93dd276f3bad7759d3">  356</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a12da909ff23c9d93dd276f3bad7759d3">IntelI217::do_send</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>* buffer, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> size) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordflow">while</span> (!active);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="comment">//Put params into send buffer</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    send_dsrctrs[current_send_buffer]-&gt;buffer_address = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a>) buffer;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    send_dsrctrs[current_send_buffer]-&gt;length = size;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="comment">//Set the commands</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    send_dsrctrs[current_send_buffer]-&gt;cmd = (1 &lt;&lt; 0)    <span class="comment">// End of Packet</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                                          | (1 &lt;&lt; 1)    <span class="comment">// Insert FCS</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>                                          | (1 &lt;&lt; 3)    <span class="comment">// Report Status</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            ;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    send_dsrctrs[current_send_buffer]-&gt;status = 0;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old_cur</a> = current_send_buffer;                                    <span class="comment">//Save the current send buffer</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    current_send_buffer = (current_send_buffer + 1) % 8;                        <span class="comment">//Increment the current send buffer</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    write(send_descriptor_tail_register, current_send_buffer);       <span class="comment">//write the current send buffer to the tail register</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="comment">//Wait for the packet to be sent</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="keywordflow">while</span> (!(send_dsrctrs[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old_cur</a>]-&gt;status &amp; 0xff));</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>}</div>
</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="foldopen" id="foldopen00381" data-start="{" data-end="}">
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a265229000b7ba87fa7971d3dd0b9052f">  381</a></span><a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint64_t</a> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a265229000b7ba87fa7971d3dd0b9052f">IntelI217::get_media_access_control_address</a>() {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <span class="keywordflow">while</span> (own_mac == 0);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="keywordflow">return</span> own_mac;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>}</div>
</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="foldopen" id="foldopen00387" data-start="{" data-end="}">
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a6d1705c3ded7570d4a378e801677ed25">  387</a></span><a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a6d1705c3ded7570d4a378e801677ed25">IntelI217::reset</a>() {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1Driver.html#a2371d6b69c1bf351e9c80bde265ac8be">Driver::reset</a>();</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>}</div>
</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="foldopen" id="foldopen00391" data-start="{" data-end="}">
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a0e22b33d489e4e2b7f2b2428265e0604">  391</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a0e22b33d489e4e2b7f2b2428265e0604">IntelI217::deactivate</a>() {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <a class="code hl_function" href="classMaxOS_1_1drivers_1_1Driver.html#aa8d91fd440659b56c4ecf5c877925210">Driver::deactivate</a>();</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>}</div>
</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="foldopen" id="foldopen00395" data-start="{" data-end="}">
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#aaebcde20a9a6b96492a121bf9ad15ae7">  395</a></span><span class="keywordtype">string</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#aaebcde20a9a6b96492a121bf9ad15ae7">IntelI217::vendor_name</a>() {</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Intel&quot;</span>;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>}</div>
</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="foldopen" id="foldopen00399" data-start="{" data-end="}">
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno"><a class="line" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a70e15a6d8159e6fbc60dcba206b40523">  399</a></span><span class="keywordtype">string</span> <a class="code hl_function" href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a70e15a6d8159e6fbc60dcba206b40523">IntelI217::device_name</a>() {</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;E1000 (i217)&quot;</span>;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>}</div>
</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="ttc" id="aclassMaxOS_1_1common_1_1Rectangle_html"><div class="ttname"><a href="classMaxOS_1_1common_1_1Rectangle.html">MaxOS::common::Rectangle</a></div><div class="ttdoc">Stores the left, top, width and height of a rectangle.</div><div class="ttdef"><b>Definition</b> <a href="rectangle_8h_source.html#l00022">rectangle.h:22</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1Driver_html_a2371d6b69c1bf351e9c80bde265ac8be"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1Driver.html#a2371d6b69c1bf351e9c80bde265ac8be">MaxOS::drivers::Driver::reset</a></div><div class="ttdeci">virtual uint32_t reset()</div><div class="ttdoc">Reset the driver.</div><div class="ttdef"><b>Definition</b> <a href="driver_8cpp_source.html#l00048">driver.cpp:48</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1Driver_html_aa8d91fd440659b56c4ecf5c877925210"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1Driver.html#aa8d91fd440659b56c4ecf5c877925210">MaxOS::drivers::Driver::deactivate</a></div><div class="ttdeci">virtual void deactivate()</div><div class="ttdoc">Deactivate the driver.</div><div class="ttdef"><b>Definition</b> <a href="driver_8cpp_source.html#l00032">driver.cpp:32</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1EthernetDriver_html_a2cfbe13ac9f10a6f9dc0c065ca980cff"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1EthernetDriver.html#a2cfbe13ac9f10a6f9dc0c065ca980cff">MaxOS::drivers::ethernet::EthernetDriver::create_media_access_control_address</a></div><div class="ttdeci">static MediaAccessControlAddress create_media_access_control_address(uint8_t digit1, uint8_t digit2, uint8_t digit3, uint8_t digit4, uint8_t digit5, uint8_t digit6)</div><div class="ttdoc">Create a Media Access Control Address.</div><div class="ttdef"><b>Definition</b> <a href="ethernet_8cpp_source.html#l00165">ethernet.cpp:165</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1EthernetDriver_html_a788f4c5744af1a13a4dd0a09c82d8a1b"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1EthernetDriver.html#a788f4c5744af1a13a4dd0a09c82d8a1b">MaxOS::drivers::ethernet::EthernetDriver::fire_data_received</a></div><div class="ttdeci">void fire_data_received(uint8_t *buffer, uint32_t size)</div><div class="ttdoc">Handle the recieved data.</div><div class="ttdef"><b>Definition</b> <a href="ethernet_8cpp_source.html#l00122">ethernet.cpp:122</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_a0e22b33d489e4e2b7f2b2428265e0604"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a0e22b33d489e4e2b7f2b2428265e0604">MaxOS::drivers::ethernet::IntelI217::deactivate</a></div><div class="ttdeci">void deactivate() final</div><div class="ttdoc">Deactivate the driver.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00391">intel_i217.cpp:391</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_a12da909ff23c9d93dd276f3bad7759d3"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a12da909ff23c9d93dd276f3bad7759d3">MaxOS::drivers::ethernet::IntelI217::do_send</a></div><div class="ttdeci">void do_send(uint8_t *buffer, uint32_t size) final</div><div class="ttdoc">(Device Side) send the data</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00356">intel_i217.cpp:356</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_a265229000b7ba87fa7971d3dd0b9052f"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a265229000b7ba87fa7971d3dd0b9052f">MaxOS::drivers::ethernet::IntelI217::get_media_access_control_address</a></div><div class="ttdeci">uint64_t get_media_access_control_address() final</div><div class="ttdoc">Get the MAC address.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00381">intel_i217.cpp:381</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_a60f5c4676c84d5f4e0551880a5942326"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a60f5c4676c84d5f4e0551880a5942326">MaxOS::drivers::ethernet::IntelI217::activate</a></div><div class="ttdeci">void activate() final</div><div class="ttdoc">Activate the driver.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00298">intel_i217.cpp:298</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_a6d1705c3ded7570d4a378e801677ed25"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a6d1705c3ded7570d4a378e801677ed25">MaxOS::drivers::ethernet::IntelI217::reset</a></div><div class="ttdeci">uint32_t reset() final</div><div class="ttdoc">Reset the driver.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00387">intel_i217.cpp:387</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_a70e15a6d8159e6fbc60dcba206b40523"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#a70e15a6d8159e6fbc60dcba206b40523">MaxOS::drivers::ethernet::IntelI217::device_name</a></div><div class="ttdeci">string device_name() final</div><div class="ttdoc">Get the device name of the driver.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00399">intel_i217.cpp:399</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_aaebcde20a9a6b96492a121bf9ad15ae7"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#aaebcde20a9a6b96492a121bf9ad15ae7">MaxOS::drivers::ethernet::IntelI217::vendor_name</a></div><div class="ttdeci">string vendor_name() final</div><div class="ttdoc">Get who created the device.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00395">intel_i217.cpp:395</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_ae32e321ff591670236fe0b25986b0596"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#ae32e321ff591670236fe0b25986b0596">MaxOS::drivers::ethernet::IntelI217::IntelI217</a></div><div class="ttdeci">IntelI217(hardwarecommunication::PCIDeviceDescriptor *device_descriptor)</div><div class="ttdoc">Constructs a new Intel I217 Ethernet driver. Gets the MAC address and clears the receive descriptor a...</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00033">intel_i217.cpp:33</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1ethernet_1_1IntelI217_html_aecea26a550aeda675247afca45ee630c"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1ethernet_1_1IntelI217.html#aecea26a550aeda675247afca45ee630c">MaxOS::drivers::ethernet::IntelI217::handle_interrupt</a></div><div class="ttdeci">void handle_interrupt() final</div><div class="ttdoc">Handles an interrupt.</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00316">intel_i217.cpp:316</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1hardwarecommunication_1_1InterruptHandler_html"><div class="ttname"><a href="classMaxOS_1_1hardwarecommunication_1_1InterruptHandler.html">MaxOS::hardwarecommunication::InterruptHandler</a></div><div class="ttdoc">Handles a certain interrupt number.</div><div class="ttdef"><b>Definition</b> <a href="interrupts_8h_source.html#l00030">interrupts.h:30</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1hardwarecommunication_1_1PCIDeviceDescriptor_html"><div class="ttname"><a href="classMaxOS_1_1hardwarecommunication_1_1PCIDeviceDescriptor.html">MaxOS::hardwarecommunication::PCIDeviceDescriptor</a></div><div class="ttdoc">Stores information about a PCI device.</div><div class="ttdef"><b>Definition</b> <a href="pci_8h_source.html#l00054">pci.h:54</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1hardwarecommunication_1_1Port32Bit_html"><div class="ttname"><a href="classMaxOS_1_1hardwarecommunication_1_1Port32Bit.html">MaxOS::hardwarecommunication::Port32Bit</a></div><div class="ttdoc">Handles 32 bit ports.</div><div class="ttdef"><b>Definition</b> <a href="port_8h_source.html#l00070">port.h:70</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1memory_1_1MemIO32Bit_html"><div class="ttname"><a href="classMaxOS_1_1memory_1_1MemIO32Bit.html">MaxOS::memory::MemIO32Bit</a></div><div class="ttdoc">Handles 32 bit memory IO.</div><div class="ttdef"><b>Definition</b> <a href="memoryIO_8h_source.html#l00062">memoryIO.h:62</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1memory_1_1MemoryManager_html_a983c849ff604367f7c8a0e70172bb331"><div class="ttname"><a href="classMaxOS_1_1memory_1_1MemoryManager.html#a983c849ff604367f7c8a0e70172bb331">MaxOS::memory::MemoryManager::kmalloc</a></div><div class="ttdeci">static void * kmalloc(size_t size)</div><div class="ttdoc">Allocates a block of memory in the KERNEL space.</div><div class="ttdef"><b>Definition</b> <a href="memorymanagement_8cpp_source.html#l00085">memorymanagement.cpp:85</a></div></div>
<div class="ttc" id="aintel__i217_8cpp_html_aa3ab55cb1937ef26708a01f9a2870909"><div class="ttname"><a href="intel__i217_8cpp.html#aa3ab55cb1937ef26708a01f9a2870909">buffer8192</a></div><div class="ttdeci">#define buffer8192</div><div class="ttdef"><b>Definition</b> <a href="intel__i217_8cpp_source.html#l00025">intel_i217.cpp:25</a></div></div>
<div class="ttc" id="aintel__i217_8h_html"><div class="ttname"><a href="intel__i217_8h.html">intel_i217.h</a></div><div class="ttdoc">Driver for the Intel I217 Ethernet Controller.</div></div>
<div class="ttc" id="aintel__i217_8h_html_a1608b63414538a36ae7dd2d760a3e2fc"><div class="ttname"><a href="intel__i217_8h.html#a1608b63414538a36ae7dd2d760a3e2fc">MaxOS::drivers::ethernet::send_descriptor_t</a></div><div class="ttdeci">struct PACKED MaxOS::drivers::ethernet::SendDescriptor send_descriptor_t</div><div class="ttdoc">Alias for SendDescriptor struct.</div></div>
<div class="ttc" id="aintel__i217_8h_html_a555ef0aa3df9c8d85d63af2f945553eb"><div class="ttname"><a href="intel__i217_8h.html#a555ef0aa3df9c8d85d63af2f945553eb">MaxOS::drivers::ethernet::receive_descriptor_t</a></div><div class="ttdeci">struct PACKED MaxOS::drivers::ethernet::ReceiveDescriptor receive_descriptor_t</div><div class="ttdoc">Alias for ReceiveDescriptor struct.</div></div>
<div class="ttc" id="alogger_8h_html_adf7b5d69e4c25995b3211b91b27f33b6"><div class="ttname"><a href="logger_8h.html#adf7b5d69e4c25995b3211b91b27f33b6">ASSERT</a></div><div class="ttdeci">#define ASSERT(condition, format,...)</div><div class="ttdoc">If the specified condition is not met then the kernel will crash with the specified message.</div><div class="ttdef"><b>Definition</b> <a href="logger_8h_source.html#l00100">logger.h:100</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_3dd30a497388ee684638f120a124721c.html">src</a></li><li class="navelem"><a class="el" href="dir_79cdf04718782f286da113044bf76c98.html">drivers</a></li><li class="navelem"><a class="el" href="dir_efcb6c0e12d9cee5df1accc0ecb8fd49.html">ethernet</a></li><li class="navelem"><a class="el" href="intel__i217_8cpp.html">intel_i217.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
