<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Max OS: MaxOS::filesystem::format::ext2::Ext2Volume Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Max OS<span id="projectnumber">&#160;0.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MaxOS::filesystem::format::ext2::Ext2Volume Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Common operations for an ext2 volume that are used by both files &amp; directories (like block &amp; inode allocation)  
 <a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ext2_8h_source.html">ext2.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4d627232293c978be4f587224170dc9b" id="r_a4d627232293c978be4f587224170dc9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a4d627232293c978be4f587224170dc9b">Ext2Volume</a> (<a class="el" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html">drivers::disk::Disk</a> *<a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>, <a class="el" href="filesystem_8h.html#af466a9d32fd2bf17acb2efa91031ded0">lba_t</a> <a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a>)</td></tr>
<tr class="memdesc:a4d627232293c978be4f587224170dc9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new Ext2 Volume object, reads the superblock and block group descriptors.  <br /></td></tr>
<tr class="separator:a4d627232293c978be4f587224170dc9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767863d034839b5f77efbca2e6eb905d" id="r_a767863d034839b5f77efbca2e6eb905d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a767863d034839b5f77efbca2e6eb905d">write_block</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">block_num</a>, <a class="el" href="buffer_8h.html#ae34c2f95637029a49836360ddf075b3d">common::buffer_t</a> *buffer) <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a></td></tr>
<tr class="memdesc:a767863d034839b5f77efbca2e6eb905d"><td class="mdescLeft">&#160;</td><td class="mdescRight">write a single block from a buffer into onto the disk  <br /></td></tr>
<tr class="separator:a767863d034839b5f77efbca2e6eb905d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd1055b2e0fc33cfd7b3ded4dd20c432" id="r_acd1055b2e0fc33cfd7b3ded4dd20c432"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#acd1055b2e0fc33cfd7b3ded4dd20c432">write_inode</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">inode_num</a>, <a class="el" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a> *inode) <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a></td></tr>
<tr class="memdesc:acd1055b2e0fc33cfd7b3ded4dd20c432"><td class="mdescLeft">&#160;</td><td class="mdescRight">write an inode to the filesystem  <br /></td></tr>
<tr class="separator:acd1055b2e0fc33cfd7b3ded4dd20c432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a657c2f9cd60960648f1e1cec6d95a144" id="r_a657c2f9cd60960648f1e1cec6d95a144"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a657c2f9cd60960648f1e1cec6d95a144">create_inode</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">bool</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">is_directory</a>)</td></tr>
<tr class="memdesc:a657c2f9cd60960648f1e1cec6d95a144"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a new inode and sets the base metadata. Also allocates block 0 of the inode.  <br /></td></tr>
<tr class="separator:a657c2f9cd60960648f1e1cec6d95a144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4acd208a882871ef4ce89ab5e297e31c" id="r_a4acd208a882871ef4ce89ab5e297e31c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a4acd208a882871ef4ce89ab5e297e31c">free_inode</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> inode)</td></tr>
<tr class="memdesc:a4acd208a882871ef4ce89ab5e297e31c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark an inode as free. Note: does NOT unallocated the inodes blocks, use free_group_blocks().  <br /></td></tr>
<tr class="separator:a4acd208a882871ef4ce89ab5e297e31c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4dc8f1dc35d79da9a4a577cf66792f3" id="r_ae4dc8f1dc35d79da9a4a577cf66792f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae4dc8f1dc35d79da9a4a577cf66792f3">read_block</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">block_num</a>, <a class="el" href="buffer_8h.html#ae34c2f95637029a49836360ddf075b3d">common::buffer_t</a> *buffer) <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a></td></tr>
<tr class="memdesc:ae4dc8f1dc35d79da9a4a577cf66792f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a single block from the disk into a buffer.  <br /></td></tr>
<tr class="separator:ae4dc8f1dc35d79da9a4a577cf66792f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ea16aa4dc886e18b353c1f4a3076100" id="r_a3ea16aa4dc886e18b353c1f4a3076100"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a3ea16aa4dc886e18b353c1f4a3076100">read_inode</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">inode_num</a>) <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a></td></tr>
<tr class="memdesc:a3ea16aa4dc886e18b353c1f4a3076100"><td class="mdescLeft">&#160;</td><td class="mdescRight">read an inode from the filesystem  <br /></td></tr>
<tr class="separator:a3ea16aa4dc886e18b353c1f4a3076100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2440f7c00021606ee91f68983abf206" id="r_ae2440f7c00021606ee91f68983abf206"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae2440f7c00021606ee91f68983abf206">allocate_block</a> ()</td></tr>
<tr class="memdesc:ae2440f7c00021606ee91f68983abf206"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a single block to be used by an inode.  <br /></td></tr>
<tr class="separator:ae2440f7c00021606ee91f68983abf206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf68810ccb0f9cdb2b9491c077710205" id="r_acf68810ccb0f9cdb2b9491c077710205"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Vector.html">common::Vector</a>&lt; <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#acf68810ccb0f9cdb2b9491c077710205">allocate_blocks</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a>)</td></tr>
<tr class="memdesc:acf68810ccb0f9cdb2b9491c077710205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a set of blocks to be used by an inode.  <br /></td></tr>
<tr class="separator:acf68810ccb0f9cdb2b9491c077710205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9769f68d14aa0c2c44b9313c151eafc" id="r_af9769f68d14aa0c2c44b9313c151eafc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af9769f68d14aa0c2c44b9313c151eafc">bytes_to_blocks</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">size_t</a> <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">bytes</a>) <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a></td></tr>
<tr class="memdesc:af9769f68d14aa0c2c44b9313c151eafc"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many blocks are needed to contain a set amount of bytes.  <br /></td></tr>
<tr class="separator:af9769f68d14aa0c2c44b9313c151eafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afee2108a1f09f919a3cafff60f3bc5dd" id="r_afee2108a1f09f919a3cafff60f3bc5dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#afee2108a1f09f919a3cafff60f3bc5dd">free_blocks</a> (<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a> <a class="el" href="classMaxOS_1_1common_1_1Vector.html">common::Vector</a>&lt; <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> &gt; &amp;<a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">blocks</a>)</td></tr>
<tr class="memdesc:afee2108a1f09f919a3cafff60f3bc5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a group of blocks. Preferably with adjacent blocks apearing next to each other but not enforced.  <br /></td></tr>
<tr class="separator:afee2108a1f09f919a3cafff60f3bc5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:af92c050fd33ce1edb06897b9c5fe0862" id="r_af92c050fd33ce1edb06897b9c5fe0862"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html">drivers::disk::Disk</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a></td></tr>
<tr class="memdesc:af92c050fd33ce1edb06897b9c5fe0862"><td class="mdescLeft">&#160;</td><td class="mdescRight">The disk that this volume is on.  <br /></td></tr>
<tr class="separator:af92c050fd33ce1edb06897b9c5fe0862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7436ecf891301b9a4c9edb52212151db" id="r_a7436ecf891301b9a4c9edb52212151db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="filesystem_8h.html#af466a9d32fd2bf17acb2efa91031ded0">lba_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a></td></tr>
<tr class="memdesc:a7436ecf891301b9a4c9edb52212151db"><td class="mdescLeft">&#160;</td><td class="mdescRight">How far into the disk this partition starts.  <br /></td></tr>
<tr class="separator:a7436ecf891301b9a4c9edb52212151db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e333eca8856f08ba4bc1724541a4b7" id="r_a95e333eca8856f08ba4bc1724541a4b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ext2_8h.html#a15a4367643e7dc701198c82139f21ee1">superblock_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a></td></tr>
<tr class="memdesc:a95e333eca8856f08ba4bc1724541a4b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The superblock of the ext2 filesystem.  <br /></td></tr>
<tr class="separator:a95e333eca8856f08ba4bc1724541a4b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e53f409de30340066785e5a0d94993" id="r_a28e53f409de30340066785e5a0d94993"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a></td></tr>
<tr class="memdesc:a28e53f409de30340066785e5a0d94993"><td class="mdescLeft">&#160;</td><td class="mdescRight">The block group descriptors.  <br /></td></tr>
<tr class="separator:a28e53f409de30340066785e5a0d94993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10014d7b0ae0cc94ea281d0e6ca56500" id="r_a10014d7b0ae0cc94ea281d0e6ca56500"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a></td></tr>
<tr class="memdesc:a10014d7b0ae0cc94ea281d0e6ca56500"><td class="mdescLeft">&#160;</td><td class="mdescRight">How large each block is (in bytes)  <br /></td></tr>
<tr class="separator:a10014d7b0ae0cc94ea281d0e6ca56500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a568c077e33ab4a474c65cfcaf934b215" id="r_a568c077e33ab4a474c65cfcaf934b215"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a568c077e33ab4a474c65cfcaf934b215">block_group_descriptor_table_block</a></td></tr>
<tr class="memdesc:a568c077e33ab4a474c65cfcaf934b215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Where the block group descriptor table starts.  <br /></td></tr>
<tr class="separator:a568c077e33ab4a474c65cfcaf934b215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e8c97da6e5a645d3c69ec277b9f9a2e" id="r_a7e8c97da6e5a645d3c69ec277b9f9a2e"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7e8c97da6e5a645d3c69ec277b9f9a2e">block_group_descriptor_table_size</a></td></tr>
<tr class="memdesc:a7e8c97da6e5a645d3c69ec277b9f9a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many block groups are in the block group descriptor table.  <br /></td></tr>
<tr class="separator:a7e8c97da6e5a645d3c69ec277b9f9a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a90acfd7dd067a9fa54e4a1ea0e707" id="r_ac5a90acfd7dd067a9fa54e4a1ea0e707"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a></td></tr>
<tr class="memdesc:ac5a90acfd7dd067a9fa54e4a1ea0e707"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many block groups are in the filesystem.  <br /></td></tr>
<tr class="separator:ac5a90acfd7dd067a9fa54e4a1ea0e707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a06e6d63e1762b1921e67931e6bd3c7" id="r_a6a06e6d63e1762b1921e67931e6bd3c7"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a6a06e6d63e1762b1921e67931e6bd3c7">pointers_per_block</a></td></tr>
<tr class="memdesc:a6a06e6d63e1762b1921e67931e6bd3c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many block pointers fit in a block.  <br /></td></tr>
<tr class="separator:a6a06e6d63e1762b1921e67931e6bd3c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc67bb9fb290354dca9c09c4ca5ff43d" id="r_abc67bb9fb290354dca9c09c4ca5ff43d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#abc67bb9fb290354dca9c09c4ca5ff43d">inodes_per_block</a></td></tr>
<tr class="memdesc:abc67bb9fb290354dca9c09c4ca5ff43d"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many inodes fit in a block.  <br /></td></tr>
<tr class="separator:abc67bb9fb290354dca9c09c4ca5ff43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2fb31420bd869e0f42e672e6ede97b2" id="r_aa2fb31420bd869e0f42e672e6ede97b2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a></td></tr>
<tr class="memdesc:aa2fb31420bd869e0f42e672e6ede97b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many sectors does a block take.  <br /></td></tr>
<tr class="separator:aa2fb31420bd869e0f42e672e6ede97b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e488e15a650d14870a5d9654b23193" id="r_a07e488e15a650d14870a5d9654b23193"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaxOS_1_1common_1_1Spinlock.html">common::Spinlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a07e488e15a650d14870a5d9654b23193">ext2_lock</a></td></tr>
<tr class="memdesc:a07e488e15a650d14870a5d9654b23193"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock for synchronised access to the volume (.  <br /></td></tr>
<tr class="separator:a07e488e15a650d14870a5d9654b23193"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Common operations for an ext2 volume that are used by both files &amp; directories (like block &amp; inode allocation) </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Free blocks </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00322">322</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4d627232293c978be4f587224170dc9b" name="a4d627232293c978be4f587224170dc9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d627232293c978be4f587224170dc9b">&#9670;&#160;</a></span>Ext2Volume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Ext2Volume::Ext2Volume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html">drivers::disk::Disk</a> *&#160;</td>
          <td class="paramname"><em>disk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="filesystem_8h.html#af466a9d32fd2bf17acb2efa91031ded0">lba_t</a>&#160;</td>
          <td class="paramname"><em>partition_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new Ext2 Volume object, reads the superblock and block group descriptors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">disk</td><td>The disk to read from </td></tr>
    <tr><td class="paramname">partition_offset</td><td>The offset of the partition on the disk in sectors</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000056">Todo:</a></b></dt><dd>Should lock per file and not expose volume lock </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00027">27</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   28</span>: <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>),</div>
<div class="line"><span class="lineno">   29</span>  <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a>),</div>
<div class="line"><span class="lineno">   30</span>  <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>({})</div>
<div class="line"><span class="lineno">   31</span>{</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>    <span class="comment">// Read superblock</span></div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Buffer.html">buffer_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">superblock_buffer</a>(&amp;<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>, 1024);</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>-&gt;<a class="code hl_function" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a9fa1c1952cece4f322ba0f2552f16c24">read</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a> + 2, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">superblock_buffer</a>, 512);</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>-&gt;<a class="code hl_function" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a9fa1c1952cece4f322ba0f2552f16c24">read</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a> + 3, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">superblock_buffer</a>, 512);</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    <span class="comment">// Validate signature</span></div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_define" href="logger_8h.html#adf7b5d69e4c25995b3211b91b27f33b6">ASSERT</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.signature == 0xEF53, <span class="stringliteral">&quot;Ext2 Filesystem doesnt have a valid signature\n&quot;</span>);</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">// Version 0 has constant inode info</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.version_major &lt; 1) {</div>
<div class="line"><span class="lineno">   43</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.first_inode = 11;</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inode_size = 128;</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">// Parse the superblock</span></div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> = 1024 &lt;&lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.block_size;</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a> = (<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.total_blocks + <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.blocks_per_group - 1) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.blocks_per_group;</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a568c077e33ab4a474c65cfcaf934b215">block_group_descriptor_table_block</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.starting_block + 1;</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7e8c97da6e5a645d3c69ec277b9f9a2e">block_group_descriptor_table_size</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>);</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a6a06e6d63e1762b1921e67931e6bd3c7">pointers_per_block</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> / <span class="keyword">sizeof</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>);</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#abc67bb9fb290354dca9c09c4ca5ff43d">inodes_per_block</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inode_size;</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> / 512;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">// Read the block groups</span></div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>* [<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a>] { <span class="keyword">nullptr</span> };</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bgdt_lba</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a> + <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a568c077e33ab4a474c65cfcaf934b215">block_group_descriptor_table_block</a> * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a>;</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">sectors_to_read</a> = (<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7e8c97da6e5a645d3c69ec277b9f9a2e">block_group_descriptor_table_size</a> + <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> - 1) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a>;</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Buffer.html">buffer_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_buffer</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">sectors_to_read</a> * 512);</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> i = 0; i &lt; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">sectors_to_read</a>; ++i)</div>
<div class="line"><span class="lineno">   62</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>-&gt;<a class="code hl_function" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a9fa1c1952cece4f322ba0f2552f16c24">read</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bgdt_lba</a> + i, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_buffer</a>, 512);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>    <span class="comment">// Store the block groups</span></div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> i = 0; i &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a>; ++i) {</div>
<div class="line"><span class="lineno">   66</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[i] = <span class="keyword">new</span> <a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>;</div>
<div class="line"><span class="lineno">   67</span>        <a class="code hl_function" href="memoryIO_8h.html#a5d860365491e432b125606a6f8e464bc">memcpy</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[i], <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_buffer</a>.raw() + i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>),</div>
<div class="line"><span class="lineno">   68</span>               <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>));</div>
<div class="line"><span class="lineno">   69</span>    }</div>
<div class="line"><span class="lineno">   70</span>}</div>
<div class="ttc" id="aclassMaxOS_1_1common_1_1Buffer_html"><div class="ttname"><a href="classMaxOS_1_1common_1_1Buffer.html">MaxOS::common::Buffer</a></div><div class="ttdoc">Wrapper class for a region of bytes in memor in an attempt to add some memory safety....</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00025">buffer.h:25</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1common_1_1Rectangle_html"><div class="ttname"><a href="classMaxOS_1_1common_1_1Rectangle.html">MaxOS::common::Rectangle</a></div><div class="ttdoc">Stores the left, top, width and height of a rectangle.</div><div class="ttdef"><b>Definition</b> <a href="rectangle_8h_source.html#l00022">rectangle.h:22</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1disk_1_1Disk_html_a9fa1c1952cece4f322ba0f2552f16c24"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a9fa1c1952cece4f322ba0f2552f16c24">MaxOS::drivers::disk::Disk::read</a></div><div class="ttdeci">void read(uint32_t sector, common::buffer_t *data_buffer)</div><div class="ttdoc">read data from the disk into a buffer (max capacity 512 bytes)</div><div class="ttdef"><b>Definition</b> <a href="disk_8cpp_source.html#l00026">disk.cpp:26</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a10014d7b0ae0cc94ea281d0e6ca56500"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">MaxOS::filesystem::format::ext2::Ext2Volume::block_size</a></div><div class="ttdeci">size_t block_size</div><div class="ttdoc">How large each block is (in bytes)</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00342">ext2.h:342</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a28e53f409de30340066785e5a0d94993"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">MaxOS::filesystem::format::ext2::Ext2Volume::block_groups</a></div><div class="ttdeci">block_group_descriptor_t ** block_groups</div><div class="ttdoc">The block group descriptors.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00340">ext2.h:340</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a568c077e33ab4a474c65cfcaf934b215"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a568c077e33ab4a474c65cfcaf934b215">MaxOS::filesystem::format::ext2::Ext2Volume::block_group_descriptor_table_block</a></div><div class="ttdeci">uint32_t block_group_descriptor_table_block</div><div class="ttdoc">Where the block group descriptor table starts.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00343">ext2.h:343</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a6a06e6d63e1762b1921e67931e6bd3c7"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a6a06e6d63e1762b1921e67931e6bd3c7">MaxOS::filesystem::format::ext2::Ext2Volume::pointers_per_block</a></div><div class="ttdeci">size_t pointers_per_block</div><div class="ttdoc">How many block pointers fit in a block.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00346">ext2.h:346</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a7436ecf891301b9a4c9edb52212151db"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">MaxOS::filesystem::format::ext2::Ext2Volume::partition_offset</a></div><div class="ttdeci">lba_t partition_offset</div><div class="ttdoc">How far into the disk this partition starts.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00337">ext2.h:337</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a7e8c97da6e5a645d3c69ec277b9f9a2e"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7e8c97da6e5a645d3c69ec277b9f9a2e">MaxOS::filesystem::format::ext2::Ext2Volume::block_group_descriptor_table_size</a></div><div class="ttdeci">uint32_t block_group_descriptor_table_size</div><div class="ttdoc">How many block groups are in the block group descriptor table.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00344">ext2.h:344</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a95e333eca8856f08ba4bc1724541a4b7"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">MaxOS::filesystem::format::ext2::Ext2Volume::superblock</a></div><div class="ttdeci">superblock_t superblock</div><div class="ttdoc">The superblock of the ext2 filesystem.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00339">ext2.h:339</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_aa2fb31420bd869e0f42e672e6ede97b2"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">MaxOS::filesystem::format::ext2::Ext2Volume::sectors_per_block</a></div><div class="ttdeci">uint32_t sectors_per_block</div><div class="ttdoc">How many sectors does a block take.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00348">ext2.h:348</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_abc67bb9fb290354dca9c09c4ca5ff43d"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#abc67bb9fb290354dca9c09c4ca5ff43d">MaxOS::filesystem::format::ext2::Ext2Volume::inodes_per_block</a></div><div class="ttdeci">uint32_t inodes_per_block</div><div class="ttdoc">How many inodes fit in a block.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00347">ext2.h:347</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_ac5a90acfd7dd067a9fa54e4a1ea0e707"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">MaxOS::filesystem::format::ext2::Ext2Volume::total_block_groups</a></div><div class="ttdeci">uint32_t total_block_groups</div><div class="ttdoc">How many block groups are in the filesystem.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00345">ext2.h:345</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_af92c050fd33ce1edb06897b9c5fe0862"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">MaxOS::filesystem::format::ext2::Ext2Volume::disk</a></div><div class="ttdeci">drivers::disk::Disk * disk</div><div class="ttdoc">The disk that this volume is on.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00336">ext2.h:336</a></div></div>
<div class="ttc" id="aext2_8h_html_ab9db2de98fbe3eebbd1add91524aa7a1"><div class="ttname"><a href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">MaxOS::filesystem::format::ext2::block_group_descriptor_t</a></div><div class="ttdeci">struct PACKED MaxOS::filesystem::format::ext2::BlockGroupDescriptor block_group_descriptor_t</div><div class="ttdoc">Alias for BlockGroupDescriptor struct.</div></div>
<div class="ttc" id="alogger_8h_html_adf7b5d69e4c25995b3211b91b27f33b6"><div class="ttname"><a href="logger_8h.html#adf7b5d69e4c25995b3211b91b27f33b6">ASSERT</a></div><div class="ttdeci">#define ASSERT(condition, format,...)</div><div class="ttdoc">If the specified condition is not met then the kernel will crash with the specified message.</div><div class="ttdef"><b>Definition</b> <a href="logger_8h_source.html#l00100">logger.h:100</a></div></div>
<div class="ttc" id="amemoryIO_8h_html_a5d860365491e432b125606a6f8e464bc"><div class="ttname"><a href="memoryIO_8h.html#a5d860365491e432b125606a6f8e464bc">memcpy</a></div><div class="ttdeci">void * memcpy(void *destination, const void *source, uint64_t num)</div><div class="ttdoc">Copies a block of memory from one location to another.</div><div class="ttdef"><b>Definition</b> <a href="memoryIO_8cpp_source.html#l00165">memoryIO.cpp:165</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae2440f7c00021606ee91f68983abf206" name="ae2440f7c00021606ee91f68983abf206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2440f7c00021606ee91f68983abf206">&#9670;&#160;</a></span>allocate_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> Ext2Volume::allocate_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a single block to be used by an inode. </p>
<dl class="section return"><dt>Returns</dt><dd>The new block number or 0 if the allocation failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00177">177</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  177</span>                                    {</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#acf68810ccb0f9cdb2b9491c077710205">allocate_blocks</a>(1)[0];</div>
<div class="line"><span class="lineno">  180</span>}</div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_acf68810ccb0f9cdb2b9491c077710205"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#acf68810ccb0f9cdb2b9491c077710205">MaxOS::filesystem::format::ext2::Ext2Volume::allocate_blocks</a></div><div class="ttdeci">common::Vector&lt; uint32_t &gt; allocate_blocks(uint32_t amount)</div><div class="ttdoc">Allocates a set of blocks to be used by an inode.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8cpp_source.html#l00188">ext2.cpp:188</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8cpp_source.html#l00188">allocate_blocks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>.</p>

</div>
</div>
<a id="acf68810ccb0f9cdb2b9491c077710205" name="acf68810ccb0f9cdb2b9491c077710205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf68810ccb0f9cdb2b9491c077710205">&#9670;&#160;</a></span>allocate_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Vector.html">Vector</a>&lt; <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> &gt; Ext2Volume::allocate_blocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td>
          <td class="paramname"><em>amount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a set of blocks to be used by an inode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">amount</td><td>The amount of blocks to allocate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of the allocated blocks or [0] if the allocation failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00188">188</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>                                                            {</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="comment">// No blocks to allocate</span></div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">if</span>(!<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a>)</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">return</span> { 1, 0 };</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <span class="comment">// Find the block group with enough free blocks</span></div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[0];</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> = 0; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a>; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[++<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>])</div>
<div class="line"><span class="lineno">  197</span>        <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;free_blocks &gt;= <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a>)</div>
<div class="line"><span class="lineno">  198</span>            <span class="keywordflow">return</span> allocate_group_blocks(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a>);</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">// No block group can contain the block so split across multiple</span></div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">Vector&lt;uint32_t&gt;</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">result</a> { };</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">while</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        <span class="comment">// Find the block group with most free blocks</span></div>
<div class="line"><span class="lineno">  205</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[0];</div>
<div class="line"><span class="lineno">  206</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> = 0;</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">for</span>(; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a>; ++<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>)</div>
<div class="line"><span class="lineno">  208</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>]-&gt;<a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#afee2108a1f09f919a3cafff60f3bc5dd">free_blocks</a> &gt; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;free_blocks)</div>
<div class="line"><span class="lineno">  209</span>                <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>];</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>        <span class="comment">// No space</span></div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;free_blocks == 0)</div>
<div class="line"><span class="lineno">  213</span>            <span class="keywordflow">return</span> { 1, 0 };</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>        <span class="comment">// Allocate the remaining blocks</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="keyword">auto</span> allocated = allocate_group_blocks(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>, 1);</div>
<div class="line"><span class="lineno">  217</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a> -= allocated.size();</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a> : allocated)</div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">result</a>.push_back(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>);</div>
<div class="line"><span class="lineno">  220</span>    }</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">result</a>;</div>
<div class="line"><span class="lineno">  223</span>}</div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_afee2108a1f09f919a3cafff60f3bc5dd"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#afee2108a1f09f919a3cafff60f3bc5dd">MaxOS::filesystem::format::ext2::Ext2Volume::free_blocks</a></div><div class="ttdeci">void free_blocks(const common::Vector&lt; uint32_t &gt; &amp;blocks)</div><div class="ttdoc">Frees a group of blocks. Preferably with adjacent blocks apearing next to each other but not enforced...</div><div class="ttdef"><b>Definition</b> <a href="ext2_8cpp_source.html#l00464">ext2.cpp:464</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00340">block_groups</a>, <a class="el" href="ext2_8cpp_source.html#l00464">free_blocks()</a>, and <a class="el" href="ext2_8h_source.html#l00345">total_block_groups</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00177">allocate_block()</a>, and <a class="el" href="ext2_8cpp_source.html#l00675">MaxOS::filesystem::format::ext2::InodeHandler::grow()</a>.</p>

</div>
</div>
<a id="af9769f68d14aa0c2c44b9313c151eafc" name="af9769f68d14aa0c2c44b9313c151eafc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9769f68d14aa0c2c44b9313c151eafc">&#9670;&#160;</a></span>bytes_to_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> Ext2Volume::bytes_to_blocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">size_t</a>&#160;</td>
          <td class="paramname"><em>bytes</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How many blocks are needed to contain a set amount of bytes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytes</td><td>Bytes needed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The blocks required </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00360">360</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  360</span>                                                       {</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">return</span> (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bytes</a> + <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a> - 1) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>;</div>
<div class="line"><span class="lineno">  362</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00342">block_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00675">MaxOS::filesystem::format::ext2::InodeHandler::grow()</a>.</p>

</div>
</div>
<a id="a657c2f9cd60960648f1e1cec6d95a144" name="a657c2f9cd60960648f1e1cec6d95a144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a657c2f9cd60960648f1e1cec6d95a144">&#9670;&#160;</a></span>create_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> Ext2Volume::create_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">bool</a>&#160;</td>
          <td class="paramname"><em>is_directory</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a new inode and sets the base metadata. Also allocates block 0 of the inode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">is_directory</td><td>is the inode to be used for a directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new inode </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00370">370</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  370</span>                                                   {</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a07e488e15a650d14870a5d9654b23193">ext2_lock</a>.<a class="code hl_function" href="classMaxOS_1_1common_1_1Spinlock.html#a27a03c3d6b4cdd677e7d16e59689e38e">lock</a>();</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">// Find the block group with enough free inodes</span></div>
<div class="line"><span class="lineno">  375</span>    <a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[0];</div>
<div class="line"><span class="lineno">  376</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> = 0;</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">for</span>(; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ac5a90acfd7dd067a9fa54e4a1ea0e707">total_block_groups</a>; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[++<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>])</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;free_inodes &gt;= 1)</div>
<div class="line"><span class="lineno">  379</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <span class="comment">// Read bitmap</span></div>
<div class="line"><span class="lineno">  382</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Buffer.html">buffer_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>);</div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae4dc8f1dc35d79da9a4a577cf66792f3">read_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;block_inode_bitmap, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="comment">// First group contains reserved inodes</span></div>
<div class="line"><span class="lineno">  386</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> = 0;</div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> == 0 &amp;&amp; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.first_inode &gt; 1)</div>
<div class="line"><span class="lineno">  388</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.first_inode - 1;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// Find a free inode</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">for</span>(; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group; ++<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a>) {</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>        <span class="comment">// Block is already used</span></div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">if</span>((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>.raw()[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> / 8] &amp; (1u &lt;&lt; (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> % 8))) != 0)</div>
<div class="line"><span class="lineno">  395</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>        <span class="comment">// Mark as used</span></div>
<div class="line"><span class="lineno">  398</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;free_inodes--;</div>
<div class="line"><span class="lineno">  399</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.unallocated_inodes--;</div>
<div class="line"><span class="lineno">  400</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>.raw()[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> / 8] |= (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>) (1u &lt;&lt; (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> % 8));</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  403</span>    }</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>    <span class="comment">// Convert into the 1-based inode index in the group</span></div>
<div class="line"><span class="lineno">  406</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> += <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group + 1;</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    <span class="comment">// Save the changed metadata</span></div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a767863d034839b5f77efbca2e6eb905d">write_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;block_inode_bitmap, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>);</div>
<div class="line"><span class="lineno">  410</span>    write_back_block_groups();</div>
<div class="line"><span class="lineno">  411</span>    write_back_superblock();</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    <span class="comment">// Create the inode</span></div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_typedef" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a> inode { };</div>
<div class="line"><span class="lineno">  415</span>    inode.creation_time = time_to_epoch(<a class="code hl_function" href="classMaxOS_1_1drivers_1_1clock_1_1Clock.html#af6e633c389f02276b3c76ee4ff2c65bb">Clock::active_clock</a>()-&gt;get_time());</div>
<div class="line"><span class="lineno">  416</span>    inode.last_modification_time = time_to_epoch(<a class="code hl_function" href="classMaxOS_1_1drivers_1_1clock_1_1Clock.html#af6e633c389f02276b3c76ee4ff2c65bb">Clock::active_clock</a>()-&gt;get_time());</div>
<div class="line"><span class="lineno">  417</span>    inode.block_pointers[0] = <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae2440f7c00021606ee91f68983abf206">allocate_block</a>();</div>
<div class="line"><span class="lineno">  418</span>    inode.hard_links = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">is_directory</a> ? 2 : 1;</div>
<div class="line"><span class="lineno">  419</span>    inode.type = ((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a>) (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">is_directory</a> ? InodeType::DIRECTORY : <a class="code hl_enumeration" href="ext2_8h.html#a1cb56516e5efe8eb3332d6a1d64e007b">InodeType</a>::FILE) &gt;&gt; 12) &amp; 0xF;</div>
<div class="line"><span class="lineno">  420</span>    inode.permissions =</div>
<div class="line"><span class="lineno">  421</span>            (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint16_t</a>) (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">is_directory</a> ? InodePermissionsDefaults::DIRECTORY : <a class="code hl_enumeration" href="ext2_8h.html#a3e6abe2885e285bee96b1708ba14bac1">InodePermissionsDefaults</a>::FILE) &amp; 0x0FFF;</div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#acd1055b2e0fc33cfd7b3ded4dd20c432">write_inode</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a>, &amp;inode);</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a07e488e15a650d14870a5d9654b23193">ext2_lock</a>.<a class="code hl_function" href="classMaxOS_1_1common_1_1Spinlock.html#a7c26334ccfa43ef932ef3c73e2c11492">unlock</a>();</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a>;</div>
<div class="line"><span class="lineno">  426</span>}</div>
<div class="ttc" id="aclassMaxOS_1_1common_1_1Spinlock_html_a27a03c3d6b4cdd677e7d16e59689e38e"><div class="ttname"><a href="classMaxOS_1_1common_1_1Spinlock.html#a27a03c3d6b4cdd677e7d16e59689e38e">MaxOS::common::Spinlock::lock</a></div><div class="ttdeci">void lock()</div><div class="ttdoc">Lock the spinlock once it is available.</div><div class="ttdef"><b>Definition</b> <a href="spinlock_8cpp_source.html#l00024">spinlock.cpp:24</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1common_1_1Spinlock_html_a7c26334ccfa43ef932ef3c73e2c11492"><div class="ttname"><a href="classMaxOS_1_1common_1_1Spinlock.html#a7c26334ccfa43ef932ef3c73e2c11492">MaxOS::common::Spinlock::unlock</a></div><div class="ttdeci">void unlock()</div><div class="ttdoc">Unlock the spinlock.</div><div class="ttdef"><b>Definition</b> <a href="spinlock_8cpp_source.html#l00032">spinlock.cpp:32</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1clock_1_1Clock_html_af6e633c389f02276b3c76ee4ff2c65bb"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1clock_1_1Clock.html#af6e633c389f02276b3c76ee4ff2c65bb">MaxOS::drivers::clock::Clock::active_clock</a></div><div class="ttdeci">static Clock * active_clock()</div><div class="ttdoc">Gets the currently active clock.</div><div class="ttdef"><b>Definition</b> <a href="clock_8cpp_source.html#l00208">clock.cpp:208</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a07e488e15a650d14870a5d9654b23193"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a07e488e15a650d14870a5d9654b23193">MaxOS::filesystem::format::ext2::Ext2Volume::ext2_lock</a></div><div class="ttdeci">common::Spinlock ext2_lock</div><div class="ttdoc">Lock for synchronised access to the volume (.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00350">ext2.h:350</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_a767863d034839b5f77efbca2e6eb905d"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a767863d034839b5f77efbca2e6eb905d">MaxOS::filesystem::format::ext2::Ext2Volume::write_block</a></div><div class="ttdeci">void write_block(uint32_t block_num, common::buffer_t *buffer) const</div><div class="ttdoc">write a single block from a buffer into onto the disk</div><div class="ttdef"><b>Definition</b> <a href="ext2_8cpp_source.html#l00080">ext2.cpp:80</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_acd1055b2e0fc33cfd7b3ded4dd20c432"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#acd1055b2e0fc33cfd7b3ded4dd20c432">MaxOS::filesystem::format::ext2::Ext2Volume::write_inode</a></div><div class="ttdeci">void write_inode(uint32_t inode_num, inode_t *inode) const</div><div class="ttdoc">write an inode to the filesystem</div><div class="ttdef"><b>Definition</b> <a href="ext2_8cpp_source.html#l00102">ext2.cpp:102</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_ae2440f7c00021606ee91f68983abf206"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae2440f7c00021606ee91f68983abf206">MaxOS::filesystem::format::ext2::Ext2Volume::allocate_block</a></div><div class="ttdeci">uint32_t allocate_block()</div><div class="ttdoc">Allocates a single block to be used by an inode.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8cpp_source.html#l00177">ext2.cpp:177</a></div></div>
<div class="ttc" id="aclassMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_html_ae4dc8f1dc35d79da9a4a577cf66792f3"><div class="ttname"><a href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae4dc8f1dc35d79da9a4a577cf66792f3">MaxOS::filesystem::format::ext2::Ext2Volume::read_block</a></div><div class="ttdeci">void read_block(uint32_t block_num, common::buffer_t *buffer) const</div><div class="ttdoc">Reads a single block from the disk into a buffer.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8cpp_source.html#l00129">ext2.cpp:129</a></div></div>
<div class="ttc" id="aext2_8h_html_a1cb56516e5efe8eb3332d6a1d64e007b"><div class="ttname"><a href="ext2_8h.html#a1cb56516e5efe8eb3332d6a1d64e007b">MaxOS::filesystem::format::ext2::InodeType</a></div><div class="ttdeci">InodeType</div><div class="ttdoc">The type of an inode.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00206">ext2.h:206</a></div></div>
<div class="ttc" id="aext2_8h_html_a3e6abe2885e285bee96b1708ba14bac1"><div class="ttname"><a href="ext2_8h.html#a3e6abe2885e285bee96b1708ba14bac1">MaxOS::filesystem::format::ext2::InodePermissionsDefaults</a></div><div class="ttdeci">InodePermissionsDefaults</div><div class="ttdoc">The default permissions for files and directories.</div><div class="ttdef"><b>Definition</b> <a href="ext2_8h_source.html#l00242">ext2.h:242</a></div></div>
<div class="ttc" id="aext2_8h_html_adecfa9c752ab7847b442910a50c2fd66"><div class="ttname"><a href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">MaxOS::filesystem::format::ext2::inode_t</a></div><div class="ttdeci">struct PACKED MaxOS::filesystem::format::ext2::Inode inode_t</div><div class="ttdoc">Alias for Inode struct.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="clock_8cpp_source.html#l00208">MaxOS::drivers::clock::Clock::active_clock()</a>, <a class="el" href="ext2_8cpp_source.html#l00177">allocate_block()</a>, <a class="el" href="ext2_8h_source.html#l00340">block_groups</a>, <a class="el" href="ext2_8h_source.html#l00342">block_size</a>, <a class="el" href="ext2_8h_source.html#l00350">ext2_lock</a>, <a class="el" href="spinlock_8cpp_source.html#l00024">MaxOS::common::Spinlock::lock()</a>, <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, <a class="el" href="ext2_8h_source.html#l00339">superblock</a>, <a class="el" href="ext2_8h_source.html#l00345">total_block_groups</a>, <a class="el" href="spinlock_8cpp_source.html#l00032">MaxOS::common::Spinlock::unlock()</a>, <a class="el" href="ext2_8cpp_source.html#l00080">write_block()</a>, and <a class="el" href="ext2_8cpp_source.html#l00102">write_inode()</a>.</p>

</div>
</div>
<a id="afee2108a1f09f919a3cafff60f3bc5dd" name="afee2108a1f09f919a3cafff60f3bc5dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afee2108a1f09f919a3cafff60f3bc5dd">&#9670;&#160;</a></span>free_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a> Ext2Volume::free_blocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">const</a> <a class="el" href="classMaxOS_1_1common_1_1Vector.html">common::Vector</a>&lt; <a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>blocks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a group of blocks. Preferably with adjacent blocks apearing next to each other but not enforced. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blocks</td><td>The blocks to free </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00464">464</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>                                                                 {</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    <span class="comment">// No blocks to free</span></div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">blocks</a>.empty())</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a> = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">blocks</a>[0];</div>
<div class="line"><span class="lineno">  471</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">previous</a> = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a>;</div>
<div class="line"><span class="lineno">  472</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a> = 1;</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>    <span class="comment">// Free each adjacent set of blocks</span></div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a> : <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">blocks</a>) {</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">// First is already accounted for</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a> == <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a>)</div>
<div class="line"><span class="lineno">  479</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>        <span class="comment">// Is this block adjacent</span></div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">if</span>((<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">previous</a> + 1) == <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>) {</div>
<div class="line"><span class="lineno">  483</span>            <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">previous</a> = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>;</div>
<div class="line"><span class="lineno">  484</span>            <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a> += 1;</div>
<div class="line"><span class="lineno">  485</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  486</span>        }</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>        <span class="comment">// Adjacent set has ended</span></div>
<div class="line"><span class="lineno">  489</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a> - <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.starting_block) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.blocks_per_group;</div>
<div class="line"><span class="lineno">  490</span>        free_group_blocks(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a>, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a>, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a>);</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>        <span class="comment">// Reset</span></div>
<div class="line"><span class="lineno">  493</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a> = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>;</div>
<div class="line"><span class="lineno">  494</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">previous</a> = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a>;</div>
<div class="line"><span class="lineno">  495</span>        <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a> = 1;</div>
<div class="line"><span class="lineno">  496</span>    }</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>    <span class="comment">// Account for the last set of blocks in the loop</span></div>
<div class="line"><span class="lineno">  499</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a> - <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.starting_block) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.blocks_per_group;</div>
<div class="line"><span class="lineno">  500</span>    free_group_blocks(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a>, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">amount</a>, <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">start</a>);</div>
<div class="line"><span class="lineno">  501</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00339">superblock</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00188">allocate_blocks()</a>, and <a class="el" href="ext2_8cpp_source.html#l00705">MaxOS::filesystem::format::ext2::InodeHandler::free()</a>.</p>

</div>
</div>
<a id="a4acd208a882871ef4ce89ab5e297e31c" name="a4acd208a882871ef4ce89ab5e297e31c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4acd208a882871ef4ce89ab5e297e31c">&#9670;&#160;</a></span>free_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a> Ext2Volume::free_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mark an inode as free. Note: does NOT unallocated the inodes blocks, use free_group_blocks(). </p>
<dl class="section see"><dt>See also</dt><dd>free_group_blocks</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inode</td><td>The inode number to mark as free </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00434">434</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  434</span>                                          {</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    <span class="comment">// Find the block group containing the inode</span></div>
<div class="line"><span class="lineno">  437</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> = (inode - 1) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group;</div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_typedef" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>* <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a>];</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>    <span class="comment">// Read bitmap</span></div>
<div class="line"><span class="lineno">  441</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Buffer.html">buffer_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>);</div>
<div class="line"><span class="lineno">  442</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae4dc8f1dc35d79da9a4a577cf66792f3">read_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;block_inode_bitmap, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>);</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="comment">// First group contains reserved inodes</span></div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> = (inode - 1) % <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group;</div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">if</span>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bg_index</a> == 0 &amp;&amp; (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> &lt; (<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.first_inode - 1)))</div>
<div class="line"><span class="lineno">  447</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    <span class="comment">// Mark as used</span></div>
<div class="line"><span class="lineno">  450</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;free_inodes++;</div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.unallocated_inodes++;</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>.raw()[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> / 8] &amp;= (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint8_t</a>) ~(1u &lt;&lt; (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_index</a> % 8));</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="comment">// Save the changed metadata</span></div>
<div class="line"><span class="lineno">  455</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a767863d034839b5f77efbca2e6eb905d">write_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_group</a>-&gt;block_inode_bitmap, &amp;<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">bitmap</a>);</div>
<div class="line"><span class="lineno">  456</span>    write_back_block_groups();</div>
<div class="line"><span class="lineno">  457</span>    write_back_superblock();</div>
<div class="line"><span class="lineno">  458</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00340">block_groups</a>, <a class="el" href="ext2_8h_source.html#l00342">block_size</a>, <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, <a class="el" href="ext2_8h_source.html#l00339">superblock</a>, and <a class="el" href="ext2_8cpp_source.html#l00080">write_block()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00705">MaxOS::filesystem::format::ext2::InodeHandler::free()</a>.</p>

</div>
</div>
<a id="ae4dc8f1dc35d79da9a4a577cf66792f3" name="ae4dc8f1dc35d79da9a4a577cf66792f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4dc8f1dc35d79da9a4a577cf66792f3">&#9670;&#160;</a></span>read_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a> Ext2Volume::read_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="buffer_8h.html#ae34c2f95637029a49836360ddf075b3d">common::buffer_t</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a single block from the disk into a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_num</td><td>The block to read </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer to read into </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00129">129</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>                                                                      {</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="comment">// Ensure the buffer is in the right format</span></div>
<div class="line"><span class="lineno">  132</span>    buffer-&gt;set_offset(0);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// Read each sector of the block</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a>; ++i)</div>
<div class="line"><span class="lineno">  136</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>-&gt;<a class="code hl_function" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a9fa1c1952cece4f322ba0f2552f16c24">read</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a> + <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_num</a> * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a> + i, buffer, 512);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// Reset buffer</span></div>
<div class="line"><span class="lineno">  139</span>    buffer-&gt;set_offset(0);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00336">disk</a>, <a class="el" href="ext2_8h_source.html#l00337">partition_offset</a>, <a class="el" href="disk_8cpp_source.html#l00026">MaxOS::drivers::disk::Disk::read()</a>, <a class="el" href="ext2_8h_source.html#l00348">sectors_per_block</a>, and <a class="el" href="buffer_8cpp_source.html#l00128">MaxOS::common::Buffer::set_offset()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00434">free_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00795">MaxOS::filesystem::format::ext2::Ext2File::read()</a>, <a class="el" href="ext2_8cpp_source.html#l00959">MaxOS::filesystem::format::ext2::Ext2Directory::read_from_disk()</a>, <a class="el" href="ext2_8cpp_source.html#l00149">read_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00741">MaxOS::filesystem::format::ext2::Ext2File::write()</a>, and <a class="el" href="ext2_8cpp_source.html#l00102">write_inode()</a>.</p>

</div>
</div>
<a id="a3ea16aa4dc886e18b353c1f4a3076100" name="a3ea16aa4dc886e18b353c1f4a3076100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ea16aa4dc886e18b353c1f4a3076100">&#9670;&#160;</a></span>read_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a> Ext2Volume::read_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_num</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read an inode from the filesystem </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inode_num</td><td>The inode index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The inode read </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00149">149</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>                                                       {</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_typedef" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a> inode;</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="comment">// Locate the inode</span></div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_num</a> - 1) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group;</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> index = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_num</a> - 1) % <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group;</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">// Locate the block</span></div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_table</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a>]-&gt;inode_table_address;</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> offset = index * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inode_size;</div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a> = offset / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>;</div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">in_block_offset</a> = offset % <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// Read the block</span></div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Buffer.html">buffer_t</a> buffer(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>);</div>
<div class="line"><span class="lineno">  165</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae4dc8f1dc35d79da9a4a577cf66792f3">read_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_table</a> + <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>, &amp;buffer);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">// Read the inode from the block</span></div>
<div class="line"><span class="lineno">  168</span>    buffer.copy_to(&amp;inode, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a>), <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">in_block_offset</a>);</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">return</span> inode;</div>
<div class="line"><span class="lineno">  170</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00340">block_groups</a>, <a class="el" href="ext2_8h_source.html#l00342">block_size</a>, <a class="el" href="buffer_8cpp_source.html#l00282">MaxOS::common::Buffer::copy_to()</a>, <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, and <a class="el" href="ext2_8h_source.html#l00339">superblock</a>.</p>

</div>
</div>
<a id="a767863d034839b5f77efbca2e6eb905d" name="a767863d034839b5f77efbca2e6eb905d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a767863d034839b5f77efbca2e6eb905d">&#9670;&#160;</a></span>write_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a> Ext2Volume::write_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td>
          <td class="paramname"><em>block_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="buffer_8h.html#ae34c2f95637029a49836360ddf075b3d">common::buffer_t</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write a single block from a buffer into onto the disk </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_num</td><td>The block to update </td></tr>
    <tr><td class="paramname">buffer</td><td>The buffer to read from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00080">80</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>                                                                       {</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="comment">// Ensure the buffer is in the right format</span></div>
<div class="line"><span class="lineno">   83</span>    buffer-&gt;set_offset(0);</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordtype">bool</span> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old</a> = buffer-&gt;update_offset;</div>
<div class="line"><span class="lineno">   85</span>    buffer-&gt;update_offset = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <span class="comment">// Read each sector of the block</span></div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a>; ++i)</div>
<div class="line"><span class="lineno">   89</span>        <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#af92c050fd33ce1edb06897b9c5fe0862">disk</a>-&gt;<a class="code hl_function" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a849c586fbc52b1994c282492addc4772">write</a>(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a7436ecf891301b9a4c9edb52212151db">partition_offset</a> + <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block_num</a> * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#aa2fb31420bd869e0f42e672e6ede97b2">sectors_per_block</a> + i, buffer, 512);</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    <span class="comment">// Reset buffer</span></div>
<div class="line"><span class="lineno">   92</span>    buffer-&gt;set_offset(0);</div>
<div class="line"><span class="lineno">   93</span>    buffer-&gt;update_offset = <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">old</a>;</div>
<div class="line"><span class="lineno">   94</span>}</div>
<div class="ttc" id="aclassMaxOS_1_1drivers_1_1disk_1_1Disk_html_a849c586fbc52b1994c282492addc4772"><div class="ttname"><a href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html#a849c586fbc52b1994c282492addc4772">MaxOS::drivers::disk::Disk::write</a></div><div class="ttdeci">void write(uint32_t sector, common::buffer_t *data)</div><div class="ttdoc">write data to the disk from a buffer (max capacity 512 bytes)</div><div class="ttdef"><b>Definition</b> <a href="disk_8cpp_source.html#l00050">disk.cpp:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00336">disk</a>, <a class="el" href="ext2_8h_source.html#l00337">partition_offset</a>, <a class="el" href="ext2_8h_source.html#l00348">sectors_per_block</a>, <a class="el" href="buffer_8cpp_source.html#l00128">MaxOS::common::Buffer::set_offset()</a>, <a class="el" href="buffer_8h_source.html#l00044">MaxOS::common::Buffer::update_offset</a>, and <a class="el" href="disk_8cpp_source.html#l00050">MaxOS::drivers::disk::Disk::write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00434">free_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00741">MaxOS::filesystem::format::ext2::Ext2File::write()</a>, and <a class="el" href="ext2_8cpp_source.html#l00102">write_inode()</a>.</p>

</div>
</div>
<a id="acd1055b2e0fc33cfd7b3ded4dd20c432" name="acd1055b2e0fc33cfd7b3ded4dd20c432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd1055b2e0fc33cfd7b3ded4dd20c432">&#9670;&#160;</a></span>write_inode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">void</a> Ext2Volume::write_inode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a>&#160;</td>
          <td class="paramname"><em>inode_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a> *&#160;</td>
          <td class="paramname"><em>inode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write an inode to the filesystem </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inode_num</td><td>The inode index </td></tr>
    <tr><td class="paramname">inode</td><td>The inode to read from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ext2_8cpp_source.html#l00102">102</a> of file <a class="el" href="ext2_8cpp_source.html">ext2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  102</span>                                                                     {</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    <span class="comment">// Locate the inode</span></div>
<div class="line"><span class="lineno">  105</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a> = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_num</a> - 1) / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group;</div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> index = (<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_num</a> - 1) % <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inodes_per_group;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    <span class="comment">// Locate the block</span></div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_table</a> = <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a28e53f409de30340066785e5a0d94993">block_groups</a>[<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">group</a>]-&gt;inode_table_address;</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> offset = index * <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a95e333eca8856f08ba4bc1724541a4b7">superblock</a>.inode_size;</div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a> = offset / <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>;</div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">uint32_t</a> <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">in_block_offset</a> = offset % <a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>;</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>    <span class="comment">// Read the inode</span></div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_class" href="classMaxOS_1_1common_1_1Buffer.html">buffer_t</a> buffer(<a class="code hl_variable" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a10014d7b0ae0cc94ea281d0e6ca56500">block_size</a>);</div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#ae4dc8f1dc35d79da9a4a577cf66792f3">read_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_table</a> + <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>, &amp;buffer);</div>
<div class="line"><span class="lineno">  117</span>    buffer.copy_from(inode, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="ext2_8h.html#adecfa9c752ab7847b442910a50c2fd66">inode_t</a>), <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">in_block_offset</a>);</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="comment">// Modify the block</span></div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_function" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html#a767863d034839b5f77efbca2e6eb905d">write_block</a>(<a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">inode_table</a> + <a class="code hl_class" href="classMaxOS_1_1common_1_1Rectangle.html">block</a>, &amp;buffer);</div>
<div class="line"><span class="lineno">  121</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ext2_8h_source.html#l00340">block_groups</a>, <a class="el" href="ext2_8h_source.html#l00342">block_size</a>, <a class="el" href="buffer_8cpp_source.html#l00195">MaxOS::common::Buffer::copy_from()</a>, <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, <a class="el" href="ext2_8h_source.html#l00339">superblock</a>, and <a class="el" href="ext2_8cpp_source.html#l00080">write_block()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, and <a class="el" href="ext2_8cpp_source.html#l00697">MaxOS::filesystem::format::ext2::InodeHandler::save()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a568c077e33ab4a474c65cfcaf934b215" name="a568c077e33ab4a474c65cfcaf934b215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a568c077e33ab4a474c65cfcaf934b215">&#9670;&#160;</a></span>block_group_descriptor_table_block</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t MaxOS::filesystem::format::ext2::Ext2Volume::block_group_descriptor_table_block</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Where the block group descriptor table starts. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00343">343</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

</div>
</div>
<a id="a7e8c97da6e5a645d3c69ec277b9f9a2e" name="a7e8c97da6e5a645d3c69ec277b9f9a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e8c97da6e5a645d3c69ec277b9f9a2e">&#9670;&#160;</a></span>block_group_descriptor_table_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t MaxOS::filesystem::format::ext2::Ext2Volume::block_group_descriptor_table_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How many block groups are in the block group descriptor table. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00344">344</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

</div>
</div>
<a id="a28e53f409de30340066785e5a0d94993" name="a28e53f409de30340066785e5a0d94993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28e53f409de30340066785e5a0d94993">&#9670;&#160;</a></span>block_groups</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ext2_8h.html#ab9db2de98fbe3eebbd1add91524aa7a1">block_group_descriptor_t</a>** MaxOS::filesystem::format::ext2::Ext2Volume::block_groups</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The block group descriptors. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00340">340</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00188">allocate_blocks()</a>, <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00434">free_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00149">read_inode()</a>, and <a class="el" href="ext2_8cpp_source.html#l00102">write_inode()</a>.</p>

</div>
</div>
<a id="a10014d7b0ae0cc94ea281d0e6ca56500" name="a10014d7b0ae0cc94ea281d0e6ca56500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10014d7b0ae0cc94ea281d0e6ca56500">&#9670;&#160;</a></span>block_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t MaxOS::filesystem::format::ext2::Ext2Volume::block_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How large each block is (in bytes) </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00342">342</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00360">bytes_to_blocks()</a>, <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00434">free_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00509">MaxOS::filesystem::format::ext2::InodeHandler::InodeHandler()</a>, <a class="el" href="ext2_8cpp_source.html#l00795">MaxOS::filesystem::format::ext2::Ext2File::read()</a>, <a class="el" href="ext2_8cpp_source.html#l00959">MaxOS::filesystem::format::ext2::Ext2Directory::read_from_disk()</a>, <a class="el" href="ext2_8cpp_source.html#l00149">read_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00741">MaxOS::filesystem::format::ext2::Ext2File::write()</a>, and <a class="el" href="ext2_8cpp_source.html#l00102">write_inode()</a>.</p>

</div>
</div>
<a id="af92c050fd33ce1edb06897b9c5fe0862" name="af92c050fd33ce1edb06897b9c5fe0862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af92c050fd33ce1edb06897b9c5fe0862">&#9670;&#160;</a></span>disk</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1drivers_1_1disk_1_1Disk.html">drivers::disk::Disk</a>* MaxOS::filesystem::format::ext2::Ext2Volume::disk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The disk that this volume is on. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00336">336</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, and <a class="el" href="ext2_8cpp_source.html#l00080">write_block()</a>.</p>

</div>
</div>
<a id="a07e488e15a650d14870a5d9654b23193" name="a07e488e15a650d14870a5d9654b23193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07e488e15a650d14870a5d9654b23193">&#9670;&#160;</a></span>ext2_lock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaxOS_1_1common_1_1Spinlock.html">common::Spinlock</a> MaxOS::filesystem::format::ext2::Ext2Volume::ext2_lock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lock for synchronised access to the volume (. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>: remove public?) </dd></dl>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00350">350</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00705">MaxOS::filesystem::format::ext2::InodeHandler::free()</a>, <a class="el" href="ext2_8cpp_source.html#l00795">MaxOS::filesystem::format::ext2::Ext2File::read()</a>, <a class="el" href="ext2_8cpp_source.html#l00959">MaxOS::filesystem::format::ext2::Ext2Directory::read_from_disk()</a>, and <a class="el" href="ext2_8cpp_source.html#l00741">MaxOS::filesystem::format::ext2::Ext2File::write()</a>.</p>

</div>
</div>
<a id="abc67bb9fb290354dca9c09c4ca5ff43d" name="abc67bb9fb290354dca9c09c4ca5ff43d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc67bb9fb290354dca9c09c4ca5ff43d">&#9670;&#160;</a></span>inodes_per_block</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t MaxOS::filesystem::format::ext2::Ext2Volume::inodes_per_block</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How many inodes fit in a block. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00347">347</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

</div>
</div>
<a id="a7436ecf891301b9a4c9edb52212151db" name="a7436ecf891301b9a4c9edb52212151db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7436ecf891301b9a4c9edb52212151db">&#9670;&#160;</a></span>partition_offset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="filesystem_8h.html#af466a9d32fd2bf17acb2efa91031ded0">lba_t</a> MaxOS::filesystem::format::ext2::Ext2Volume::partition_offset</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How far into the disk this partition starts. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00337">337</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, and <a class="el" href="ext2_8cpp_source.html#l00080">write_block()</a>.</p>

</div>
</div>
<a id="a6a06e6d63e1762b1921e67931e6bd3c7" name="a6a06e6d63e1762b1921e67931e6bd3c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a06e6d63e1762b1921e67931e6bd3c7">&#9670;&#160;</a></span>pointers_per_block</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t MaxOS::filesystem::format::ext2::Ext2Volume::pointers_per_block</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How many block pointers fit in a block. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00346">346</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

</div>
</div>
<a id="aa2fb31420bd869e0f42e672e6ede97b2" name="aa2fb31420bd869e0f42e672e6ede97b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2fb31420bd869e0f42e672e6ede97b2">&#9670;&#160;</a></span>sectors_per_block</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t MaxOS::filesystem::format::ext2::Ext2Volume::sectors_per_block</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How many sectors does a block take. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00348">348</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00129">read_block()</a>, and <a class="el" href="ext2_8cpp_source.html#l00080">write_block()</a>.</p>

</div>
</div>
<a id="a95e333eca8856f08ba4bc1724541a4b7" name="a95e333eca8856f08ba4bc1724541a4b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e333eca8856f08ba4bc1724541a4b7">&#9670;&#160;</a></span>superblock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ext2_8h.html#a15a4367643e7dc701198c82139f21ee1">superblock_t</a> MaxOS::filesystem::format::ext2::Ext2Volume::superblock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The superblock of the ext2 filesystem. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00339">339</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00464">free_blocks()</a>, <a class="el" href="ext2_8cpp_source.html#l00434">free_inode()</a>, <a class="el" href="ext2_8cpp_source.html#l00149">read_inode()</a>, and <a class="el" href="ext2_8cpp_source.html#l00102">write_inode()</a>.</p>

</div>
</div>
<a id="ac5a90acfd7dd067a9fa54e4a1ea0e707" name="ac5a90acfd7dd067a9fa54e4a1ea0e707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5a90acfd7dd067a9fa54e4a1ea0e707">&#9670;&#160;</a></span>total_block_groups</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t MaxOS::filesystem::format::ext2::Ext2Volume::total_block_groups</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>How many block groups are in the filesystem. </p>

<p class="definition">Definition at line <a class="el" href="ext2_8h_source.html#l00345">345</a> of file <a class="el" href="ext2_8h_source.html">ext2.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ext2_8cpp_source.html#l00188">allocate_blocks()</a>, and <a class="el" href="ext2_8cpp_source.html#l00370">create_inode()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/MaxOS/MaxOS/kernel/include/filesystem/format/<a class="el" href="ext2_8h_source.html">ext2.h</a></li>
<li>/home/runner/work/MaxOS/MaxOS/kernel/src/filesystem/format/<a class="el" href="ext2_8cpp_source.html">ext2.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>MaxOS</b></li><li class="navelem"><b>filesystem</b></li><li class="navelem"><b>format</b></li><li class="navelem"><b>ext2</b></li><li class="navelem"><a class="el" href="classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume.html">Ext2Volume</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
