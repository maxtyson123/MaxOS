.TH "MaxOS::processes::SharedMessageEndpoint" 3 "Version 0.1" "Max OS" \" -*- nroff -*-
.ad l
.nh
.SH NAME
MaxOS::processes::SharedMessageEndpoint \- A endpoint that allows processes to queue messages on\&.  

.SH SYNOPSIS
.br
.PP
.PP
\fC#include <ipc\&.h>\fP
.PP
Inherits \fBMaxOS::processes::Resource\fP\&.
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "\fBSharedMessageEndpoint\fP (\fBconst\fP \fBstring\fP &\fBname\fP, \fBsize_t\fP \fBsize\fP, resource_type_t \fBtype\fP)"
.br
.RI "Creates a new shared message endpoint\&. "
.ti -1c
.RI "\fBint\fP \fBread\fP (\fBvoid\fP *buffer, \fBsize_t\fP \fBsize\fP, \fBsize_t\fP \fBflags\fP) \fBfinal\fP"
.br
.RI "Reads the first message from the endpoint or will yield until a message has been written\&. "
.ti -1c
.RI "\fBint\fP \fBwrite\fP (\fBconst\fP \fBvoid\fP *buffer, \fBsize_t\fP \fBsize\fP, \fBsize_t\fP \fBflags\fP) \fBfinal\fP"
.br
.RI "Handles writing to the message endpoint resource by writing the buffer as a message\&. "
.in -1c

Public Member Functions inherited from \fBMaxOS::processes::Resource\fP
.in +1c
.ti -1c
.RI "\fBResource\fP (const \fBstring\fP &\fBname\fP, size_t \fBflags\fP, resource_type_t \fBtype\fP)"
.br
.RI "Constructs a new \fBResource\fP object\&. "
.ti -1c
.RI "\fBstring\fP \fBname\fP ()"
.br
.RI "Gets the name of this resource\&. "
.ti -1c
.RI "resource_type_t \fBtype\fP ()"
.br
.RI "Gets the type of this resource\&. "
.ti -1c
.RI "virtual void \fBopen\fP (size_t \fBflags\fP)"
.br
.RI "Opens the resource\&. "
.ti -1c
.RI "virtual void \fBclose\fP (size_t \fBflags\fP)"
.br
.RI "Closes the resource\&. "
.in -1c
.SH "Detailed Description"
.PP 
A endpoint that allows processes to queue messages on\&. 
.PP
Definition at line \fB54\fP of file \fBipc\&.h\fP\&.
.SH "Constructor & Destructor Documentation"
.PP 
.SS "SharedMessageEndpoint::SharedMessageEndpoint (\fBconst\fP \fBstring\fP & name, \fBsize_t\fP size, resource_type_t type)"

.PP
Creates a new shared message endpoint\&. 
.PP
\fBParameters\fP
.RS 4
\fIname\fP The name of the endpoint 
.br
\fIsize\fP The size of messages that can be sent 
.br
\fItype\fP The type of resource 
.RE
.PP

.PP
Definition at line \fB112\fP of file \fBipc\&.cpp\fP\&..PP
.nf
113 : Resource(name, size, type)
114 {
115 
116 }
.fi

.SS "SharedMessageEndpoint::~SharedMessageEndpoint ()\fC [final]\fP"

.PP
Definition at line \fB118\fP of file \fBipc\&.cpp\fP\&..PP
.nf
118                                               {
119 
120     // Free the messages
121     for(auto& message : m_queue)
122         delete message;
123 }
.fi

.SH "Member Function Documentation"
.PP 
.SS "\fBint\fP SharedMessageEndpoint::read (\fBvoid\fP * buffer, \fBsize_t\fP size, \fBsize_t\fP flags)\fC [final]\fP, \fC [virtual]\fP"

.PP
Reads the first message from the endpoint or will yield until a message has been written\&. 
.PP
\fBParameters\fP
.RS 4
\fIbuffer\fP Where to write the message to 
.br
\fIsize\fP Max size of the message to be read 
.br
\fIflags\fP Unused 
.RE
.PP
\fBReturns\fP
.RS 4
The amount of bytes read 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::processes::Resource\fP\&.
.PP
Definition at line \fB133\fP of file \fBipc\&.cpp\fP\&..PP
.nf
133                                                                        {
134 
135     // Wait for a message
136     if(m_queue\&.empty())
137         return \-1 * (int)resource_error_base_t::SHOULD_BLOCK;
138 
139     // Read the message into the buffer
140     buffer_t* message = m_queue\&.pop_front();
141     size_t readable = size > message\->capacity() ? message\->capacity() : size;
142     memcpy(buffer, message \-> raw(), readable);
143 
144     return readable;
145 }
.fi

.PP
References \fBmemcpy()\fP, and \fBsize\fP\&.
.SS "\fBint\fP SharedMessageEndpoint::write (\fBconst\fP \fBvoid\fP * buffer, \fBsize_t\fP size, \fBsize_t\fP flags)\fC [final]\fP, \fC [virtual]\fP"

.PP
Handles writing to the message endpoint resource by writing the buffer as a message\&. 
.PP
\fBParameters\fP
.RS 4
\fIbuffer\fP The message to write to the endpoint 
.br
\fIsize\fP The size of the message 
.br
\fIflags\fP Unused 
.RE
.PP
\fBReturns\fP
.RS 4
The amount of bytes written 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::processes::Resource\fP\&.
.PP
Definition at line \fB155\fP of file \fBipc\&.cpp\fP\&..PP
.nf
155                                                                               {
156 
157     m_message_lock\&.lock();
158 
159     // Create the message
160     auto* new_message = new buffer_t(size);
161     new_message\->copy_from(buffer, size);
162     m_queue\&.push_back(new_message);
163 
164     m_message_lock\&.unlock();
165     return size;
166 }
.fi

.PP
References \fBMaxOS::common::Spinlock::lock()\fP, \fBsize\fP, and \fBMaxOS::common::Spinlock::unlock()\fP\&.

.SH "Author"
.PP 
Generated automatically by Doxygen for Max OS from the source code\&.
