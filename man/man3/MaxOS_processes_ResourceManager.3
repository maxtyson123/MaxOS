.TH "MaxOS::processes::ResourceManager" 3 "Version 0.1" "Max OS" \" -*- nroff -*-
.ad l
.nh
.SH NAME
MaxOS::processes::ResourceManager \- Manages the open resources for a process\&.  

.SH SYNOPSIS
.br
.PP
.PP
\fC#include <resource\&.h>\fP
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "\fBcommon::Map\fP< uint64_t, \fBResource\fP * > \fBresources\fP ()"
.br
.RI "Get the resources currently open\&. "
.ti -1c
.RI "uint64_t \fBopen_resource\fP (resource_type_t \fBtype\fP, const \fBstring\fP &\fBname\fP, size_t \fBflags\fP)"
.br
.RI "Registers a resource with the resource manager and then opens it\&. "
.ti -1c
.RI "void \fBclose_resource\fP (uint64_t handle, size_t \fBflags\fP)"
.br
.RI "Un registers the resource and then closes it\&. "
.ti -1c
.RI "\fBResource\fP * \fBget_resource\fP (uint64_t handle)"
.br
.RI "Gets a resource based on the handle id\&. "
.ti -1c
.RI "\fBResource\fP * \fBget_resource\fP (const \fBstring\fP &\fBname\fP)"
.br
.RI "Finds a resource by name\&. "
.in -1c
.SH "Detailed Description"
.PP 
Manages the open resources for a process\&. 
.PP
Definition at line \fB134\fP of file \fBresource\&.h\fP\&.
.SH "Constructor & Destructor Documentation"
.PP 
.SS "ResourceManager::~ResourceManager ()"

.PP
Definition at line \fB249\fP of file \fBresource\&.cpp\fP\&..PP
.nf
249                                  {
250 
251     // Collect all resources (as closing will break iteration)
252     common::Vector<uint64_t> handles;
253     for (const auto& kv : m_resources)
254         handles\&.push_back(kv\&.first);
255 
256     // Close the resources
257     for (auto h : handles)
258         close_resource(h, 0);
259 
260 };
.fi

.SH "Member Function Documentation"
.PP 
.SS "void ResourceManager::close_resource (uint64_t handle, size_t flags)"

.PP
Un registers the resource and then closes it\&. 
.PP
\fBParameters\fP
.RS 4
\fIhandle\fP The handle number of the resource 
.br
\fIflags\fP Flags to pass to the closing 
.RE
.PP

.PP
Definition at line \fB301\fP of file \fBresource\&.cpp\fP\&..PP
.nf
301                                                                   {
302 
303     auto it = m_resources\&.find(handle);
304     if(it == m_resources\&.end())
305         return;
306 
307     // Remove it
308     Resource* resource = it\->second;
309     m_resources\&.erase(handle);
310 
311     // Close it
312     GlobalResourceRegistry::get_registry(resource\->type()) \-> close_resource(resource, flags);
313 }
.fi

.PP
References \fBclose_resource()\fP, \fBflags\fP, \fBMaxOS::processes::GlobalResourceRegistry::get_registry()\fP, and \fBMaxOS::processes::Resource::type()\fP\&.
.PP
Referenced by \fBclose_resource()\fP\&.
.SS "\fBResource\fP * ResourceManager::get_resource (const \fBstring\fP & name)"

.PP
Finds a resource by name\&. 
.PP
\fBParameters\fP
.RS 4
\fIname\fP The name of the resource 
.RE
.PP
\fBReturns\fP
.RS 4
The resource or nullptr if not found 
.RE
.PP

.PP
Definition at line \fB335\fP of file \fBresource\&.cpp\fP\&..PP
.nf
335                                                           {
336 
337     for(const auto& resource : m_resources)
338         if(resource\&.second\->name() == name)
339             return resource\&.second;
340 
341     return nullptr;
342 }
.fi

.PP
References \fBname\fP\&.
.SS "\fBResource\fP * ResourceManager::get_resource (uint64_t handle)"

.PP
Gets a resource based on the handle id\&. 
.PP
\fBParameters\fP
.RS 4
\fIhandle\fP The handle number of the resource 
.RE
.PP
\fBReturns\fP
.RS 4
The resource or nullptr if not found 
.RE
.PP

.PP
Definition at line \fB321\fP of file \fBresource\&.cpp\fP\&..PP
.nf
321                                                        {
322 
323     if(m_resources\&.find(handle) == m_resources\&.end())
324         return nullptr;
325 
326     return m_resources[handle];
327 }
.fi

.PP
Referenced by \fBopen_resource()\fP\&.
.SS "uint64_t ResourceManager::open_resource (resource_type_t type, const \fBstring\fP & name, size_t flags)"

.PP
Registers a resource with the resource manager and then opens it\&. 
.PP
\fBParameters\fP
.RS 4
\fItype\fP The type of resource to register 
.br
\fIname\fP The name of the resource 
.br
\fIflags\fP Per resource flags for opening 
.RE
.PP
\fBReturns\fP
.RS 4
The handle id of the resource or 0 if failed 
.RE
.PP

.PP
Definition at line \fB280\fP of file \fBresource\&.cpp\fP\&..PP
.nf
280                                                                                               {
281 
282     // Get the resource
283     auto resource = GlobalResourceRegistry::get_registry(type) \-> get_resource(name);
284     if(!resource)
285         return 0;
286 
287     // Store it
288     m_resources\&.insert(m_next_handle, resource);
289 
290     // Open it
291     resource\->open(flags);
292     return m_next_handle++;
293 }
.fi

.PP
References \fBflags\fP, \fBMaxOS::processes::GlobalResourceRegistry::get_registry()\fP, \fBget_resource()\fP, \fBname\fP, and \fBtype\fP\&.
.SS "\fBcommon::Map\fP< uint64_t, \fBResource\fP * > ResourceManager::resources ()"

.PP
Get the resources currently open\&. 
.PP
\fBReturns\fP
.RS 4
The resources 
.RE
.PP

.PP
Definition at line \fB267\fP of file \fBresource\&.cpp\fP\&..PP
.nf
267                                                           {
268 
269     return m_resources;
270 }
.fi


.SH "Author"
.PP 
Generated automatically by Doxygen for Max OS from the source code\&.
