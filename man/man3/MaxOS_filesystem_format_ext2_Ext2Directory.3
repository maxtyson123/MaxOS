.TH "MaxOS::filesystem::format::ext2::Ext2Directory" 3 "Version 0.1" "Max OS" \" -*- nroff -*-
.ad l
.nh
.SH NAME
MaxOS::filesystem::format::ext2::Ext2Directory \- Handles the directory operations on the ext2 filesystem\&.  

.SH SYNOPSIS
.br
.PP
.PP
\fC#include <ext2\&.h>\fP
.PP
Inherits \fBMaxOS::filesystem::Directory\fP\&.
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "\fBExt2Directory\fP (\fBExt2Volume\fP *\fBvolume\fP, \fBuint32_t\fP \fBinode\fP, \fBconst\fP \fBstring\fP &\fBname\fP)"
.br
.RI "Construct a new Ext2 \fBDirectory\fP object\&. "
.ti -1c
.RI "\fBvoid\fP \fBread_from_disk\fP () \fBfinal\fP"
.br
.RI "Read the directory from the inode on the disk\&. "
.ti -1c
.RI "\fBFile\fP * \fBcreate_file\fP (\fBconst\fP \fBstring\fP &\fBname\fP) \fBfinal\fP"
.br
.RI "Create a new file in the directory\&. "
.ti -1c
.RI "\fBvoid\fP \fBremove_file\fP (\fBconst\fP \fBstring\fP &\fBname\fP) \fBfinal\fP"
.br
.RI "Delete a file from this directory\&. "
.ti -1c
.RI "\fBvoid\fP \fBrename_file\fP (\fBconst\fP \fBstring\fP &\fBold_name\fP, \fBconst\fP \fBstring\fP &\fBnew_name\fP) \fBfinal\fP"
.br
.RI "Renames the file from the old name to the new name if it exists\&. "
.ti -1c
.RI "\fBDirectory\fP * \fBcreate_subdirectory\fP (\fBconst\fP \fBstring\fP &\fBname\fP) \fBfinal\fP"
.br
.RI "Create a new directory in the directory\&. "
.ti -1c
.RI "\fBvoid\fP \fBremove_subdirectory\fP (\fBconst\fP \fBstring\fP &\fBname\fP) \fBfinal\fP"
.br
.RI "Remove a directory entry from the directory\&. "
.ti -1c
.RI "\fBvoid\fP \fBrename_subdirectory\fP (\fBconst\fP \fBstring\fP &\fBold_name\fP, \fBconst\fP \fBstring\fP &\fBnew_name\fP) \fBfinal\fP"
.br
.RI "Renames the directory from the old name to the new name if it exists\&. "
.in -1c

Public Member Functions inherited from \fBMaxOS::filesystem::Directory\fP
.in +1c
.ti -1c
.RI "\fBcommon::Vector\fP< \fBFile\fP * > \fBfiles\fP ()"
.br
.RI "Get the files in the directory\&. "
.ti -1c
.RI "\fBcommon::Vector\fP< \fBDirectory\fP * > \fBsubdirectories\fP ()"
.br
.RI "Get the subdirectories in the directory\&. "
.ti -1c
.RI "\fBFile\fP * \fBopen_file\fP (\fBconst\fP \fBstring\fP &\fBname\fP)"
.br
.RI "Open a file in the directory\&. "
.ti -1c
.RI "\fBDirectory\fP * \fBopen_subdirectory\fP (\fBconst\fP \fBstring\fP &\fBname\fP)"
.br
.RI "Open a directory in the directory\&. "
.ti -1c
.RI "\fBvoid\fP \fBrename_file\fP (\fBFile\fP *file, \fBconst\fP \fBstring\fP &\fBnew_name\fP)"
.br
.RI "Rename a file in the directory\&. "
.ti -1c
.RI "\fBvoid\fP \fBrename_subdirectory\fP (\fBDirectory\fP *directory, \fBconst\fP \fBstring\fP &\fBnew_name\fP)"
.br
.RI "Rename a subdirectory in the directory\&. "
.ti -1c
.RI "\fBstring\fP \fBname\fP ()"
.br
.RI "Get the name of the directory\&. "
.ti -1c
.RI "\fBsize_t\fP \fBsize\fP ()"
.br
.RI "Get the size of the directory\&. "
.in -1c
.SS "Additional Inherited Members"


Protected Attributes inherited from \fBMaxOS::filesystem::Directory\fP
.in +1c
.ti -1c
.RI "\fBcommon::Vector\fP< \fBFile\fP * > \fBm_files\fP"
.br
.RI "The files in this directory\&. "
.ti -1c
.RI "\fBcommon::Vector\fP< \fBDirectory\fP * > \fBm_subdirectories\fP"
.br
.RI "The subdirectories in this directory\&. "
.ti -1c
.RI "\fBstring\fP \fBm_name\fP"
.br
.RI "The name of this directory\&. "
.in -1c
.SH "Detailed Description"
.PP 
Handles the directory operations on the ext2 filesystem\&. 
.PP
Definition at line \fB406\fP of file \fBext2\&.h\fP\&.
.SH "Constructor & Destructor Documentation"
.PP 
.SS "Ext2Directory::Ext2Directory (\fBExt2Volume\fP * volume, \fBuint32_t\fP inode, \fBconst\fP \fBstring\fP & name)"

.PP
Construct a new Ext2 \fBDirectory\fP object\&. 
.PP
\fBParameters\fP
.RS 4
\fIvolume\fP The volume the directory exists on 
.br
\fIinode\fP The inode number of the directory (will be used to setup the internal \fBInodeHandler\fP) 
.br
\fIname\fP The name of the directory 
.RE
.PP

.PP
Definition at line \fB853\fP of file \fBext2\&.cpp\fP\&..PP
.nf
854 : m_volume(volume),
855   m_inode(m_volume, inode)
856 {
857     m_name = name;
858 }
.fi

.PP
References \fBMaxOS::filesystem::Directory::m_name\fP, and \fBMaxOS::filesystem::Directory::name()\fP\&.
.SH "Member Function Documentation"
.PP 
.SS "\fBFile\fP * Ext2Directory::create_file (\fBconst\fP \fBstring\fP & name)\fC [final]\fP, \fC [virtual]\fP"

.PP
Create a new file in the directory\&. 
.PP
\fBParameters\fP
.RS 4
\fIname\fP The name of the file to create 
.RE
.PP
\fBReturns\fP
.RS 4
The new file object or null if it could not be created 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB1083\fP of file \fBext2\&.cpp\fP\&..PP
.nf
1083                                                    {
1084 
1085     // Check if the file already exists
1086     for (auto &file: m_files)
1087         if (file\->name() == name)
1088             return nullptr;
1089 
1090     // Create the file
1091     auto file = new Ext2File(m_volume, create_entry(name, 0, false)\&.inode, name);
1092     m_files\&.push_back(file);
1093     return file;
1094 }
.fi

.PP
References \fBinode\fP, \fBMaxOS::filesystem::Directory::m_files\fP, and \fBMaxOS::filesystem::Directory::name()\fP\&.
.SS "\fBDirectory\fP * Ext2Directory::create_subdirectory (\fBconst\fP \fBstring\fP & name)\fC [final]\fP, \fC [virtual]\fP"

.PP
Create a new directory in the directory\&. 
.PP
\fBParameters\fP
.RS 4
\fIname\fP The name of the directory to create 
.RE
.PP
\fBReturns\fP
.RS 4
The new directory object or null if it could not be created 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB1121\fP of file \fBext2\&.cpp\fP\&..PP
.nf
1121                                                                 {
1122 
1123     // Check if the directory already exists
1124     for (auto &subdirectory: m_subdirectories)
1125         if (subdirectory\->name() == name)
1126             return nullptr;
1127 
1128     // Store the directory
1129     auto directory = new Ext2Directory(m_volume, create_entry(name, 0, true)\&.inode, name);
1130     m_subdirectories\&.push_back(directory);
1131 
1132     // Create self & parent references
1133     directory\->create_entry("\&.", directory\->m_inode\&.inode_number, true);
1134     directory\->create_entry("\&.\&.", m_inode\&.inode_number, true);
1135 
1136     return directory;
1137 }
.fi

.PP
References \fBinode\fP, \fBMaxOS::filesystem::format::ext2::InodeHandler::inode_number\fP, \fBMaxOS::filesystem::Directory::m_subdirectories\fP, and \fBMaxOS::filesystem::Directory::name()\fP\&.
.SS "\fBvoid\fP Ext2Directory::read_from_disk ()\fC [final]\fP, \fC [virtual]\fP"

.PP
Read the directory from the inode on the disk\&. 
.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB959\fP of file \fBext2\&.cpp\fP\&..PP
.nf
959                                    {
960 
961     m_volume\->ext2_lock\&.lock();
962     m_entries\&.clear();
963     m_entry_names\&.clear();
964 
965     // Clear the old files & Directories
966     for (auto &file: m_files)
967         delete file;
968     m_files\&.clear();
969 
970     for (auto &directory: m_subdirectories)
971         delete directory;
972     m_subdirectories\&.clear();
973 
974     // Read the direct blocks (cant use for( : ))
975     buffer_t buffer(m_volume\->block_size);
976     for (int i = 0; i < m_inode\&.block_cache\&.size(); ++i) {
977         uint32_t block_pointer = m_inode\&.block_cache[i];
978 
979         // Invalid block
980         if (block_pointer == 0)
981             break;
982 
983         // Parse the block
984         m_volume\->read_block(block_pointer, &buffer);
985         parse_block(&buffer);
986     }
987 
988     m_volume\->ext2_lock\&.unlock();
989 }
.fi

.PP
References \fBMaxOS::filesystem::format::ext2::InodeHandler::block_cache\fP, \fBMaxOS::filesystem::format::ext2::Ext2Volume::block_size\fP, \fBMaxOS::common::Vector< Type >::clear()\fP, \fBMaxOS::filesystem::format::ext2::Ext2Volume::ext2_lock\fP, \fBMaxOS::common::Spinlock::lock()\fP, \fBMaxOS::filesystem::Directory::m_files\fP, \fBMaxOS::filesystem::Directory::m_subdirectories\fP, \fBMaxOS::filesystem::format::ext2::Ext2Volume::read_block()\fP, \fBMaxOS::common::Vector< Type >::size()\fP, and \fBMaxOS::common::Spinlock::unlock()\fP\&.
.SS "\fBvoid\fP Ext2Directory::remove_file (\fBconst\fP \fBstring\fP & name)\fC [final]\fP, \fC [virtual]\fP"

.PP
Delete a file from this directory\&. 
.PP
\fBParameters\fP
.RS 4
\fIname\fP The name of the file to delete 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB1101\fP of file \fBext2\&.cpp\fP\&..PP
.nf
1101                                                   {
1102     remove_entry(name, false);
1103 }
.fi

.PP
References \fBMaxOS::filesystem::Directory::name()\fP\&.
.SS "\fBvoid\fP Ext2Directory::remove_subdirectory (\fBconst\fP \fBstring\fP & name)\fC [final]\fP, \fC [virtual]\fP"

.PP
Remove a directory entry from the directory\&. 
.PP
\fBParameters\fP
.RS 4
\fIname\fP The name of the entry to remove 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB1144\fP of file \fBext2\&.cpp\fP\&..PP
.nf
1144                                                           {
1145     remove_entry(name, true);
1146 }
.fi

.PP
References \fBMaxOS::filesystem::Directory::name()\fP\&.
.SS "\fBvoid\fP Ext2Directory::rename_file (\fBconst\fP \fBstring\fP & old_name, \fBconst\fP \fBstring\fP & new_name)\fC [final]\fP, \fC [virtual]\fP"

.PP
Renames the file from the old name to the new name if it exists\&. 
.PP
\fBParameters\fP
.RS 4
\fIold_name\fP The current name of the file that is to be changed 
.br
\fInew_name\fP What the new name should be 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB1111\fP of file \fBext2\&.cpp\fP\&..PP
.nf
1111                                                                               {
1112     rename_entry(old_name, new_name, false);
1113 }
.fi

.SS "\fBvoid\fP Ext2Directory::rename_subdirectory (\fBconst\fP \fBstring\fP & old_name, \fBconst\fP \fBstring\fP & new_name)\fC [final]\fP, \fC [virtual]\fP"

.PP
Renames the directory from the old name to the new name if it exists\&. 
.PP
\fBParameters\fP
.RS 4
\fIold_name\fP The current name of the directory that is to be changed 
.br
\fInew_name\fP What the new name should be 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::filesystem::Directory\fP\&.
.PP
Definition at line \fB1154\fP of file \fBext2\&.cpp\fP\&..PP
.nf
1154                                                                                       {
1155     rename_entry(old_name, new_name, true);
1156 }
.fi


.SH "Author"
.PP 
Generated automatically by Doxygen for Max OS from the source code\&.
