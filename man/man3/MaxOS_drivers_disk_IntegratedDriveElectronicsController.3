.TH "MaxOS::drivers::disk::IntegratedDriveElectronicsController" 3 "Version 0.3" "Max OS" \" -*- nroff -*-
.ad l
.nh
.SH NAME
MaxOS::drivers::disk::IntegratedDriveElectronicsController \- \fBDriver\fP for the IDE controller, handles the creation and management of the IDE devices\&.  

.SH SYNOPSIS
.br
.PP
.PP
\fC#include <ide\&.h>\fP
.PP
Inherits \fBMaxOS::drivers::Driver\fP\&.
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "\fBIntegratedDriveElectronicsController\fP (\fBhardwarecommunication::PCIDeviceDescriptor\fP *device_descriptor)"
.br
.RI "Construct a new Integrated Drive Electronics Controller object\&. "
.ti -1c
.RI "void \fBinitialise\fP () final"
.br
.RI "Initialise the IDE controller by identifying the devices\&. "
.ti -1c
.RI "void \fBactivate\fP () final"
.br
.RI "Activate the IDE controller by mounting the devices to the virtual file system\&. "
.ti -1c
.RI "\fBstring\fP \fBvendor_name\fP () final"
.br
.RI "Get the vendor name\&. "
.ti -1c
.RI "\fBstring\fP \fBdevice_name\fP () final"
.br
.RI "Get the device name\&. "
.in -1c

Public Member Functions inherited from \fBMaxOS::drivers::Driver\fP
.in +1c
.ti -1c
.RI "\fBvirtual\fP \fBvoid\fP \fBdeactivate\fP ()"
.br
.RI "Deactivate the driver\&. "
.ti -1c
.RI "\fBvirtual\fP \fBuint32_t\fP \fBreset\fP ()"
.br
.RI "Reset the driver\&. "
.in -1c
.SH "Detailed Description"
.PP 
\fBDriver\fP for the IDE controller, handles the creation and management of the IDE devices\&. 
.PP
Definition at line \fB25\fP of file \fBide\&.h\fP\&.
.SH "Constructor & Destructor Documentation"
.PP 
.SS "IntegratedDriveElectronicsController::IntegratedDriveElectronicsController (\fBhardwarecommunication::PCIDeviceDescriptor\fP * device_descriptor)\fC [explicit]\fP"

.PP
Construct a new Integrated Drive Electronics Controller object\&. 
.PP
\fBParameters\fP
.RS 4
\fIdevice_descriptor\fP The PCI device descriptor for this controller 
.RE
.PP
\fBTodo\fP
.RS 4
Use the device descriptor to get the port base and add the devices dynamically 
.RE
.PP

.PP
Definition at line \fB25\fP of file \fBide\&.cpp\fP\&..PP
.nf
26 {
27     // Primary
28     auto primary_maser = new AdvancedTechnologyAttachment(0x1F0, true);
29     auto primary_slave = new AdvancedTechnologyAttachment(0x1F0, false);
30     devices\&.insert(primary_maser, true);
31     devices\&.insert(primary_slave, false);
32 
33     // Secondary
34     auto secondary_maser = new AdvancedTechnologyAttachment(0x170, true);
35     auto secondary_slave = new AdvancedTechnologyAttachment(0x170, false);
36     devices\&.insert(secondary_maser, true);
37     devices\&.insert(secondary_slave, false);
38 
39 }
.fi

.SH "Member Function Documentation"
.PP 
.SS "void IntegratedDriveElectronicsController::activate ()\fC [final]\fP, \fC [virtual]\fP"

.PP
Activate the IDE controller by mounting the devices to the virtual file system\&. 
.PP
Reimplemented from \fBMaxOS::drivers::Driver\fP\&.
.PP
Definition at line \fB74\fP of file \fBide\&.cpp\fP\&..PP
.nf
74                                                     {
75 
76     // Loop through the devices and load the partitions
77     for (auto &device: devices) {
78 
79         // Ensure there is a device and that it is the master
80         if (device\&.first == nullptr || !device\&.second)
81             continue;
82 
83         // Mount the device
84         MSDOSPartition::mount_partitions(device\&.first);
85 
86     }
87 }
.fi

.PP
References \fBMaxOS::filesystem::partition::MSDOSPartition::mount_partitions()\fP\&.
.SS "\fBstring\fP IntegratedDriveElectronicsController::device_name ()\fC [final]\fP, \fC [virtual]\fP"

.PP
Get the device name\&. 
.PP
\fBReturns\fP
.RS 4
The device name 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::drivers::Driver\fP\&.
.PP
Definition at line \fB104\fP of file \fBide\&.cpp\fP\&..PP
.nf
104                                                          {
105     return "PIIX4";
106 }
.fi

.SS "void IntegratedDriveElectronicsController::initialise ()\fC [final]\fP, \fC [virtual]\fP"

.PP
Initialise the IDE controller by identifying the devices\&. 
.PP
Reimplemented from \fBMaxOS::drivers::Driver\fP\&.
.PP
Definition at line \fB46\fP of file \fBide\&.cpp\fP\&..PP
.nf
46                                                       {
47 
48     // Loop through the devices and identify them
49     for (auto &device: devices) {
50 
51         // Check if the device is present
52         auto ata_device = device\&.first;
53         if (ata_device == nullptr)
54             continue;
55 
56         // Identify the device
57         bool exists = ata_device\->identify();
58 
59         // Remove the device if it does not exist
60         if (!exists) {
61             devices\&.erase(ata_device);
62             delete ata_device;
63             continue;
64         }
65     }
66 
67     // Log the init done
68     Logger::DEBUG() << "IDE Controller: Initialised " << devices\&.size() << " devices\\n";
69 }
.fi

.PP
References \fBMaxOS::Logger::DEBUG()\fP\&.
.SS "\fBstring\fP IntegratedDriveElectronicsController::vendor_name ()\fC [final]\fP, \fC [virtual]\fP"

.PP
Get the vendor name\&. 
.PP
\fBReturns\fP
.RS 4
The vendor name 
.RE
.PP

.PP
Reimplemented from \fBMaxOS::drivers::Driver\fP\&.
.PP
Definition at line \fB95\fP of file \fBide\&.cpp\fP\&..PP
.nf
95                                                          {
96     return "Intel";
97 }
.fi


.SH "Author"
.PP 
Generated automatically by Doxygen for Max OS from the source code\&.
