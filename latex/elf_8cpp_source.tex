\doxysection{elf.\+cpp}
\hypertarget{elf_8cpp_source}{}\label{elf_8cpp_source}\index{/home/runner/work/MaxOS/MaxOS/kernel/src/processes/elf.cpp@{/home/runner/work/MaxOS/MaxOS/kernel/src/processes/elf.cpp}}
\mbox{\hyperlink{elf_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{elf_8h}{processes/elf.h}}>}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{logger_8h}{common/logger.h}}>}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00012}00012\ \textcolor{keyword}{using\ namespace\ }MaxOS;}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00013}00013\ \textcolor{keyword}{using\ namespace\ }MaxOS::processes;}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00014}00014\ \textcolor{keyword}{using\ namespace\ }MaxOS::memory;}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00023}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a693e612e03aa87da373b65a7a182699a}{00023}}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a693e612e03aa87da373b65a7a182699a}{ELF64::ELF64}}(uintptr\_t\ elf\_header\_address)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00024}00024\ :\ m\_elf\_header\_address(elf\_header\_address)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00025}00025\ \{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00026}00026\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00031}00031\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a90a82f049a3346de9765553d1404c9cd}{ELF64::\string~ELF64}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00038}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_ab443619beef6efe646ef975e05f81154}{00038}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_ab443619beef6efe646ef975e05f81154}{ELF64::load}}()\ \{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00040}00040\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_af016428ffefa07a491eec7ade744c871}{is\_valid}}())}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00043}00043\ \ \ \ \ load\_program\_headers();}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00045}00045\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00052}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{00052}}\ \mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFHeader64}{elf\_64\_header\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{ELF64::header}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFHeader64}{elf\_64\_header\_t}}*)\ m\_elf\_header\_address;}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00055}00055\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00063}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_aaa2656b4536386b3d5e5453bdd96f609}{00063}}\ \mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64}{elf\_64\_program\_header\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_aaa2656b4536386b3d5e5453bdd96f609}{ELF64::get\_program\_header}}(\textcolor{keywordtype}{size\_t}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00065}00065\ \ \ \ \ \textcolor{comment}{//\ Check\ bounds}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00066}00066\ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ >=\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>program\_header\_count)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00069}00069\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ program\ headers\ and\ return\ the\ item}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00070}00070\ \ \ \ \ \textcolor{keyword}{auto}*\ program\_headers\ =\ (\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64}{elf\_64\_program\_header\_t}}*)\ (m\_elf\_header\_address\ +\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFHeader64_a5afa938ac577a33496cbcc7b28477413}{program\_header\_offset}});}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00071}00071\ \ \ \ \ \textcolor{keywordflow}{return}\ \&program\_headers[index];}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00073}00073\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00081}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_add8f22242d8065457d76fcdd2350d7a4}{00081}}\ \mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFSectionHeader64}{elf\_64\_section\_header\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_add8f22242d8065457d76fcdd2350d7a4}{ELF64::get\_section\_header}}(\textcolor{keywordtype}{size\_t}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00083}00083\ \ \ \ \ \textcolor{comment}{//\ Check\ bound}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00084}00084\ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ >=\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>section\_header\_count)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00087}00087\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ section\ headers\ and\ return\ the\ item}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00088}00088\ \ \ \ \ \textcolor{keyword}{auto}*\ section\_headers\ =\ (\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFSectionHeader64}{elf\_64\_section\_header\_t}}*)\ (m\_elf\_header\_address\ +\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFHeader64_a1e18c4659f1def551316389e82ff1013}{section\_header\_offset}});}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00089}00089\ \ \ \ \ \textcolor{keywordflow}{return}\ \&section\_headers[index];}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00091}00091\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00100}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_af016428ffefa07a491eec7ade744c871}{00100}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_af016428ffefa07a491eec7ade744c871}{ELF64::is\_valid}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00102}00102\ \ \ \ \ \textcolor{comment}{//\ Validate\ the\ magic\ number}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00103}00103\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ 4;\ i++)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>identification[i]\ !=\ \mbox{\hyperlink{elf_8h_a60468c9b874171eb38c09df2673f64de}{ELF\_MAGIC}}[i])}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00107}00107\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ elf\ is\ 64\ bit}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00108}00108\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>identification[(\textcolor{keywordtype}{int})\ ELFIdentification::Class]\ !=\ (\textcolor{keywordtype}{int})\ ELFClass::Bits64)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00111}00111\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ elf\ is\ little\ endian}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00112}00112\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>identification[(\textcolor{keywordtype}{int})\ ELFIdentification::Data]\ !=\ (\textcolor{keywordtype}{int})\ ELFData::LittleEndian)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00115}00115\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ elf\ is\ version\ 1}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00116}00116\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>identification[(\textcolor{keywordtype}{int})\ ELFIdentification::Version]\ !=\ (\textcolor{keywordtype}{int})\ ELFVersion::Current)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00117}00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00119}00119\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ elf\ is\ for\ the\ MaxOS\ platform}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00120}00120\ \ \ \ \ \textcolor{comment}{//\ \ if(header()\ -\/>\ identification[OSABI]\ !=\ MaxOSABI)}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00121}00121\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ return\ false;}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00123}00123\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ elf\ is\ executable}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00124}00124\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>type\ !=\ (\textcolor{keywordtype}{int})\ ELFType::Executable)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00125}00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00127}00127\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ elf\ is\ for\ the\ x86\_64\ platform}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00128}00128\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>machine\ !=\ (\textcolor{keywordtype}{int})\ ELFMachine::x86\_64)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00131}00131\ \ \ \ \ \textcolor{comment}{//\ LGTM}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00132}00132\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00134}00134\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00139}00139\ \textcolor{keywordtype}{void}\ ELF64::load\_program\_headers()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00141}00141\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a51568ae69a0932094723ca3045472b91}{header}}()-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFHeader64_a9554de7a56a4825d6443be5b9aad1900}{program\_header\_count}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ header\ information}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64}{elf\_64\_program\_header\_t}}*\ program\_header\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_aaa2656b4536386b3d5e5453bdd96f609}{get\_program\_header}}(i);}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ load\ headers\ that\ actually\ need\ loading}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a209eaf6e39e9d2d239a6831b63c8da33}{type}}\ !=\ (\textcolor{keywordtype}{int})\ ELFProgramType::Load)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Allocate\ space\ at\ the\ requested\ address}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}*\ address\ =\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a21c9b41d5a57a6a5c22a15e229fd8b7e}{MemoryManager::s\_current\_memory\_manager}}-\/>\mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_afa39a98646615a25a16aab6c62ada9fe}{vmm}}()-\/>\mbox{\hyperlink{classMaxOS_1_1memory_1_1VirtualMemoryManager_a433396979e1b088454eefbce0964b709}{allocate}}(program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a68ca654dfe15d423e868f94cde021d3a}{virtual\_address}},\ program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a315ed7fb656ce9a0519b13867a85fc8b}{memory\_size}},\ PRESENT\ |\ WRITE);}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00152}00152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8h_adf7b5d69e4c25995b3211b91b27f33b6}{ASSERT}}(address\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ memory\ for\ program\ header\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ the\ program\ into\ memory\ at\ that\ address}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00155}00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoryIO_8h_a5d860365491e432b125606a6f8e464bc}{memcpy}}(address,\ (\textcolor{keywordtype}{void}*)\ (m\_elf\_header\_address\ +\ program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_acc1f1b82c0707d64f7417ad0e8353938}{offset}}),\ program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a7bce212a3834bfea3abc677ac649f979}{file\_size}});}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Zero\ the\ rest\ of\ the\ memory\ if\ needed}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00158}00158\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ zero\_size\ =\ program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a315ed7fb656ce9a0519b13867a85fc8b}{memory\_size}}\ -\/\ program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a7bce212a3834bfea3abc677ac649f979}{file\_size}};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00159}00159\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoryIO_8h_af609697d85ef5a91e8be47ffa4c20f94}{memset}}((\textcolor{keywordtype}{void}*)\ ((uintptr\_t)\ address\ +\ program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a7bce212a3834bfea3abc677ac649f979}{file\_size}}),\ 0,\ zero\_size);}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00161}00161\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Once\ the\ memory\ has\ been\ copied\ can\ now\ mark\ the\ pages\ as\ read\ only\ etc}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ uint64\_t\ flags\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a5c2da5276cc5a051e3f4928eebc37b37}{to\_vmm\_flags}}(program\_header-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1ELFProgramHeader64_a92314885ca336cad124e757c8aecf156}{flags}});}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00163}00163\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_aac616421554f724ac8810d5bff76c3f1}{PhysicalMemoryManager::s\_current\_manager}}-\/>\mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_a9fa7588d0fb8aadb775d642d2a47b82d}{change\_page\_flags}}(address,\ flags,\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a21c9b41d5a57a6a5c22a15e229fd8b7e}{MemoryManager::s\_current\_memory\_manager}}-\/>vmm()-\/>pml4\_root\_address());}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00164}00164\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00165}00165\ \}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00173}\mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a5c2da5276cc5a051e3f4928eebc37b37}{00173}}\ uint64\_t\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1ELF64_a5c2da5276cc5a051e3f4928eebc37b37}{ELF64::to\_vmm\_flags}}(uint32\_t\ type)\ \{}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00175}00175\ \ \ \ \ \textcolor{comment}{//\ Conversion}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00176}00176\ \ \ \ \ \textcolor{comment}{//\ ELF\ \ \ |\ \ \ VMM}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00177}00177\ \ \ \ \ \textcolor{comment}{//\ 0x0\ \ \ |\ \ \ Executable}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00178}00178\ \ \ \ \ \textcolor{comment}{//\ 0x1\ \ \ |\ \ \ Write}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00179}00179\ \ \ \ \ \textcolor{comment}{//\ 0x2\ \ \ |\ \ \ Read}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00181}00181\ \ \ \ \ uint64\_t\ flags\ =\ \mbox{\hyperlink{physical_8h_ae0e83b5743a37b4d0d2a93bb3bbe84eba045db4a831b7d96a7ecff4007e6a9048}{PRESENT}}\ |\ \mbox{\hyperlink{physical_8h_ae0e83b5743a37b4d0d2a93bb3bbe84eba6c21f04b9fd8f97d73dbcedbd6380a22}{USER}}\ |\ \mbox{\hyperlink{physical_8h_ae0e83b5743a37b4d0d2a93bb3bbe84ebad32e5b4f2655fe653eb0f620de087fd5}{NO\_EXECUTE}};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00183}00183\ \ \ \ \ \textcolor{comment}{//\ Enable\ write}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00184}00184\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ \&\ ELFWrite)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00185}00185\ \ \ \ \ \ \ \ \ flags\ |=\ \mbox{\hyperlink{physical_8h_ae0e83b5743a37b4d0d2a93bb3bbe84eba285023a2e7a9895313648efac340db70}{WRITE}};}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00186}00186\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00187}00187\ \ \ \ \ \textcolor{comment}{//\ Disable\ no\ execute}}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00188}00188\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ \&\ ELFExecute)}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00189}00189\ \ \ \ \ \ \ \ \ flags\ \&=\ \string~NO\_EXECUTE;}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00191}00191\ \ \ \ \ \textcolor{keywordflow}{return}\ flags;}
\DoxyCodeLine{\Hypertarget{elf_8cpp_source_l00192}00192\ \}}

\end{DoxyCode}
