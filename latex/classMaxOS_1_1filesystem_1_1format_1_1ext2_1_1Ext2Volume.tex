\doxysection{Max\+OS\+::filesystem\+::format\+::ext2\+::Ext2\+Volume Class Reference}
\hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume}{}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume}\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}


Common operations for an ext2 volume that are used by both files \& directories (like block \& inode allocation)  




{\ttfamily \#include $<$ext2.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a4d627232293c978be4f587224170dc9b}{Ext2\+Volume}} (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk}{drivers\+::disk\+::\+Disk}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}, \mbox{\hyperlink{filesystem_8h_af466a9d32fd2bf17acb2efa91031ded0}{lba\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\+\_\+offset}})
\begin{DoxyCompactList}\small\item\em Construct a new Ext2 Volume object, reads the superblock and block group descriptors. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a767863d034839b5f77efbca2e6eb905d}{write\+\_\+block}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\+\_\+num}}, \mbox{\hyperlink{buffer_8h_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}buffer) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}}
\begin{DoxyCompactList}\small\item\em write a single block from a buffer into onto the disk \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acd1055b2e0fc33cfd7b3ded4dd20c432}{write\+\_\+inode}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\+\_\+num}}, \mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\+\_\+t}} \texorpdfstring{$\ast$}{*}inode) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}}
\begin{DoxyCompactList}\small\item\em write an inode to the filesystem \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a657c2f9cd60960648f1e1cec6d95a144}{create\+\_\+inode}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bool}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{is\+\_\+directory}})
\begin{DoxyCompactList}\small\item\em Allocates a new inode and sets the base metadata. Also allocates block 0 of the inode. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a4acd208a882871ef4ce89ab5e297e31c}{free\+\_\+inode}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} inode)
\begin{DoxyCompactList}\small\item\em Mark an inode as free. Note\+: does NOT unallocated the inodes blocks, use free\+\_\+group\+\_\+blocks(). \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\+\_\+block}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\+\_\+num}}, \mbox{\hyperlink{buffer_8h_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}buffer) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}}
\begin{DoxyCompactList}\small\item\em Reads a single block from the disk into a buffer. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a3ea16aa4dc886e18b353c1f4a3076100}{read\+\_\+inode}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\+\_\+num}}) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}}
\begin{DoxyCompactList}\small\item\em read an inode from the filesystem \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae2440f7c00021606ee91f68983abf206}{allocate\+\_\+block}} ()
\begin{DoxyCompactList}\small\item\em Allocates a single block to be used by an inode. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{common\+::\+Vector}}$<$ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} $>$ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acf68810ccb0f9cdb2b9491c077710205}{allocate\+\_\+blocks}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})
\begin{DoxyCompactList}\small\item\em Allocates a set of blocks to be used by an inode. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af9769f68d14aa0c2c44b9313c151eafc}{bytes\+\_\+to\+\_\+blocks}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes}}) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}}
\begin{DoxyCompactList}\small\item\em How many blocks are needed to contain a set amount of bytes. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_afee2108a1f09f919a3cafff60f3bc5dd}{free\+\_\+blocks}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{common\+::\+Vector}}$<$ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} $>$ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{blocks}})
\begin{DoxyCompactList}\small\item\em Frees a group of blocks. Preferably with adjacent blocks apearing next to each other but not enforced. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk}{drivers\+::disk\+::\+Disk}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}
\begin{DoxyCompactList}\small\item\em The disk that this volume is on. \end{DoxyCompactList}\item 
\mbox{\hyperlink{filesystem_8h_af466a9d32fd2bf17acb2efa91031ded0}{lba\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\+\_\+offset}}
\begin{DoxyCompactList}\small\item\em How far into the disk this partition starts. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ext2_8h_a15a4367643e7dc701198c82139f21ee1}{superblock\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}
\begin{DoxyCompactList}\small\item\em The superblock of the ext2 filesystem. \end{DoxyCompactList}\item 
\mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\+\_\+group\+\_\+descriptor\+\_\+t}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\+\_\+groups}}
\begin{DoxyCompactList}\small\item\em The block group descriptors. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\+\_\+size}}
\begin{DoxyCompactList}\small\item\em How large each block is (in bytes) \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a568c077e33ab4a474c65cfcaf934b215}{block\+\_\+group\+\_\+descriptor\+\_\+table\+\_\+block}}
\begin{DoxyCompactList}\small\item\em Where the block group descriptor table starts. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7e8c97da6e5a645d3c69ec277b9f9a2e}{block\+\_\+group\+\_\+descriptor\+\_\+table\+\_\+size}}
\begin{DoxyCompactList}\small\item\em How many block groups are in the block group descriptor table. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\+\_\+block\+\_\+groups}}
\begin{DoxyCompactList}\small\item\em How many block groups are in the filesystem. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a6a06e6d63e1762b1921e67931e6bd3c7}{pointers\+\_\+per\+\_\+block}}
\begin{DoxyCompactList}\small\item\em How many block pointers fit in a block. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_abc67bb9fb290354dca9c09c4ca5ff43d}{inodes\+\_\+per\+\_\+block}}
\begin{DoxyCompactList}\small\item\em How many inodes fit in a block. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\+\_\+per\+\_\+block}}
\begin{DoxyCompactList}\small\item\em How many sectors does a block take. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock}{common\+::\+Spinlock}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\+\_\+lock}}
\begin{DoxyCompactList}\small\item\em Lock for synchronised access to the volume (. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Common operations for an ext2 volume that are used by both files \& directories (like block \& inode allocation) 

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000014}{Todo}}]Free blocks \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{ext2_8h_source_l00322}{322}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a4d627232293c978be4f587224170dc9b}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a4d627232293c978be4f587224170dc9b} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!Ext2Volume@{Ext2Volume}}
\index{Ext2Volume@{Ext2Volume}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{Ext2Volume()}{Ext2Volume()}}
{\footnotesize\ttfamily Ext2\+Volume\+::\+Ext2\+Volume (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk}{drivers\+::disk\+::\+Disk}} \texorpdfstring{$\ast$}{*}}]{disk,  }\item[{\mbox{\hyperlink{filesystem_8h_af466a9d32fd2bf17acb2efa91031ded0}{lba\+\_\+t}}}]{partition\+\_\+offset }\end{DoxyParamCaption})}



Construct a new Ext2 Volume object, reads the superblock and block group descriptors. 


\begin{DoxyParams}{Parameters}
{\em disk} & The disk to read from \\
\hline
{\em partition\+\_\+offset} & The offset of the partition on the disk in sectors\\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000056}{Todo}}]Should lock per file and not expose volume lock \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00027}{27}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00028\ :\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}),}
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}),}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}(\{\})}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{comment}{//\ Read\ superblock}}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{superblock\_buffer}}(\&\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}},\ 1024);}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a9fa1c1952cece4f322ba0f2552f16c24}{read}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}\ +\ 2,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{superblock\_buffer}},\ 512);}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a9fa1c1952cece4f322ba0f2552f16c24}{read}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}\ +\ 3,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{superblock\_buffer}},\ 512);}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//\ Validate\ signature}}
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{logger_8h_adf7b5d69e4c25995b3211b91b27f33b6}{ASSERT}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.signature\ ==\ 0xEF53,\ \textcolor{stringliteral}{"{}Ext2\ Filesystem\ doesnt\ have\ a\ valid\ signature\(\backslash\)n"{}});}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ Version\ 0\ has\ constant\ inode\ info}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.version\_major\ <\ 1)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.first\_inode\ =\ 11;}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inode\_size\ =\ 128;}
\DoxyCodeLine{00045\ \ \ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ Parse\ the\ superblock}}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ =\ 1024\ <<\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.block\_size;}
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.total\_blocks\ +\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.blocks\_per\_group\ -\/\ 1)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.blocks\_per\_group;}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a568c077e33ab4a474c65cfcaf934b215}{block\_group\_descriptor\_table\_block}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.starting\_block\ +\ 1;}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7e8c97da6e5a645d3c69ec277b9f9a2e}{block\_group\_descriptor\_table\_size}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}});}
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a6a06e6d63e1762b1921e67931e6bd3c7}{pointers\_per\_block}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ /\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}});}
\DoxyCodeLine{00053\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_abc67bb9fb290354dca9c09c4ca5ff43d}{inodes\_per\_block}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inode\_size;}
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ /\ 512;}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ block\ groups}}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}}*\ [\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}}]\ \{\ \textcolor{keyword}{nullptr}\ \};}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bgdt\_lba}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a568c077e33ab4a474c65cfcaf934b215}{block\_group\_descriptor\_table\_block}}\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}};}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sectors\_to\_read}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7e8c97da6e5a645d3c69ec277b9f9a2e}{block\_group\_descriptor\_table\_size}}\ +\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ -\/\ 1)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}};}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_buffer}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sectors\_to\_read}}\ *\ 512);}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sectors\_to\_read}};\ ++i)}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a9fa1c1952cece4f322ba0f2552f16c24}{read}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bgdt\_lba}}\ +\ i,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_buffer}},\ 512);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ Store\ the\ block\ groups}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}};\ ++i)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[i]\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}};}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoryIO_8h_a5d860365491e432b125606a6f8e464bc}{memcpy}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[i],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_buffer}}.raw()\ +\ i\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}}),}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}}));}
\DoxyCodeLine{00069\ \ \ \ \ \}}
\DoxyCodeLine{00070\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae2440f7c00021606ee91f68983abf206}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae2440f7c00021606ee91f68983abf206} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!allocate\_block@{allocate\_block}}
\index{allocate\_block@{allocate\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{allocate\_block()}{allocate\_block()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} Ext2\+Volume\+::allocate\+\_\+block (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Allocates a single block to be used by an inode. 

\begin{DoxyReturn}{Returns}
The new block number or 0 if the allocation failed 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00177}{177}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acf68810ccb0f9cdb2b9491c077710205}{allocate\_blocks}}(1)[0];}
\DoxyCodeLine{00180\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8cpp_source_l00188}{allocate\+\_\+blocks()}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acf68810ccb0f9cdb2b9491c077710205}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acf68810ccb0f9cdb2b9491c077710205} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!allocate\_blocks@{allocate\_blocks}}
\index{allocate\_blocks@{allocate\_blocks}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{allocate\_blocks()}{allocate\_blocks()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} $>$ Ext2\+Volume\+::allocate\+\_\+blocks (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{amount }\end{DoxyParamCaption})}



Allocates a set of blocks to be used by an inode. 


\begin{DoxyParams}{Parameters}
{\em amount} & The amount of blocks to allocate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A list of the allocated blocks or \mbox{[}0\mbox{]} if the allocation failed 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00188}{188}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{comment}{//\ No\ blocks\ to\ allocate}}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\ 1,\ 0\ \};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ block\ group\ with\ enough\ free\ blocks}}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[0];}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ =\ 0;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}};\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[++\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}])}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>free\_blocks\ >=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ allocate\_group\_blocks(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}});}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ No\ block\ group\ can\ contain\ the\ block\ so\ split\ across\ multiple}}
\DoxyCodeLine{00201\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{Vector<uint32\_t>}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ \{\ \};}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ >\ 0)\ \{}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ the\ block\ group\ with\ most\ free\ blocks}}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[0];}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ =\ 0;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}};\ ++\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}})}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}]-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_afee2108a1f09f919a3cafff60f3bc5dd}{free\_blocks}}\ >\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>free\_blocks)}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}];}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ space}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>free\_blocks\ ==\ 0)}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{\ 1,\ 0\ \};}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Allocate\ the\ remaining\ blocks}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ allocated\ =\ allocate\_group\_blocks(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}},\ 1);}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/=\ allocated.size();}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ :\ allocated)}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}.push\_back(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}});}
\DoxyCodeLine{00220\ \ \ \ \ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}};}
\DoxyCodeLine{00223\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00340}{block\+\_\+groups}}, \mbox{\hyperlink{ext2_8cpp_source_l00464}{free\+\_\+blocks()}}, and \mbox{\hyperlink{ext2_8h_source_l00345}{total\+\_\+block\+\_\+groups}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00177}{allocate\+\_\+block()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00675}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::grow()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af9769f68d14aa0c2c44b9313c151eafc}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af9769f68d14aa0c2c44b9313c151eafc} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!bytes\_to\_blocks@{bytes\_to\_blocks}}
\index{bytes\_to\_blocks@{bytes\_to\_blocks}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{bytes\_to\_blocks()}{bytes\_to\_blocks()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} Ext2\+Volume\+::bytes\+\_\+to\+\_\+blocks (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}}}]{bytes }\end{DoxyParamCaption}) const}



How many blocks are needed to contain a set amount of bytes. 


\begin{DoxyParams}{Parameters}
{\em bytes} & Bytes needed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The blocks required 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00360}{360}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes}}\ +\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}}\ -\/\ 1)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00362\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00342}{block\+\_\+size}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00675}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::grow()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a657c2f9cd60960648f1e1cec6d95a144}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a657c2f9cd60960648f1e1cec6d95a144} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!create\_inode@{create\_inode}}
\index{create\_inode@{create\_inode}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{create\_inode()}{create\_inode()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} Ext2\+Volume\+::create\+\_\+inode (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bool}}}]{is\+\_\+directory }\end{DoxyParamCaption})}



Allocates a new inode and sets the base metadata. Also allocates block 0 of the inode. 


\begin{DoxyParams}{Parameters}
{\em is\+\_\+directory} & is the inode to be used for a directory \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The new inode 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00370}{370}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ block\ group\ with\ enough\ free\ inodes}}
\DoxyCodeLine{00375\ \ \ \ \ \mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[0];}
\DoxyCodeLine{00376\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ =\ 0;}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordflow}{for}(;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}{total\_block\_groups}};\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[++\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}])}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>free\_inodes\ >=\ 1)}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{comment}{//\ Read\ bitmap}}
\DoxyCodeLine{00382\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}});}
\DoxyCodeLine{00383\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>block\_inode\_bitmap,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}});}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{comment}{//\ First\ group\ contains\ reserved\ inodes}}
\DoxyCodeLine{00386\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ =\ 0;}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ ==\ 0\ \&\&\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.first\_inode\ >\ 1)}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.first\_inode\ -\/\ 1;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{comment}{//\ Find\ a\ free\ inode}}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{keywordflow}{for}(;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;\ ++\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}})\ \{}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Block\ is\ already\ used}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}}.raw()[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ /\ 8]\ \&\ (1u\ <<\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ \%\ 8)))\ !=\ 0)}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mark\ as\ used}}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>free\_inodes-\/-\/;}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.unallocated\_inodes-\/-\/;}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}}.raw()[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ /\ 8]\ |=\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}})\ (1u\ <<\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ \%\ 8));}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00403\ \ \ \ \ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{comment}{//\ Convert\ into\ the\ 1-\/based\ inode\ index\ in\ the\ group}}
\DoxyCodeLine{00406\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group\ +\ 1;}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ changed\ metadata}}
\DoxyCodeLine{00409\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a767863d034839b5f77efbca2e6eb905d}{write\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>block\_inode\_bitmap,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}});}
\DoxyCodeLine{00410\ \ \ \ \ write\_back\_block\_groups();}
\DoxyCodeLine{00411\ \ \ \ \ write\_back\_superblock();}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{comment}{//\ Create\ the\ inode}}
\DoxyCodeLine{00414\ \ \ \ \ \mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\_t}}\ inode\ \{\ \};}
\DoxyCodeLine{00415\ \ \ \ \ inode.creation\_time\ =\ time\_to\_epoch(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_af6e633c389f02276b3c76ee4ff2c65bb}{Clock::active\_clock}}()-\/>get\_time());}
\DoxyCodeLine{00416\ \ \ \ \ inode.last\_modification\_time\ =\ time\_to\_epoch(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_af6e633c389f02276b3c76ee4ff2c65bb}{Clock::active\_clock}}()-\/>get\_time());}
\DoxyCodeLine{00417\ \ \ \ \ inode.block\_pointers[0]\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae2440f7c00021606ee91f68983abf206}{allocate\_block}}();}
\DoxyCodeLine{00418\ \ \ \ \ inode.hard\_links\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{is\_directory}}\ ?\ 2\ :\ 1;}
\DoxyCodeLine{00419\ \ \ \ \ inode.type\ =\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}})\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{is\_directory}}\ ?\ InodeType::DIRECTORY\ :\ \mbox{\hyperlink{ext2_8h_a1cb56516e5efe8eb3332d6a1d64e007b}{InodeType}}::FILE)\ >>\ 12)\ \&\ 0xF;}
\DoxyCodeLine{00420\ \ \ \ \ inode.permissions\ =}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}})\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{is\_directory}}\ ?\ InodePermissionsDefaults::DIRECTORY\ :\ \mbox{\hyperlink{ext2_8h_a3e6abe2885e285bee96b1708ba14bac1}{InodePermissionsDefaults}}::FILE)\ \&\ 0x0FFF;}
\DoxyCodeLine{00422\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acd1055b2e0fc33cfd7b3ded4dd20c432}{write\_inode}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}},\ \&inode);}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}};}
\DoxyCodeLine{00426\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{clock_8cpp_source_l00208}{Max\+OS\+::drivers\+::clock\+::\+Clock\+::active\+\_\+clock()}}, \mbox{\hyperlink{ext2_8cpp_source_l00177}{allocate\+\_\+block()}}, \mbox{\hyperlink{ext2_8h_source_l00340}{block\+\_\+groups}}, \mbox{\hyperlink{ext2_8h_source_l00342}{block\+\_\+size}}, \mbox{\hyperlink{ext2_8h_source_l00350}{ext2\+\_\+lock}}, \mbox{\hyperlink{spinlock_8cpp_source_l00024}{Max\+OS\+::common\+::\+Spinlock\+::lock()}}, \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, \mbox{\hyperlink{ext2_8h_source_l00339}{superblock}}, \mbox{\hyperlink{ext2_8h_source_l00345}{total\+\_\+block\+\_\+groups}}, \mbox{\hyperlink{spinlock_8cpp_source_l00032}{Max\+OS\+::common\+::\+Spinlock\+::unlock()}}, \mbox{\hyperlink{ext2_8cpp_source_l00080}{write\+\_\+block()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00102}{write\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_afee2108a1f09f919a3cafff60f3bc5dd}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_afee2108a1f09f919a3cafff60f3bc5dd} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!free\_blocks@{free\_blocks}}
\index{free\_blocks@{free\_blocks}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{free\_blocks()}{free\_blocks()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+Volume\+::free\+\_\+blocks (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{common\+::\+Vector}}$<$ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} $>$ \&}]{blocks }\end{DoxyParamCaption})}



Frees a group of blocks. Preferably with adjacent blocks apearing next to each other but not enforced. 


\begin{DoxyParams}{Parameters}
{\em blocks} & The blocks to free \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00464}{464}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{comment}{//\ No\ blocks\ to\ free}}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{blocks}}.empty())}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{blocks}}[0];}
\DoxyCodeLine{00471\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{previous}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}};}
\DoxyCodeLine{00472\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ =\ 1;}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{comment}{//\ Free\ each\ adjacent\ set\ of\ blocks}}
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{blocks}})\ \{}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ is\ already\ accounted\ for}}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ ==\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}})}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Is\ this\ block\ adjacent}}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{previous}}\ +\ 1)\ ==\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}})\ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{previous}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}};}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ +=\ 1;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Adjacent\ set\ has\ ended}}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.starting\_block)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.blocks\_per\_group;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ free\_group\_blocks(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}});}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset}}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}};}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{previous}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}};}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ =\ 1;}
\DoxyCodeLine{00496\ \ \ \ \ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{comment}{//\ Account\ for\ the\ last\ set\ of\ blocks\ in\ the\ loop}}
\DoxyCodeLine{00499\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.starting\_block)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.blocks\_per\_group;}
\DoxyCodeLine{00500\ \ \ \ \ free\_group\_blocks(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{start}});}
\DoxyCodeLine{00501\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00339}{superblock}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00188}{allocate\+\_\+blocks()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00705}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::free()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a4acd208a882871ef4ce89ab5e297e31c}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a4acd208a882871ef4ce89ab5e297e31c} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!free\_inode@{free\_inode}}
\index{free\_inode@{free\_inode}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{free\_inode()}{free\_inode()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+Volume\+::free\+\_\+inode (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{inode }\end{DoxyParamCaption})}



Mark an inode as free. Note\+: does NOT unallocated the inodes blocks, use free\+\_\+group\+\_\+blocks(). 

\begin{DoxySeeAlso}{See also}
free\+\_\+group\+\_\+blocks
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em inode} & The inode number to mark as free \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00434}{434}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ block\ group\ containing\ the\ inode}}
\DoxyCodeLine{00437\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ =\ (inode\ -\/\ 1)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;}
\DoxyCodeLine{00438\ \ \ \ \ \mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\_group\_descriptor\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}];}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{comment}{//\ Read\ bitmap}}
\DoxyCodeLine{00441\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}});}
\DoxyCodeLine{00442\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>block\_inode\_bitmap,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}});}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{comment}{//\ First\ group\ contains\ reserved\ inodes}}
\DoxyCodeLine{00445\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ =\ (inode\ -\/\ 1)\ \%\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;}
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bg\_index}}\ ==\ 0\ \&\&\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ <\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.first\_inode\ -\/\ 1)))}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{comment}{//\ Mark\ as\ used}}
\DoxyCodeLine{00450\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>free\_inodes++;}
\DoxyCodeLine{00451\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.unallocated\_inodes++;}
\DoxyCodeLine{00452\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}}.raw()[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ /\ 8]\ \&=\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}})\ \string~(1u\ <<\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_index}}\ \%\ 8));}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ changed\ metadata}}
\DoxyCodeLine{00455\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a767863d034839b5f77efbca2e6eb905d}{write\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_group}}-\/>block\_inode\_bitmap,\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bitmap}});}
\DoxyCodeLine{00456\ \ \ \ \ write\_back\_block\_groups();}
\DoxyCodeLine{00457\ \ \ \ \ write\_back\_superblock();}
\DoxyCodeLine{00458\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00340}{block\+\_\+groups}}, \mbox{\hyperlink{ext2_8h_source_l00342}{block\+\_\+size}}, \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, \mbox{\hyperlink{ext2_8h_source_l00339}{superblock}}, and \mbox{\hyperlink{ext2_8cpp_source_l00080}{write\+\_\+block()}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00705}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::free()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!read\_block@{read\_block}}
\index{read\_block@{read\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{read\_block()}{read\_block()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+Volume\+::read\+\_\+block (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{block\+\_\+num,  }\item[{\mbox{\hyperlink{buffer_8h_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{buffer }\end{DoxyParamCaption}) const}



Reads a single block from the disk into a buffer. 


\begin{DoxyParams}{Parameters}
{\em block\+\_\+num} & The block to read \\
\hline
{\em buffer} & The buffer to read into \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00129}{129}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{comment}{//\ Ensure\ the\ buffer\ is\ in\ the\ right\ format}}
\DoxyCodeLine{00132\ \ \ \ \ buffer-\/>set\_offset(0);}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{comment}{//\ Read\ each\ sector\ of\ the\ block}}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}};\ ++i)}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a9fa1c1952cece4f322ba0f2552f16c24}{read}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_num}}\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}}\ +\ i,\ buffer,\ 512);}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{comment}{//\ Reset\ buffer}}
\DoxyCodeLine{00139\ \ \ \ \ buffer-\/>set\_offset(0);}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00336}{disk}}, \mbox{\hyperlink{ext2_8h_source_l00337}{partition\+\_\+offset}}, \mbox{\hyperlink{disk_8cpp_source_l00026}{Max\+OS\+::drivers\+::disk\+::\+Disk\+::read()}}, \mbox{\hyperlink{ext2_8h_source_l00348}{sectors\+\_\+per\+\_\+block}}, and \mbox{\hyperlink{buffer_8cpp_source_l00128}{Max\+OS\+::common\+::\+Buffer\+::set\+\_\+offset()}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00434}{free\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00795}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::read()}}, \mbox{\hyperlink{ext2_8cpp_source_l00959}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Directory\+::read\+\_\+from\+\_\+disk()}}, \mbox{\hyperlink{ext2_8cpp_source_l00149}{read\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00741}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::write()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00102}{write\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a3ea16aa4dc886e18b353c1f4a3076100}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a3ea16aa4dc886e18b353c1f4a3076100} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!read\_inode@{read\_inode}}
\index{read\_inode@{read\_inode}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{read\_inode()}{read\_inode()}}
{\footnotesize\ttfamily \mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\+\_\+t}} Ext2\+Volume\+::read\+\_\+inode (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{inode\+\_\+num }\end{DoxyParamCaption}) const}



read an inode from the filesystem 


\begin{DoxyParams}{Parameters}
{\em inode\+\_\+num} & The inode index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The inode read 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00149}{149}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\_t}}\ inode;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ Locate\ the\ inode}}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_num}}\ -\/\ 1)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ index\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_num}}\ -\/\ 1)\ \%\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{comment}{//\ Locate\ the\ block}}
\DoxyCodeLine{00158\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_table}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}}]-\/>inode\_table\_address;}
\DoxyCodeLine{00159\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ offset\ =\ index\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inode\_size;}
\DoxyCodeLine{00160\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ =\ offset\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00161\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{in\_block\_offset}}\ =\ offset\ \%\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ block}}
\DoxyCodeLine{00164\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ buffer(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}});}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_table}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}},\ \&buffer);}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ inode\ from\ the\ block}}
\DoxyCodeLine{00168\ \ \ \ \ buffer.copy\_to(\&inode,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\_t}}),\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{in\_block\_offset}});}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordflow}{return}\ inode;}
\DoxyCodeLine{00170\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00340}{block\+\_\+groups}}, \mbox{\hyperlink{ext2_8h_source_l00342}{block\+\_\+size}}, \mbox{\hyperlink{buffer_8cpp_source_l00282}{Max\+OS\+::common\+::\+Buffer\+::copy\+\_\+to()}}, \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, and \mbox{\hyperlink{ext2_8h_source_l00339}{superblock}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a767863d034839b5f77efbca2e6eb905d}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a767863d034839b5f77efbca2e6eb905d} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!write\_block@{write\_block}}
\index{write\_block@{write\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{write\_block()}{write\_block()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+Volume\+::write\+\_\+block (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{block\+\_\+num,  }\item[{\mbox{\hyperlink{buffer_8h_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{buffer }\end{DoxyParamCaption}) const}



write a single block from a buffer into onto the disk 


\begin{DoxyParams}{Parameters}
{\em block\+\_\+num} & The block to update \\
\hline
{\em buffer} & The buffer to read from \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00080}{80}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{comment}{//\ Ensure\ the\ buffer\ is\ in\ the\ right\ format}}
\DoxyCodeLine{00083\ \ \ \ \ buffer-\/>set\_offset(0);}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{old}}\ =\ buffer-\/>update\_offset;}
\DoxyCodeLine{00085\ \ \ \ \ buffer-\/>update\_offset\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//\ Read\ each\ sector\ of\ the\ block}}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}};\ ++i)}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a849c586fbc52b1994c282492addc4772}{write}}(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}{partition\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_num}}\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}{sectors\_per\_block}}\ +\ i,\ buffer,\ 512);}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//\ Reset\ buffer}}
\DoxyCodeLine{00092\ \ \ \ \ buffer-\/>set\_offset(0);}
\DoxyCodeLine{00093\ \ \ \ \ buffer-\/>update\_offset\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{old}};}
\DoxyCodeLine{00094\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00336}{disk}}, \mbox{\hyperlink{ext2_8h_source_l00337}{partition\+\_\+offset}}, \mbox{\hyperlink{ext2_8h_source_l00348}{sectors\+\_\+per\+\_\+block}}, \mbox{\hyperlink{buffer_8cpp_source_l00128}{Max\+OS\+::common\+::\+Buffer\+::set\+\_\+offset()}}, \mbox{\hyperlink{buffer_8h_source_l00044}{Max\+OS\+::common\+::\+Buffer\+::update\+\_\+offset}}, and \mbox{\hyperlink{disk_8cpp_source_l00050}{Max\+OS\+::drivers\+::disk\+::\+Disk\+::write()}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00434}{free\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00741}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::write()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00102}{write\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acd1055b2e0fc33cfd7b3ded4dd20c432}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_acd1055b2e0fc33cfd7b3ded4dd20c432} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!write\_inode@{write\_inode}}
\index{write\_inode@{write\_inode}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{write\_inode()}{write\_inode()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+Volume\+::write\+\_\+inode (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{inode\+\_\+num,  }\item[{\mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{inode }\end{DoxyParamCaption}) const}



write an inode to the filesystem 


\begin{DoxyParams}{Parameters}
{\em inode\+\_\+num} & The inode index \\
\hline
{\em inode} & The inode to read from \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00102}{102}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ Locate\ the\ inode}}
\DoxyCodeLine{00105\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_num}}\ -\/\ 1)\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;}
\DoxyCodeLine{00106\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ index\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_num}}\ -\/\ 1)\ \%\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inodes\_per\_group;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//\ Locate\ the\ block}}
\DoxyCodeLine{00109\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_table}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}{block\_groups}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{group}}]-\/>inode\_table\_address;}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ offset\ =\ index\ *\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}{superblock}}.inode\_size;}
\DoxyCodeLine{00111\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ =\ offset\ /\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{in\_block\_offset}}\ =\ offset\ \%\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ inode}}
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ buffer(\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}});}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_table}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}},\ \&buffer);}
\DoxyCodeLine{00117\ \ \ \ \ buffer.copy\_from(inode,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{ext2_8h_adecfa9c752ab7847b442910a50c2fd66}{inode\_t}}),\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{in\_block\_offset}});}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{comment}{//\ Modify\ the\ block}}
\DoxyCodeLine{00120\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a767863d034839b5f77efbca2e6eb905d}{write\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{inode\_table}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}},\ \&buffer);}
\DoxyCodeLine{00121\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00340}{block\+\_\+groups}}, \mbox{\hyperlink{ext2_8h_source_l00342}{block\+\_\+size}}, \mbox{\hyperlink{buffer_8cpp_source_l00195}{Max\+OS\+::common\+::\+Buffer\+::copy\+\_\+from()}}, \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, \mbox{\hyperlink{ext2_8h_source_l00339}{superblock}}, and \mbox{\hyperlink{ext2_8cpp_source_l00080}{write\+\_\+block()}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00697}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::save()}}.



\doxysubsection{Member Data Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a568c077e33ab4a474c65cfcaf934b215}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a568c077e33ab4a474c65cfcaf934b215} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!block\_group\_descriptor\_table\_block@{block\_group\_descriptor\_table\_block}}
\index{block\_group\_descriptor\_table\_block@{block\_group\_descriptor\_table\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{block\_group\_descriptor\_table\_block}{block\_group\_descriptor\_table\_block}}
{\footnotesize\ttfamily uint32\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::block\+\_\+group\+\_\+descriptor\+\_\+table\+\_\+block}



Where the block group descriptor table starts. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00343}{343}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7e8c97da6e5a645d3c69ec277b9f9a2e}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7e8c97da6e5a645d3c69ec277b9f9a2e} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!block\_group\_descriptor\_table\_size@{block\_group\_descriptor\_table\_size}}
\index{block\_group\_descriptor\_table\_size@{block\_group\_descriptor\_table\_size}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{block\_group\_descriptor\_table\_size}{block\_group\_descriptor\_table\_size}}
{\footnotesize\ttfamily uint32\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::block\+\_\+group\+\_\+descriptor\+\_\+table\+\_\+size}



How many block groups are in the block group descriptor table. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00344}{344}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a28e53f409de30340066785e5a0d94993} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!block\_groups@{block\_groups}}
\index{block\_groups@{block\_groups}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{block\_groups}{block\_groups}}
{\footnotesize\ttfamily \mbox{\hyperlink{ext2_8h_ab9db2de98fbe3eebbd1add91524aa7a1}{block\+\_\+group\+\_\+descriptor\+\_\+t}}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::block\+\_\+groups}



The block group descriptors. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00340}{340}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00188}{allocate\+\_\+blocks()}}, \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00434}{free\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00149}{read\+\_\+inode()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00102}{write\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!block\_size@{block\_size}}
\index{block\_size@{block\_size}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{block\_size}{block\_size}}
{\footnotesize\ttfamily size\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::block\+\_\+size}



How large each block is (in bytes) 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00342}{342}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00360}{bytes\+\_\+to\+\_\+blocks()}}, \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00434}{free\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00509}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::\+Inode\+Handler()}}, \mbox{\hyperlink{ext2_8cpp_source_l00795}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::read()}}, \mbox{\hyperlink{ext2_8cpp_source_l00959}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Directory\+::read\+\_\+from\+\_\+disk()}}, \mbox{\hyperlink{ext2_8cpp_source_l00149}{read\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00741}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::write()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00102}{write\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_af92c050fd33ce1edb06897b9c5fe0862} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!disk@{disk}}
\index{disk@{disk}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{disk}{disk}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk}{drivers\+::disk\+::\+Disk}}\texorpdfstring{$\ast$}{*} Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::disk}



The disk that this volume is on. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00336}{336}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00080}{write\+\_\+block()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!ext2\_lock@{ext2\_lock}}
\index{ext2\_lock@{ext2\_lock}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{ext2\_lock}{ext2\_lock}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock}{common\+::\+Spinlock}} Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::ext2\+\_\+lock}



Lock for synchronised access to the volume (. 

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000015}{Todo}}]\+: remove public?) \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{ext2_8h_source_l00350}{350}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00705}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::free()}}, \mbox{\hyperlink{ext2_8cpp_source_l00795}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::read()}}, \mbox{\hyperlink{ext2_8cpp_source_l00959}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Directory\+::read\+\_\+from\+\_\+disk()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00741}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+File\+::write()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_abc67bb9fb290354dca9c09c4ca5ff43d}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_abc67bb9fb290354dca9c09c4ca5ff43d} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!inodes\_per\_block@{inodes\_per\_block}}
\index{inodes\_per\_block@{inodes\_per\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{inodes\_per\_block}{inodes\_per\_block}}
{\footnotesize\ttfamily uint32\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::inodes\+\_\+per\+\_\+block}



How many inodes fit in a block. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00347}{347}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a7436ecf891301b9a4c9edb52212151db} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!partition\_offset@{partition\_offset}}
\index{partition\_offset@{partition\_offset}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{partition\_offset}{partition\_offset}}
{\footnotesize\ttfamily \mbox{\hyperlink{filesystem_8h_af466a9d32fd2bf17acb2efa91031ded0}{lba\+\_\+t}} Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::partition\+\_\+offset}



How far into the disk this partition starts. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00337}{337}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00080}{write\+\_\+block()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a6a06e6d63e1762b1921e67931e6bd3c7}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a6a06e6d63e1762b1921e67931e6bd3c7} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!pointers\_per\_block@{pointers\_per\_block}}
\index{pointers\_per\_block@{pointers\_per\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{pointers\_per\_block}{pointers\_per\_block}}
{\footnotesize\ttfamily size\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::pointers\+\_\+per\+\_\+block}



How many block pointers fit in a block. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00346}{346}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aa2fb31420bd869e0f42e672e6ede97b2} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!sectors\_per\_block@{sectors\_per\_block}}
\index{sectors\_per\_block@{sectors\_per\_block}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{sectors\_per\_block}{sectors\_per\_block}}
{\footnotesize\ttfamily uint32\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::sectors\+\_\+per\+\_\+block}



How many sectors does a block take. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00348}{348}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00129}{read\+\_\+block()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00080}{write\+\_\+block()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a95e333eca8856f08ba4bc1724541a4b7} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!superblock@{superblock}}
\index{superblock@{superblock}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{superblock}{superblock}}
{\footnotesize\ttfamily \mbox{\hyperlink{ext2_8h_a15a4367643e7dc701198c82139f21ee1}{superblock\+\_\+t}} Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::superblock}



The superblock of the ext2 filesystem. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00339}{339}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00464}{free\+\_\+blocks()}}, \mbox{\hyperlink{ext2_8cpp_source_l00434}{free\+\_\+inode()}}, \mbox{\hyperlink{ext2_8cpp_source_l00149}{read\+\_\+inode()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00102}{write\+\_\+inode()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ac5a90acfd7dd067a9fa54e4a1ea0e707} 
\index{MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}!total\_block\_groups@{total\_block\_groups}}
\index{total\_block\_groups@{total\_block\_groups}!MaxOS::filesystem::format::ext2::Ext2Volume@{MaxOS::filesystem::format::ext2::Ext2Volume}}
\doxysubsubsection{\texorpdfstring{total\_block\_groups}{total\_block\_groups}}
{\footnotesize\ttfamily uint32\+\_\+t Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::total\+\_\+block\+\_\+groups}



How many block groups are in the filesystem. 



Definition at line \mbox{\hyperlink{ext2_8h_source_l00345}{345}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00188}{allocate\+\_\+blocks()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00370}{create\+\_\+inode()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/filesystem/format/\mbox{\hyperlink{ext2_8h}{ext2.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/filesystem/format/\mbox{\hyperlink{ext2_8cpp}{ext2.\+cpp}}\end{DoxyCompactItemize}
