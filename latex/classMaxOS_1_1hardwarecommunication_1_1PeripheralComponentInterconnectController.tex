\hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}{}\doxysection{Max\+OS\+::hardwarecommunication\+::Peripheral\+Component\+Interconnect\+Controller Class Reference}
\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}


Handles the selecting and loading of drivers for P\+CI devices.  




{\ttfamily \#include $<$pci.\+h$>$}

Inheritance diagram for Max\+OS\+::hardwarecommunication\+::Peripheral\+Component\+Interconnect\+Controller\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a102d940e032d2179707036931a3ec00d}{Peripheral\+Component\+Interconnect\+Controller}} ()
\begin{DoxyCompactList}\small\item\em \+\_\+\+\_\+\+C\+O\+N\+T\+R\+O\+L\+L\+E\+R\+\_\+\+\_\+\+\_\+ \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}{$\sim$\+Peripheral\+Component\+Interconnect\+Controller}} ()
\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad7dc1c715ecfdc809893ce363a688ce3}{select\+\_\+drivers}} (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelectorEventHandler}{drivers\+::\+Driver\+Selector\+Event\+Handler}} $\ast$handler, \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$interrupt\+\_\+manager) override
\begin{DoxyCompactList}\small\item\em Select the driver for the device. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{drivers\+::\+Driver}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}{get\+\_\+driver}} (\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}} dev, \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{Interrupt\+Manager}} $\ast$interrupt\+\_\+manager)
\begin{DoxyCompactList}\small\item\em Get the driver for the device. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}{list\+\_\+known\+\_\+deivce}} (\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}} dev)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles the selecting and loading of drivers for P\+CI devices. 

Definition at line 77 of file pci.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a102d940e032d2179707036931a3ec00d}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a102d940e032d2179707036931a3ec00d}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!PeripheralComponentInterconnectController@{PeripheralComponentInterconnectController}}
\index{PeripheralComponentInterconnectController@{PeripheralComponentInterconnectController}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{PeripheralComponentInterconnectController()}{PeripheralComponentInterconnectController()}}
{\footnotesize\ttfamily Peripheral\+Component\+Interconnect\+Controller\+::\+Peripheral\+Component\+Interconnect\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



\+\_\+\+\_\+\+C\+O\+N\+T\+R\+O\+L\+L\+E\+R\+\_\+\+\_\+\+\_\+ 



Definition at line 81 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{82 : m\_data\_port(0xCFC),}
\DoxyCodeLine{83   m\_command\_port(0xCF8)}
\DoxyCodeLine{84 \{}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!````~PeripheralComponentInterconnectController@{$\sim$PeripheralComponentInterconnectController}}
\index{````~PeripheralComponentInterconnectController@{$\sim$PeripheralComponentInterconnectController}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{$\sim$PeripheralComponentInterconnectController()}{~PeripheralComponentInterconnectController()}}
{\footnotesize\ttfamily Peripheral\+Component\+Interconnect\+Controller\+::$\sim$\+Peripheral\+Component\+Interconnect\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 88 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{88                                                                                       \{}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!get\_driver@{get\_driver}}
\index{get\_driver@{get\_driver}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{get\_driver()}{get\_driver()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}} $\ast$ Peripheral\+Component\+Interconnect\+Controller\+::get\+\_\+driver (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}}}]{dev,  }\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager }\end{DoxyParamCaption})}



Get the driver for the device. 


\begin{DoxyParams}{Parameters}
{\em dev} & Device descriptor \\
\hline
{\em interrupt\+\_\+manager} & Interrupt manager \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Driver for the device, 0 if there is no driver 
\end{DoxyReturn}


Definition at line 235 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{235                                                                                                                                                      \{}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{comment}{// Dont use new here, manually allocate memory instead}}
\DoxyCodeLine{238 }
\DoxyCodeLine{239     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}}* driver = 0;}
\DoxyCodeLine{240     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}})}
\DoxyCodeLine{241     \{}
\DoxyCodeLine{242         \textcolor{keywordflow}{case} 0x1022:    \textcolor{comment}{//AMD}}
\DoxyCodeLine{243         \{}
\DoxyCodeLine{244             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{245             \{}
\DoxyCodeLine{246                 \textcolor{keywordflow}{case} 0x2000:    \textcolor{comment}{//am79c971}}
\DoxyCodeLine{247                 \{}
\DoxyCodeLine{248                     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}* result = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}*)MemoryManager::s\_active\_memory\_manager -\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}));}
\DoxyCodeLine{249                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}(\&dev, interrupt\_manager);}
\DoxyCodeLine{250                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{251 }
\DoxyCodeLine{252                 \}}
\DoxyCodeLine{253                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{254                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{255             \}}
\DoxyCodeLine{256             \textcolor{keywordflow}{break};}
\DoxyCodeLine{257         \}}
\DoxyCodeLine{258         \textcolor{keywordflow}{case} 0x8086:  \textcolor{comment}{//Intel}}
\DoxyCodeLine{259         \{}
\DoxyCodeLine{260             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{261             \{}
\DoxyCodeLine{262                 \textcolor{keywordflow}{case} 0x100E: \textcolor{comment}{//i217 (Ethernet Controller)}}
\DoxyCodeLine{263                 \{}
\DoxyCodeLine{264                     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}* result = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}*)MemoryManager::s\_active\_memory\_manager-\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}));}
\DoxyCodeLine{265                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}(\&dev, interrupt\_manager);}
\DoxyCodeLine{266                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{267                 \}}
\DoxyCodeLine{268                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{269                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{270             \}}
\DoxyCodeLine{271             \textcolor{keywordflow}{break};}
\DoxyCodeLine{272         \}\textcolor{comment}{//End Intel}}
\DoxyCodeLine{273     \}}
\DoxyCodeLine{274 }
\DoxyCodeLine{275     \textcolor{comment}{//If there is no driver for the particular device, go into generic devices}}
\DoxyCodeLine{276     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a22f5e9804805ec403208f97eb38502d5}{class\_id}})}
\DoxyCodeLine{277     \{}
\DoxyCodeLine{278         \textcolor{keywordflow}{case} 0x03: \textcolor{comment}{//Graphics}}
\DoxyCodeLine{279         \{}
\DoxyCodeLine{280 }
\DoxyCodeLine{281             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a49ec8dcf7819b4aa51acecc78f231a99}{subclass\_id}})}
\DoxyCodeLine{282             \{}
\DoxyCodeLine{283                 \textcolor{keywordflow}{case} 0x00:  \textcolor{comment}{//VGA}}
\DoxyCodeLine{284                 \{}
\DoxyCodeLine{285                     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}* result = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}*)MemoryManager::s\_active\_memory\_manager-\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}));}
\DoxyCodeLine{286                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}();}
\DoxyCodeLine{287                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{288                 \}}
\DoxyCodeLine{289             \}}
\DoxyCodeLine{290             \textcolor{keywordflow}{break};}
\DoxyCodeLine{291         \}}
\DoxyCodeLine{292     \}}
\DoxyCodeLine{293 }
\DoxyCodeLine{294     \textcolor{keywordflow}{return} driver;}
\DoxyCodeLine{295 \}}

\end{DoxyCode}


References Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::class\+\_\+id, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::device\+\_\+id, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::subclass\+\_\+id, and Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id.



Referenced by select\+\_\+drivers().

\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!list\_known\_deivce@{list\_known\_deivce}}
\index{list\_known\_deivce@{list\_known\_deivce}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{list\_known\_deivce()}{list\_known\_deivce()}}
{\footnotesize\ttfamily void Peripheral\+Component\+Interconnect\+Controller\+::list\+\_\+known\+\_\+deivce (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}}}]{dev }\end{DoxyParamCaption})}



Definition at line 298 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{298                                                                                                                      \{}
\DoxyCodeLine{299     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}})}
\DoxyCodeLine{300     \{}
\DoxyCodeLine{301         \textcolor{keywordflow}{case} 0x1022:}
\DoxyCodeLine{302         \{}
\DoxyCodeLine{303             \textcolor{comment}{// The vendor is AMD}}
\DoxyCodeLine{304             \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hAMD "});}
\DoxyCodeLine{305 }
\DoxyCodeLine{306             \textcolor{comment}{// List the device}}
\DoxyCodeLine{307             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{308             \{}
\DoxyCodeLine{309                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{310                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)h0x\%x"}, dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{311                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{312             \}}
\DoxyCodeLine{313             \textcolor{keywordflow}{break};}
\DoxyCodeLine{314         \}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316         \textcolor{keywordflow}{case} 0x106B:}
\DoxyCodeLine{317         \{}
\DoxyCodeLine{318             \textcolor{comment}{// The vendor is Apple}}
\DoxyCodeLine{319             \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hApple "});}
\DoxyCodeLine{320 }
\DoxyCodeLine{321             \textcolor{comment}{// List the device}}
\DoxyCodeLine{322             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{323             \{}
\DoxyCodeLine{324                 \textcolor{keywordflow}{case} 0x003F:}
\DoxyCodeLine{325                 \{}
\DoxyCodeLine{326                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hKeyLargo/Intrepid USB"});}
\DoxyCodeLine{327                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{328                 \}}
\DoxyCodeLine{329 }
\DoxyCodeLine{330                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{331                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)h0x\%x"}, dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{332                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{333             \}}
\DoxyCodeLine{334             \textcolor{keywordflow}{break};}
\DoxyCodeLine{335         \}}
\DoxyCodeLine{336 }
\DoxyCodeLine{337         \textcolor{keywordflow}{case} 1234:}
\DoxyCodeLine{338         \{}
\DoxyCodeLine{339             \textcolor{comment}{// The vendor is QEMU}}
\DoxyCodeLine{340           \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hQEMU "});}
\DoxyCodeLine{341 }
\DoxyCodeLine{342             \textcolor{comment}{// List the device}}
\DoxyCodeLine{343             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{344             \{}
\DoxyCodeLine{345 }
\DoxyCodeLine{346                 \textcolor{keywordflow}{case} 0x1111:}
\DoxyCodeLine{347                 \{}
\DoxyCodeLine{348                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hVirtual Video Controller"});}
\DoxyCodeLine{349                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{350                 \}}
\DoxyCodeLine{351             \}}
\DoxyCodeLine{352             \textcolor{keywordflow}{break};}
\DoxyCodeLine{353         \}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355         \textcolor{keywordflow}{case} 0x8086:}
\DoxyCodeLine{356         \{}
\DoxyCodeLine{357             \textcolor{comment}{// The vendor is Intel}}
\DoxyCodeLine{358             \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hIntel "});}
\DoxyCodeLine{359 }
\DoxyCodeLine{360             \textcolor{comment}{// List the device}}
\DoxyCodeLine{361             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{362             \{}
\DoxyCodeLine{363 }
\DoxyCodeLine{364                 \textcolor{keywordflow}{case} 0x1237:}
\DoxyCodeLine{365                 \{}
\DoxyCodeLine{366                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)h440FX"});}
\DoxyCodeLine{367                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{368                 \}}
\DoxyCodeLine{369 }
\DoxyCodeLine{370                 \textcolor{keywordflow}{case} 0x2415:}
\DoxyCodeLine{371                 \{}
\DoxyCodeLine{372                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hAC'97"});}
\DoxyCodeLine{373                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{374                 \}}
\DoxyCodeLine{375 }
\DoxyCodeLine{376                 \textcolor{keywordflow}{case} 0x7000:}
\DoxyCodeLine{377                 \{}
\DoxyCodeLine{378                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hPIIX3"});}
\DoxyCodeLine{379                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{380 }
\DoxyCodeLine{381                 \}}
\DoxyCodeLine{382 }
\DoxyCodeLine{383                 \textcolor{keywordflow}{case} 0x7010:}
\DoxyCodeLine{384                 \{}
\DoxyCodeLine{385                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hPIIX4"});}
\DoxyCodeLine{386                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{387 }
\DoxyCodeLine{388                 \}}
\DoxyCodeLine{389 }
\DoxyCodeLine{390                 \textcolor{keywordflow}{case} 0x7111:}
\DoxyCodeLine{391                 \{}
\DoxyCodeLine{392                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hPIIX3 ACPI"});}
\DoxyCodeLine{393                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{394                 \}}
\DoxyCodeLine{395 }
\DoxyCodeLine{396                 \textcolor{keywordflow}{case} 0x7113:}
\DoxyCodeLine{397                 \{}
\DoxyCodeLine{398                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hPIIX4 ACPI"});}
\DoxyCodeLine{399                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{400                 \}}
\DoxyCodeLine{401 }
\DoxyCodeLine{402                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{403                     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)h0x\%x"}, dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{404                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{405 }
\DoxyCodeLine{406             \}}
\DoxyCodeLine{407             \textcolor{keywordflow}{break};}
\DoxyCodeLine{408         \}}
\DoxyCodeLine{409 }
\DoxyCodeLine{410         \textcolor{keywordflow}{case} 0x80EE: \{}
\DoxyCodeLine{411 }
\DoxyCodeLine{412             \textcolor{comment}{// The vendor is VirtualBox}}
\DoxyCodeLine{413             \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hVirtualBox "});}
\DoxyCodeLine{414 }
\DoxyCodeLine{415             \textcolor{comment}{// List the device}}
\DoxyCodeLine{416             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}}) \{}
\DoxyCodeLine{417 }
\DoxyCodeLine{418                 \textcolor{keywordflow}{case} 0xBEEF: \{}
\DoxyCodeLine{419                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hGraphics Adapter"});}
\DoxyCodeLine{420                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{421                 \}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423                 \textcolor{keywordflow}{case} 0xCAFE: \{}
\DoxyCodeLine{424                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hGuest Service"});}
\DoxyCodeLine{425                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{426                 \}}
\DoxyCodeLine{427             \}}
\DoxyCodeLine{428             \textcolor{keywordflow}{break};}
\DoxyCodeLine{429         \}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431         \textcolor{keywordflow}{default}:    \textcolor{comment}{// Unknown}}
\DoxyCodeLine{432           \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)hUnknown (0x\%x:0x\%x)"}, dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}}, dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{433           \textcolor{keywordflow}{break};}
\DoxyCodeLine{434 }
\DoxyCodeLine{435     \}}
\DoxyCodeLine{436 \}}

\end{DoxyCode}


References \+\_\+kprintf, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::device\+\_\+id, and Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id.



Referenced by select\+\_\+drivers().

\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad7dc1c715ecfdc809893ce363a688ce3}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad7dc1c715ecfdc809893ce363a688ce3}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!select\_drivers@{select\_drivers}}
\index{select\_drivers@{select\_drivers}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{select\_drivers()}{select\_drivers()}}
{\footnotesize\ttfamily void Peripheral\+Component\+Interconnect\+Controller\+::select\+\_\+drivers (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelectorEventHandler}{drivers\+::\+Driver\+Selector\+Event\+Handler}} $\ast$}]{handler,  }\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Select the driver for the device. 


\begin{DoxyParams}{Parameters}
{\em driver\+Manager} & device driver manager \\
\hline
{\em interrupt\+\_\+manager} & Interrupt manager \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Driver for the device 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelector_a58b9eb7f96d223fde9417d4682fa12c1}{Max\+O\+S\+::drivers\+::\+Driver\+Selector}}.



Definition at line 159 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{160 \{}
\DoxyCodeLine{161     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{apic_8h_a5262d4a80e6a0b6dce6fd57d4656786d}{bus}} = 0; \mbox{\hyperlink{apic_8h_a5262d4a80e6a0b6dce6fd57d4656786d}{bus}} < 8; ++\mbox{\hyperlink{apic_8h_a5262d4a80e6a0b6dce6fd57d4656786d}{bus}}) \{}
\DoxyCodeLine{162         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} device = 0; device < 32; ++device) \{}
\DoxyCodeLine{163 }
\DoxyCodeLine{164             \textcolor{keywordtype}{int} numFunctions = (device\_has\_functions(\mbox{\hyperlink{apic_8h_a5262d4a80e6a0b6dce6fd57d4656786d}{bus}}, device)) ? 8 : 1;}
\DoxyCodeLine{165 }
\DoxyCodeLine{166             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \textcolor{keyword}{function} = 0; \textcolor{keyword}{function} < numFunctions; ++\textcolor{keyword}{function}) \{}
\DoxyCodeLine{167 }
\DoxyCodeLine{168                 \textcolor{comment}{// Get the device descriptor, if the vendor id is 0x0000 or 0xFFFF, the device is not present/ready}}
\DoxyCodeLine{169                 \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{PeripheralComponentInterconnectDeviceDescriptor}} deviceDescriptor = get\_device\_descriptor(\mbox{\hyperlink{apic_8h_a5262d4a80e6a0b6dce6fd57d4656786d}{bus}}, device, \textcolor{keyword}{function});}
\DoxyCodeLine{170                 \textcolor{keywordflow}{if}(deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}} == 0x0000 || deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}} == 0x0001 || deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}} == 0xFFFF)}
\DoxyCodeLine{171                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 }
\DoxyCodeLine{174                 \textcolor{comment}{// Get port number}}
\DoxyCodeLine{175                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} barNum = 5; barNum >= 0; barNum-\/-\/)\{}
\DoxyCodeLine{176                     \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister}{BaseAddressRegister}} bar = get\_base\_address\_register(\mbox{\hyperlink{apic_8h_a5262d4a80e6a0b6dce6fd57d4656786d}{bus}}, device, \textcolor{keyword}{function}, barNum);}
\DoxyCodeLine{177                     \textcolor{keywordflow}{if}(bar.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a7ef7f325d5cb5dc23f44fde767e5db24}{address}} \&\& (bar.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_aa170a347420c72b96c5f94904fdc513d}{type}} == \mbox{\hyperlink{namespaceMaxOS_1_1hardwarecommunication_afc5ea080a9107e056194cc643a761608a082719ea5b78564a46291526ff4f3b2c}{InputOutput}}))}
\DoxyCodeLine{178                         deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_af9db8d9903071f7cf8611efa3c7a1333}{port\_base}} = (uint32\_t)bar.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a7ef7f325d5cb5dc23f44fde767e5db24}{address}};}
\DoxyCodeLine{179                 \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181                 \textcolor{comment}{// write to the debug stream}}
\DoxyCodeLine{182                 \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"DEVICE FOUND: \%s -\/ "}, deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_ab2ce5626480b7a91ebe27ea3f2d31229}{get\_type}}().\mbox{\hyperlink{classMaxOS_1_1String_a2af521b9de69dcbe3f1125390fbb3b5a}{c\_str}}());}
\DoxyCodeLine{183 }
\DoxyCodeLine{184                 \textcolor{comment}{// Select the driver and print information about the device}}
\DoxyCodeLine{185                 \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}}* driver = \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}{get\_driver}}(deviceDescriptor, interrupt\_manager);}
\DoxyCodeLine{186                 \textcolor{keywordflow}{if}(driver != \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{187                   handler-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelectorEventHandler_ad25298d6b14e6f790715563932cca77e}{on\_driver\_selected}}(driver);}
\DoxyCodeLine{188                   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)h \%s \%s"}, driver-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a7ad761c929a49cfebd8c443f5af788f6}{get\_vendor\_name}}().\mbox{\hyperlink{classMaxOS_1_1String_a2af521b9de69dcbe3f1125390fbb3b5a}{c\_str}}(), driver-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a65b06f2917f7a781e68f3748e81806b6}{get\_device\_name}}().\mbox{\hyperlink{classMaxOS_1_1String_a2af521b9de69dcbe3f1125390fbb3b5a}{c\_str}}());}
\DoxyCodeLine{189                 \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{190                   \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}{list\_known\_deivce}}(deviceDescriptor);}
\DoxyCodeLine{191                 \}}
\DoxyCodeLine{192 }
\DoxyCodeLine{193                 \textcolor{comment}{// New line}}
\DoxyCodeLine{194                 \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\(\backslash\)h\(\backslash\)n"});}
\DoxyCodeLine{195             \}}
\DoxyCodeLine{196         \}}
\DoxyCodeLine{197     \}}
\DoxyCodeLine{198 \}}

\end{DoxyCode}


References \+\_\+kprintf, Max\+O\+S\+::hardwarecommunication\+::\+Base\+Address\+Register\+::address, bus, Max\+O\+S\+::\+String\+::c\+\_\+str(), Max\+O\+S\+::drivers\+::\+Driver\+::get\+\_\+device\+\_\+name(), get\+\_\+driver(), Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::get\+\_\+type(), Max\+O\+S\+::drivers\+::\+Driver\+::get\+\_\+vendor\+\_\+name(), Max\+O\+S\+::hardwarecommunication\+::\+Input\+Output, list\+\_\+known\+\_\+deivce(), Max\+O\+S\+::drivers\+::\+Driver\+Selector\+Event\+Handler\+::on\+\_\+driver\+\_\+selected(), Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::port\+\_\+base, Max\+O\+S\+::hardwarecommunication\+::\+Base\+Address\+Register\+::type, and Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/hardwarecommunication/\mbox{\hyperlink{pci_8h}{pci.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/hardwarecommunication/\mbox{\hyperlink{pci_8cpp}{pci.\+cpp}}\end{DoxyCompactItemize}
