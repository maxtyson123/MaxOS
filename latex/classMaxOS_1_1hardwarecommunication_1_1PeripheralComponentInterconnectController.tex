\hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}{}\doxysection{Max\+OS\+::hardwarecommunication\+::Peripheral\+Component\+Interconnect\+Controller Class Reference}
\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}


Handles the selecting and loading of drivers for P\+CI devices.  




{\ttfamily \#include $<$pci.\+h$>$}

Inheritance diagram for Max\+OS\+::hardwarecommunication\+::Peripheral\+Component\+Interconnect\+Controller\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a80d982d6e9bc8407795d38c8c7ac1c6b}{Peripheral\+Component\+Interconnect\+Controller}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} $\ast$)
\begin{DoxyCompactList}\small\item\em \+\_\+\+\_\+\+C\+O\+N\+T\+R\+O\+L\+L\+E\+R\+\_\+\+\_\+\+\_\+ \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}{$\sim$\+Peripheral\+Component\+Interconnect\+Controller}} ()
\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad7dc1c715ecfdc809893ce363a688ce3}{select\+\_\+drivers}} (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelectorEventHandler}{drivers\+::\+Driver\+Selector\+Event\+Handler}} $\ast$handler, \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$interrupt\+\_\+manager) override
\begin{DoxyCompactList}\small\item\em Select the driver for the device. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{drivers\+::\+Driver}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}{get\+\_\+driver}} (\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}} dev, \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{Interrupt\+Manager}} $\ast$interrupt\+\_\+manager)
\begin{DoxyCompactList}\small\item\em Get the driver for the device. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}{list\+\_\+known\+\_\+deivce}} (\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}} dev)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles the selecting and loading of drivers for P\+CI devices. 

Definition at line 77 of file pci.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a80d982d6e9bc8407795d38c8c7ac1c6b}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a80d982d6e9bc8407795d38c8c7ac1c6b}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!PeripheralComponentInterconnectController@{PeripheralComponentInterconnectController}}
\index{PeripheralComponentInterconnectController@{PeripheralComponentInterconnectController}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{PeripheralComponentInterconnectController()}{PeripheralComponentInterconnectController()}}
{\footnotesize\ttfamily Peripheral\+Component\+Interconnect\+Controller\+::\+Peripheral\+Component\+Interconnect\+Controller (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} $\ast$}]{stream }\end{DoxyParamCaption})}



\+\_\+\+\_\+\+C\+O\+N\+T\+R\+O\+L\+L\+E\+R\+\_\+\+\_\+\+\_\+ 



Definition at line 80 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{81 : m\_data\_port(0xCFC),}
\DoxyCodeLine{82   m\_command\_port(0xCF8),}
\DoxyCodeLine{83   m\_debug\_messages\_stream(stream)}
\DoxyCodeLine{84 \{}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!````~PeripheralComponentInterconnectController@{$\sim$PeripheralComponentInterconnectController}}
\index{````~PeripheralComponentInterconnectController@{$\sim$PeripheralComponentInterconnectController}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{$\sim$PeripheralComponentInterconnectController()}{~PeripheralComponentInterconnectController()}}
{\footnotesize\ttfamily Peripheral\+Component\+Interconnect\+Controller\+::$\sim$\+Peripheral\+Component\+Interconnect\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 88 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{88                                                                                       \{}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!get\_driver@{get\_driver}}
\index{get\_driver@{get\_driver}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{get\_driver()}{get\_driver()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}} $\ast$ Peripheral\+Component\+Interconnect\+Controller\+::get\+\_\+driver (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}}}]{dev,  }\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager }\end{DoxyParamCaption})}



Get the driver for the device. 


\begin{DoxyParams}{Parameters}
{\em dev} & Device descriptor \\
\hline
{\em interrupt\+\_\+manager} & Interrupt manager \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Driver for the device, 0 if there is no driver 
\end{DoxyReturn}


Definition at line 238 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{238                                                                                                                                                      \{}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     \textcolor{comment}{// Dont use new here, manually allocate memory instead}}
\DoxyCodeLine{241 }
\DoxyCodeLine{242     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}}* driver = 0;}
\DoxyCodeLine{243     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}})}
\DoxyCodeLine{244     \{}
\DoxyCodeLine{245         \textcolor{keywordflow}{case} 0x1022:    \textcolor{comment}{//AMD}}
\DoxyCodeLine{246         \{}
\DoxyCodeLine{247             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{248             \{}
\DoxyCodeLine{249                 \textcolor{keywordflow}{case} 0x2000:    \textcolor{comment}{//am79c971}}
\DoxyCodeLine{250                 \{}
\DoxyCodeLine{251                     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}* result = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}*)MemoryManager::s\_active\_memory\_manager -\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}));}
\DoxyCodeLine{252                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}(\&dev, interrupt\_manager);}
\DoxyCodeLine{253                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{254 }
\DoxyCodeLine{255                 \}}
\DoxyCodeLine{256                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{257                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{258             \}}
\DoxyCodeLine{259             \textcolor{keywordflow}{break};}
\DoxyCodeLine{260         \}}
\DoxyCodeLine{261         \textcolor{keywordflow}{case} 0x8086:  \textcolor{comment}{//Intel}}
\DoxyCodeLine{262         \{}
\DoxyCodeLine{263             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{264             \{}
\DoxyCodeLine{265                 \textcolor{keywordflow}{case} 0x100E: \textcolor{comment}{//i217 (Ethernet Controller)}}
\DoxyCodeLine{266                 \{}
\DoxyCodeLine{267                     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}* result = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}*)MemoryManager::s\_active\_memory\_manager}
\DoxyCodeLine{268                           -\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}));}
\DoxyCodeLine{269                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classMaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}(\&dev, interrupt\_manager);}
\DoxyCodeLine{270                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{271                 \}}
\DoxyCodeLine{272                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{273                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{274             \}}
\DoxyCodeLine{275             \textcolor{keywordflow}{break};}
\DoxyCodeLine{276         \}\textcolor{comment}{//End Intel}}
\DoxyCodeLine{277     \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279     \textcolor{comment}{//If there is no driver for the particular device, go into generic devices}}
\DoxyCodeLine{280     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a22f5e9804805ec403208f97eb38502d5}{class\_id}})}
\DoxyCodeLine{281     \{}
\DoxyCodeLine{282         \textcolor{keywordflow}{case} 0x03: \textcolor{comment}{//Graphics}}
\DoxyCodeLine{283         \{}
\DoxyCodeLine{284 }
\DoxyCodeLine{285             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a49ec8dcf7819b4aa51acecc78f231a99}{subclass\_id}})}
\DoxyCodeLine{286             \{}
\DoxyCodeLine{287                 \textcolor{keywordflow}{case} 0x00:  \textcolor{comment}{//VGA}}
\DoxyCodeLine{288                 \{}
\DoxyCodeLine{289                     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}* result = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}*)MemoryManager::s\_active\_memory\_manager-\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}));}
\DoxyCodeLine{290                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}();}
\DoxyCodeLine{291                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{292                 \}}
\DoxyCodeLine{293             \}}
\DoxyCodeLine{294             \textcolor{keywordflow}{break};}
\DoxyCodeLine{295         \}}
\DoxyCodeLine{296     \}}
\DoxyCodeLine{297 }
\DoxyCodeLine{298     \textcolor{keywordflow}{return} driver;}
\DoxyCodeLine{299 \}}

\end{DoxyCode}


References Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::class\+\_\+id, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::device\+\_\+id, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::subclass\+\_\+id, and Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id.



Referenced by select\+\_\+drivers().

\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!list\_known\_deivce@{list\_known\_deivce}}
\index{list\_known\_deivce@{list\_known\_deivce}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{list\_known\_deivce()}{list\_known\_deivce()}}
{\footnotesize\ttfamily void Peripheral\+Component\+Interconnect\+Controller\+::list\+\_\+known\+\_\+deivce (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}}}]{dev }\end{DoxyParamCaption})}



Definition at line 302 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{302                                                                                                                      \{}
\DoxyCodeLine{303     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}})}
\DoxyCodeLine{304     \{}
\DoxyCodeLine{305         \textcolor{keywordflow}{case} 0x1022:}
\DoxyCodeLine{306         \{}
\DoxyCodeLine{307             \textcolor{comment}{// The vendor is AMD}}
\DoxyCodeLine{308             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"AMD "});}
\DoxyCodeLine{309 }
\DoxyCodeLine{310             \textcolor{comment}{// List the device}}
\DoxyCodeLine{311             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{312             \{}
\DoxyCodeLine{313                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{314                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{315                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{316             \}}
\DoxyCodeLine{317             \textcolor{keywordflow}{break};}
\DoxyCodeLine{318         \}}
\DoxyCodeLine{319 }
\DoxyCodeLine{320         \textcolor{keywordflow}{case} 0x106B:}
\DoxyCodeLine{321         \{}
\DoxyCodeLine{322             \textcolor{comment}{// The vendor is Apple}}
\DoxyCodeLine{323             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Apple "});}
\DoxyCodeLine{324 }
\DoxyCodeLine{325             \textcolor{comment}{// List the device}}
\DoxyCodeLine{326             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{327             \{}
\DoxyCodeLine{328                 \textcolor{keywordflow}{case} 0x003F:}
\DoxyCodeLine{329                 \{}
\DoxyCodeLine{330                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"KeyLargo/Intrepid USB"});}
\DoxyCodeLine{331                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{332                 \}}
\DoxyCodeLine{333 }
\DoxyCodeLine{334                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{335                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{336                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{337             \}}
\DoxyCodeLine{338             \textcolor{keywordflow}{break};}
\DoxyCodeLine{339         \}}
\DoxyCodeLine{340 }
\DoxyCodeLine{341         \textcolor{keywordflow}{case} 1234:}
\DoxyCodeLine{342         \{}
\DoxyCodeLine{343             \textcolor{comment}{// The vendor is QEMU}}
\DoxyCodeLine{344             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"QEMU "});}
\DoxyCodeLine{345 }
\DoxyCodeLine{346             \textcolor{comment}{// List the device}}
\DoxyCodeLine{347             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{348             \{}
\DoxyCodeLine{349 }
\DoxyCodeLine{350                 \textcolor{keywordflow}{case} 0x1111:}
\DoxyCodeLine{351                 \{}
\DoxyCodeLine{352                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Virtual Video Controller"});}
\DoxyCodeLine{353                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{354                 \}}
\DoxyCodeLine{355             \}}
\DoxyCodeLine{356             \textcolor{keywordflow}{break};}
\DoxyCodeLine{357         \}}
\DoxyCodeLine{358 }
\DoxyCodeLine{359         \textcolor{keywordflow}{case} 0x8086:}
\DoxyCodeLine{360         \{}
\DoxyCodeLine{361             \textcolor{comment}{// The vendor is Intel}}
\DoxyCodeLine{362             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Intel "});}
\DoxyCodeLine{363 }
\DoxyCodeLine{364             \textcolor{comment}{// List the device}}
\DoxyCodeLine{365             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}})}
\DoxyCodeLine{366             \{}
\DoxyCodeLine{367 }
\DoxyCodeLine{368                 \textcolor{keywordflow}{case} 0x1237:}
\DoxyCodeLine{369                 \{}
\DoxyCodeLine{370                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"440FX"});}
\DoxyCodeLine{371                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{372                 \}}
\DoxyCodeLine{373 }
\DoxyCodeLine{374                 \textcolor{keywordflow}{case} 0x2415:}
\DoxyCodeLine{375                 \{}
\DoxyCodeLine{376                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"AC'97"});}
\DoxyCodeLine{377                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{378                 \}}
\DoxyCodeLine{379 }
\DoxyCodeLine{380                 \textcolor{keywordflow}{case} 0x7000:}
\DoxyCodeLine{381                 \{}
\DoxyCodeLine{382                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX3"});}
\DoxyCodeLine{383                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{384 }
\DoxyCodeLine{385                 \}}
\DoxyCodeLine{386 }
\DoxyCodeLine{387                 \textcolor{keywordflow}{case} 0x7010:}
\DoxyCodeLine{388                 \{}
\DoxyCodeLine{389                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX4"});}
\DoxyCodeLine{390                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{391 }
\DoxyCodeLine{392                 \}}
\DoxyCodeLine{393 }
\DoxyCodeLine{394                 \textcolor{keywordflow}{case} 0x7111:}
\DoxyCodeLine{395                 \{}
\DoxyCodeLine{396                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX3"});}
\DoxyCodeLine{397                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{398                 \}}
\DoxyCodeLine{399 }
\DoxyCodeLine{400                 \textcolor{keywordflow}{case} 0x7113:}
\DoxyCodeLine{401                 \{}
\DoxyCodeLine{402                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX4 ACPI"});}
\DoxyCodeLine{403                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{404                 \}}
\DoxyCodeLine{405 }
\DoxyCodeLine{406                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{407                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{408 }
\DoxyCodeLine{409             \}}
\DoxyCodeLine{410             \textcolor{keywordflow}{break};}
\DoxyCodeLine{411         \}}
\DoxyCodeLine{412 }
\DoxyCodeLine{413         \textcolor{keywordflow}{case} 0x80EE: \{}
\DoxyCodeLine{414 }
\DoxyCodeLine{415             \textcolor{comment}{// The vendor is VirtualBox}}
\DoxyCodeLine{416             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"VirtualBox "});}
\DoxyCodeLine{417 }
\DoxyCodeLine{418             \textcolor{comment}{// List the device}}
\DoxyCodeLine{419             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}}) \{}
\DoxyCodeLine{420 }
\DoxyCodeLine{421                 \textcolor{keywordflow}{case} 0xBEEF: \{}
\DoxyCodeLine{422                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Graphics Adapter"});}
\DoxyCodeLine{423                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{424                 \}}
\DoxyCodeLine{425 }
\DoxyCodeLine{426                 \textcolor{keywordflow}{case} 0xCAFE: \{}
\DoxyCodeLine{427                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Guest Service"});}
\DoxyCodeLine{428                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{429                 \}}
\DoxyCodeLine{430             \}}
\DoxyCodeLine{431             \textcolor{keywordflow}{break};}
\DoxyCodeLine{432         \}}
\DoxyCodeLine{433 }
\DoxyCodeLine{434         \textcolor{keywordflow}{default}:    \textcolor{comment}{// Unknown}}
\DoxyCodeLine{435           m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}});}
\DoxyCodeLine{436           m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{" "});}
\DoxyCodeLine{437           m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a456992f1e2922b9bfd8128fd2a5ca998}{device\_id}});}
\DoxyCodeLine{438           \textcolor{keywordflow}{break};}
\DoxyCodeLine{439 }
\DoxyCodeLine{440     \}}
\DoxyCodeLine{441 \}}

\end{DoxyCode}


References Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::device\+\_\+id, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id, Max\+O\+S\+::common\+::\+Output\+Stream\+::write(), and Max\+O\+S\+::common\+::\+Output\+Stream\+::write\+\_\+hex().



Referenced by select\+\_\+drivers().

\mbox{\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad7dc1c715ecfdc809893ce363a688ce3}\label{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad7dc1c715ecfdc809893ce363a688ce3}} 
\index{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}!select\_drivers@{select\_drivers}}
\index{select\_drivers@{select\_drivers}!MaxOS::hardwarecommunication::PeripheralComponentInterconnectController@{MaxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{select\_drivers()}{select\_drivers()}}
{\footnotesize\ttfamily void Peripheral\+Component\+Interconnect\+Controller\+::select\+\_\+drivers (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelectorEventHandler}{drivers\+::\+Driver\+Selector\+Event\+Handler}} $\ast$}]{handler,  }\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Select the driver for the device. 


\begin{DoxyParams}{Parameters}
{\em driver\+Manager} & device driver manager \\
\hline
{\em interrupt\+\_\+manager} & Interrupt manager \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Driver for the device 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelector_a58b9eb7f96d223fde9417d4682fa12c1}{Max\+O\+S\+::drivers\+::\+Driver\+Selector}}.



Definition at line 159 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{160 \{}
\DoxyCodeLine{161     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} bus = 0; bus < 8; ++bus) \{}
\DoxyCodeLine{162         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} device = 0; device < 32; ++device) \{}
\DoxyCodeLine{163 }
\DoxyCodeLine{164             \textcolor{keywordtype}{int} numFunctions = (device\_has\_functions(bus, device)) ? 8 : 1;}
\DoxyCodeLine{165 }
\DoxyCodeLine{166             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \textcolor{keyword}{function} = 0; \textcolor{keyword}{function} < numFunctions; ++\textcolor{keyword}{function}) \{}
\DoxyCodeLine{167 }
\DoxyCodeLine{168                 \textcolor{comment}{// Get the device descriptor, if the vendor id is 0x0000 or 0xFFFF, the device is not present/ready}}
\DoxyCodeLine{169                 \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{PeripheralComponentInterconnectDeviceDescriptor}} deviceDescriptor = get\_device\_descriptor(bus, device, \textcolor{keyword}{function});}
\DoxyCodeLine{170                 \textcolor{keywordflow}{if}(deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}} == 0x0000 || deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}} == 0x0001 || deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a449730b72e7af8c4fc588ae2b5306a2a}{vendor\_id}} == 0xFFFF)}
\DoxyCodeLine{171                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 }
\DoxyCodeLine{174                 \textcolor{comment}{// Get port number}}
\DoxyCodeLine{175                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} barNum = 5; barNum >= 0; barNum-\/-\/)\{}
\DoxyCodeLine{176                     \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister}{BaseAddressRegister}} bar = get\_base\_address\_register(bus, device, \textcolor{keyword}{function}, barNum);}
\DoxyCodeLine{177                     \textcolor{keywordflow}{if}(bar.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a7ef7f325d5cb5dc23f44fde767e5db24}{address}} \&\& (bar.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_aa170a347420c72b96c5f94904fdc513d}{type}} == \mbox{\hyperlink{namespaceMaxOS_1_1hardwarecommunication_afc5ea080a9107e056194cc643a761608a082719ea5b78564a46291526ff4f3b2c}{InputOutput}}))}
\DoxyCodeLine{178                         deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_af9db8d9903071f7cf8611efa3c7a1333}{port\_base}} = (uint32\_t)bar.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a7ef7f325d5cb5dc23f44fde767e5db24}{address}};}
\DoxyCodeLine{179                 \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181                 \textcolor{comment}{// write to the debug stream}}
\DoxyCodeLine{182                 m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(deviceDescriptor.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_ab2ce5626480b7a91ebe27ea3f2d31229}{get\_type}}());}
\DoxyCodeLine{183                 m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{": "});}
\DoxyCodeLine{184 }
\DoxyCodeLine{185                 \textcolor{comment}{// Select the driver and print information about the device}}
\DoxyCodeLine{186                 \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}}* driver = \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}{get\_driver}}(deviceDescriptor, interrupt\_manager);}
\DoxyCodeLine{187                 \textcolor{keywordflow}{if}(driver != 0)\{}
\DoxyCodeLine{188                   handler-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelectorEventHandler_ad25298d6b14e6f790715563932cca77e}{on\_driver\_selected}}(driver);}
\DoxyCodeLine{189                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(driver-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a7ad761c929a49cfebd8c443f5af788f6}{get\_vendor\_name}}());}
\DoxyCodeLine{190                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{" "});}
\DoxyCodeLine{191                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(driver-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a65b06f2917f7a781e68f3748e81806b6}{get\_device\_name}}());}
\DoxyCodeLine{192                 \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{193                   \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}{list\_known\_deivce}}(deviceDescriptor);}
\DoxyCodeLine{194                 \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196                 \textcolor{comment}{// New line}}
\DoxyCodeLine{197                 m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"\(\backslash\)n"});}
\DoxyCodeLine{198             \}}
\DoxyCodeLine{199         \}}
\DoxyCodeLine{200     \}}
\DoxyCodeLine{201 \}}

\end{DoxyCode}


References Max\+O\+S\+::hardwarecommunication\+::\+Base\+Address\+Register\+::address, Max\+O\+S\+::drivers\+::\+Driver\+::get\+\_\+device\+\_\+name(), get\+\_\+driver(), Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::get\+\_\+type(), Max\+O\+S\+::drivers\+::\+Driver\+::get\+\_\+vendor\+\_\+name(), Max\+O\+S\+::hardwarecommunication\+::\+Input\+Output, list\+\_\+known\+\_\+deivce(), Max\+O\+S\+::drivers\+::\+Driver\+Selector\+Event\+Handler\+::on\+\_\+driver\+\_\+selected(), Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::port\+\_\+base, Max\+O\+S\+::hardwarecommunication\+::\+Base\+Address\+Register\+::type, Max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id, and Max\+O\+S\+::common\+::\+Output\+Stream\+::write().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/hardwarecommunication/\mbox{\hyperlink{pci_8h}{pci.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/hardwarecommunication/\mbox{\hyperlink{pci_8cpp}{pci.\+cpp}}\end{DoxyCompactItemize}
