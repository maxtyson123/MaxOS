\hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock}{}\doxysection{Max\+OS\+::drivers\+::clock\+::Clock Class Reference}
\label{classMaxOS_1_1drivers_1_1clock_1_1Clock}\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}


\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}} for the A\+P\+IC clock.  




{\ttfamily \#include $<$clock.\+h$>$}

Inheritance diagram for Max\+OS\+::drivers\+::clock\+::Clock\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.232123cm]{classMaxOS_1_1drivers_1_1clock_1_1Clock}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ae02417db4ddd076bade3618aeca8e71c}{Clock}} (\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$interrupt\+\_\+manager, \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedProgrammableInterruptController}{hardwarecommunication\+::\+Advanced\+Programmable\+Interrupt\+Controller}} $\ast$apic, uint16\+\_\+t time\+\_\+between\+\_\+events=10)
\begin{DoxyCompactList}\small\item\em {\bfseries{\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}}}} \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_afc976ce68fa85e15cc06f9ed47bddb7c}{$\sim$\+Clock}} ()
\item 
void \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a7d105f260a9197c78e77e0ba437f0168}{activate}} () override
\begin{DoxyCompactList}\small\item\em Activates the clock, setting the binary coded decimal representation flag. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_abc9de19ed4bbd05fa8e449ef0df48ad5}{delay}} (uint32\+\_\+t milliseconds)
\begin{DoxyCompactList}\small\item\em Delays the program for a specified number of milliseconds (rounded to the nearest 100) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_afab69ba284bca41ae58a19b1821ad6c1}{calibrate}} (uint64\+\_\+t ms\+\_\+per\+\_\+tick=1)
\item 
\mbox{\hyperlink{structMaxOS_1_1common_1_1Time}{common\+::\+Time}} \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a138de5b2eb0367cd755e9e32cac3628f}{get\+\_\+time}} ()
\item 
\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_afff456a86d73eda4507a2fe503485ac5}{get\+\_\+vendor\+\_\+name}} () final
\begin{DoxyCompactList}\small\item\em Gets the name of the vendor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad3eddc94ae13577816756ff70c72a02a}{get\+\_\+device\+\_\+name}} () final
\begin{DoxyCompactList}\small\item\em Gets the name of the device. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a1f0352d2346a3bef618e5c6f3bc71c0c}{handle\+\_\+interrupt}} () final
\begin{DoxyCompactList}\small\item\em Handle the clock interrupt, raising the clock event if enough time has passed. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\+\_\+hardware\+\_\+clock}} (uint8\+\_\+t \mbox{\hyperlink{gdt_8h_ab6b52376c1b9d81e6ea6f95a1225f832}{address}})
\begin{DoxyCompactList}\small\item\em read the current time from the hardware clock and return it \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\+\_\+representation}} (uint8\+\_\+t number)
\begin{DoxyCompactList}\small\item\em The binary representation of a number. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ab008d858cc950af7173ec4a01fca7d3b}{m\+\_\+binary}}
\item 
bool \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a93c66ecaa24a0024735e8ca110c23bae}{m\+\_\+24\+\_\+hour\+\_\+clock}}
\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a6d62ea94e81648255c5f34900f41b75d}{m\+\_\+data\+\_\+port}}
\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad4057fa9725f73ccf20eeaff0cd28a23}{m\+\_\+command\+\_\+port}}
\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedProgrammableInterruptController}{hardwarecommunication\+::\+Advanced\+Programmable\+Interrupt\+Controller}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}{m\+\_\+apic}}
\item 
uint16\+\_\+t \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_adf42c9a1226e5b2de6e547eb26d26510}{m\+\_\+ticks\+\_\+between\+\_\+events}} \{ 0 \}
\item 
uint16\+\_\+t \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_abf1a0f66bbce7162968437985fd65471}{m\+\_\+ticks\+\_\+until\+\_\+next\+\_\+event}} \{ 1 \}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}} for the A\+P\+IC clock. 

Definition at line 122 of file clock.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_ae02417db4ddd076bade3618aeca8e71c}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_ae02417db4ddd076bade3618aeca8e71c}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!Clock@{Clock}}
\index{Clock@{Clock}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{Clock()}{Clock()}}
{\footnotesize\ttfamily Clock\+::\+Clock (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager,  }\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedProgrammableInterruptController}{hardwarecommunication\+::\+Advanced\+Programmable\+Interrupt\+Controller}} $\ast$}]{apic,  }\item[{uint16\+\_\+t}]{time\+\_\+between\+\_\+events = {\ttfamily 10} }\end{DoxyParamCaption})}



{\bfseries{\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}}}} 

Constructor for the \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}} class


\begin{DoxyParams}{Parameters}
{\em interrupt\+\_\+manager} & The interrupt manager \\
\hline
{\em time\+\_\+between\+\_\+events} & The time between events in 10ths of a second \\
\hline
\end{DoxyParams}


Definition at line 55 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{56 : \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_ad69102adf099f472b9eba69c5ae20d81}{Driver}}(),}
\DoxyCodeLine{57   \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptHandler_a23513de3e722d6f7183a9b51b1d86c48}{InterruptHandler}}(0x20, interrupt\_manager),}
\DoxyCodeLine{58   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a6d62ea94e81648255c5f34900f41b75d}{m\_data\_port}}(0x71),}
\DoxyCodeLine{59   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad4057fa9725f73ccf20eeaff0cd28a23}{m\_command\_port}}(0x70),}
\DoxyCodeLine{60   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}{m\_apic}}(apic),}
\DoxyCodeLine{61   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_adf42c9a1226e5b2de6e547eb26d26510}{m\_ticks\_between\_events}}(time\_between\_events)}
\DoxyCodeLine{62 \{}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_afc976ce68fa85e15cc06f9ed47bddb7c}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_afc976ce68fa85e15cc06f9ed47bddb7c}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!````~Clock@{$\sim$Clock}}
\index{````~Clock@{$\sim$Clock}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{$\sim$Clock()}{~Clock()}}
{\footnotesize\ttfamily Clock\+::$\sim$\+Clock (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 66 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{66               \{}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_a7d105f260a9197c78e77e0ba437f0168}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_a7d105f260a9197c78e77e0ba437f0168}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!activate@{activate}}
\index{activate@{activate}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{activate()}{activate()}}
{\footnotesize\ttfamily void Clock\+::activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Activates the clock, setting the binary coded decimal representation flag. 



Reimplemented from \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a92276c08d77279b6a86c900190ef797b}{Max\+O\+S\+::drivers\+::\+Driver}}.



Definition at line 128 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{128                      \{}
\DoxyCodeLine{129 }
\DoxyCodeLine{130     \textcolor{comment}{// read the status register}}
\DoxyCodeLine{131     uint8\_t \mbox{\hyperlink{intel__i217_8h_ade818037fd6c985038ff29656089758d}{status}} = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0xB);}
\DoxyCodeLine{132 }
\DoxyCodeLine{133     \textcolor{comment}{// Set the clock information}}
\DoxyCodeLine{134     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a93c66ecaa24a0024735e8ca110c23bae}{m\_24\_hour\_clock}} = \mbox{\hyperlink{intel__i217_8h_ade818037fd6c985038ff29656089758d}{status}} \& 0x02;}
\DoxyCodeLine{135     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ab008d858cc950af7173ec4a01fca7d3b}{m\_binary}} = \mbox{\hyperlink{intel__i217_8h_ade818037fd6c985038ff29656089758d}{status}} \& 0x04;}
\DoxyCodeLine{136 }
\DoxyCodeLine{137 \}}

\end{DoxyCode}


References m\+\_\+24\+\_\+hour\+\_\+clock, m\+\_\+binary, read\+\_\+hardware\+\_\+clock(), and status.

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!binary\_representation@{binary\_representation}}
\index{binary\_representation@{binary\_representation}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{binary\_representation()}{binary\_representation()}}
{\footnotesize\ttfamily uint8\+\_\+t Clock\+::binary\+\_\+representation (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{number }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



The binary representation of a number. 


\begin{DoxyParams}{Parameters}
{\em number} & The number to convert \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The binary representation of the number if the binary coded decimal representation is used, otherwise the number 
\end{DoxyReturn}


Definition at line 114 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{114                                                    \{}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{comment}{// If the binary coded decimal representation is not used, return the number}}
\DoxyCodeLine{117     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ab008d858cc950af7173ec4a01fca7d3b}{m\_binary}})}
\DoxyCodeLine{118         \textcolor{keywordflow}{return} number;}
\DoxyCodeLine{119 }
\DoxyCodeLine{120     \textcolor{comment}{// Otherwise, return the binary representation}}
\DoxyCodeLine{121     \textcolor{keywordflow}{return} ((number / 16) * 10) + (number \& 0x0f);}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \}}

\end{DoxyCode}


References m\+\_\+binary.



Referenced by get\+\_\+time().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_afab69ba284bca41ae58a19b1821ad6c1}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_afab69ba284bca41ae58a19b1821ad6c1}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!calibrate@{calibrate}}
\index{calibrate@{calibrate}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{calibrate()}{calibrate()}}
{\footnotesize\ttfamily void Clock\+::calibrate (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{ms\+\_\+per\+\_\+tick = {\ttfamily 1} }\end{DoxyParamCaption})}



Definition at line 177 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{177                                           \{}
\DoxyCodeLine{178 }
\DoxyCodeLine{179   \textcolor{comment}{// Get the ticks per ms}}
\DoxyCodeLine{180   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1PIT}{PIT}} pit(\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptHandler_ad4f768f21181574bb7670369bf1a5af3}{m\_interrupt\_manager}}, \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}{m\_apic}});}
\DoxyCodeLine{181   uint32\_t ticks\_per\_ms = pit.ticks\_per\_ms();}
\DoxyCodeLine{182 }
\DoxyCodeLine{183   \textcolor{comment}{// Set the timer vector to 0x20 and configure it for periodic mode}}
\DoxyCodeLine{184   uint32\_t lvt = 0x20 | (1 << 17);}
\DoxyCodeLine{185   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}{m\_apic}} -\/> get\_local\_apic() -\/> \mbox{\hyperlink{physical_8h_af3329fc9f76244f46dedda8e02ba8066}{write}}(0x320, lvt);}
\DoxyCodeLine{186 }
\DoxyCodeLine{187   \textcolor{comment}{// Set the intial count}}
\DoxyCodeLine{188   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}{m\_apic}} -\/> get\_local\_apic() -\/> \mbox{\hyperlink{physical_8h_af3329fc9f76244f46dedda8e02ba8066}{write}}(0x380, ms\_per\_tick * ticks\_per\_ms);}
\DoxyCodeLine{189 }
\DoxyCodeLine{190   \textcolor{comment}{// Clear the mask bit}}
\DoxyCodeLine{191   lvt \&= \string~(1 << 16);}
\DoxyCodeLine{192   \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}{m\_apic}} -\/> get\_local\_apic() -\/> \mbox{\hyperlink{physical_8h_af3329fc9f76244f46dedda8e02ba8066}{write}}(0x380, lvt);}
\DoxyCodeLine{193 }
\DoxyCodeLine{194   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"Clock Calibrated\(\backslash\)n"});}
\DoxyCodeLine{195 \}}

\end{DoxyCode}


References \+\_\+kprintf, m\+\_\+apic, Max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Handler\+::m\+\_\+interrupt\+\_\+manager, Max\+O\+S\+::drivers\+::clock\+::\+P\+I\+T\+::ticks\+\_\+per\+\_\+ms(), and write.



Referenced by kernel\+Main().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_abc9de19ed4bbd05fa8e449ef0df48ad5}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_abc9de19ed4bbd05fa8e449ef0df48ad5}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!delay@{delay}}
\index{delay@{delay}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{delay()}{delay()}}
{\footnotesize\ttfamily void Clock\+::delay (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{milliseconds }\end{DoxyParamCaption})}



Delays the program for a specified number of milliseconds (rounded to the nearest 100) 


\begin{DoxyParams}{Parameters}
{\em milliseconds} & How many milliseconds to delay the program for \\
\hline
\end{DoxyParams}


Definition at line 145 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{145                                        \{}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 }
\DoxyCodeLine{148     \textcolor{comment}{//TODO Create a const for accurcy of clock and use that for calibration and rounding}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150     \textcolor{comment}{// Round the number of milliseconds to the nearest 100}}
\DoxyCodeLine{151     uint64\_t rounded\_milliseconds =  ((milliseconds+99)/100);}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \textcolor{comment}{// Calculate the number of ticks until the delay is over}}
\DoxyCodeLine{154     uint64\_t ticks\_until\_delay\_is\_over = m\_ticks + rounded\_milliseconds;}
\DoxyCodeLine{155 }
\DoxyCodeLine{156     \textcolor{comment}{// Wait until the number of ticks is equal to the number of ticks until the delay is over}}
\DoxyCodeLine{157     \textcolor{keywordflow}{while}(m\_ticks < ticks\_until\_delay\_is\_over)}
\DoxyCodeLine{158         \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"nop"});}
\DoxyCodeLine{159 \}}

\end{DoxyCode}


Referenced by kernel\+Main().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad3eddc94ae13577816756ff70c72a02a}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad3eddc94ae13577816756ff70c72a02a}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!get\_device\_name@{get\_device\_name}}
\index{get\_device\_name@{get\_device\_name}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{get\_device\_name()}{get\_device\_name()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} Clock\+::get\+\_\+device\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Gets the name of the device. 

\begin{DoxyReturn}{Returns}
The name of the device 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a65b06f2917f7a781e68f3748e81806b6}{Max\+O\+S\+::drivers\+::\+Driver}}.



Definition at line 173 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{173                               \{}
\DoxyCodeLine{174     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"Clock"};}
\DoxyCodeLine{175 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_a138de5b2eb0367cd755e9e32cac3628f}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_a138de5b2eb0367cd755e9e32cac3628f}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!get\_time@{get\_time}}
\index{get\_time@{get\_time}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{get\_time()}{get\_time()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structMaxOS_1_1common_1_1Time}{common\+::\+Time}} Clock\+::get\+\_\+time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 198 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{198                            \{}
\DoxyCodeLine{199 }
\DoxyCodeLine{200   \textcolor{comment}{// Wait for the clock to be ready}}
\DoxyCodeLine{201   \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0xA) \& 0x80)}
\DoxyCodeLine{202       \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"nop"});}
\DoxyCodeLine{203 }
\DoxyCodeLine{204   \textcolor{comment}{// Create a time object}}
\DoxyCodeLine{205   \mbox{\hyperlink{structMaxOS_1_1common_1_1Time}{Time}} time\{\};}
\DoxyCodeLine{206 }
\DoxyCodeLine{207   \textcolor{comment}{// read the time from the hardware clock}}
\DoxyCodeLine{208   time.\mbox{\hyperlink{structMaxOS_1_1common_1_1Time_a50022d033aeb34a1870e7d8240a4e1ca}{year}} = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x9)) + 2000;}
\DoxyCodeLine{209   time.month = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x8));}
\DoxyCodeLine{210   time.day = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x7));}
\DoxyCodeLine{211   time.hour = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x4));}
\DoxyCodeLine{212   time.minute = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x2));}
\DoxyCodeLine{213   time.second = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x0));}
\DoxyCodeLine{214 }
\DoxyCodeLine{215   \textcolor{comment}{// If the clock is using 12hr format and PM is set then add 12 to the hour}}
\DoxyCodeLine{216   \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a93c66ecaa24a0024735e8ca110c23bae}{m\_24\_hour\_clock}} \&\& (time.hour \& 0x80) != 0)}
\DoxyCodeLine{217     time.hour = ((time.hour \& 0x7F) + 12) \% 24;}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 }
\DoxyCodeLine{220   \textcolor{comment}{//Raise the clock event}}
\DoxyCodeLine{221   \textcolor{keywordflow}{return} time;}
\DoxyCodeLine{222 \}}

\end{DoxyCode}


References binary\+\_\+representation(), m\+\_\+24\+\_\+hour\+\_\+clock, read\+\_\+hardware\+\_\+clock(), and Max\+O\+S\+::common\+::\+Time\+::year.



Referenced by kernel\+Main().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_afff456a86d73eda4507a2fe503485ac5}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_afff456a86d73eda4507a2fe503485ac5}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!get\_vendor\_name@{get\_vendor\_name}}
\index{get\_vendor\_name@{get\_vendor\_name}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{get\_vendor\_name()}{get\_vendor\_name()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} Clock\+::get\+\_\+vendor\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Gets the name of the vendor. 

\begin{DoxyReturn}{Returns}
The name of the vendor 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver_a7ad761c929a49cfebd8c443f5af788f6}{Max\+O\+S\+::drivers\+::\+Driver}}.



Definition at line 165 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{165                               \{}
\DoxyCodeLine{166     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"Generic"};}
\DoxyCodeLine{167 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_a1f0352d2346a3bef618e5c6f3bc71c0c}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_a1f0352d2346a3bef618e5c6f3bc71c0c}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!handle\_interrupt@{handle\_interrupt}}
\index{handle\_interrupt@{handle\_interrupt}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{handle\_interrupt()}{handle\_interrupt()}}
{\footnotesize\ttfamily void Clock\+::handle\+\_\+interrupt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Handle the clock interrupt, raising the clock event if enough time has passed. 



Reimplemented from \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptHandler_abd792bc53ec7dd1b70c8386853cc3c33}{Max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Handler}}.



Definition at line 74 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{74                              \{}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{comment}{// Increment the number of ticks and decrement the number of ticks until the next event}}
\DoxyCodeLine{77     m\_ticks++;}
\DoxyCodeLine{78     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_abf1a0f66bbce7162968437985fd65471}{m\_ticks\_until\_next\_event}}-\/-\/;}
\DoxyCodeLine{79 }
\DoxyCodeLine{80     \textcolor{comment}{// If the number of ticks until the next event is not 0 then return}}
\DoxyCodeLine{81     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_abf1a0f66bbce7162968437985fd65471}{m\_ticks\_until\_next\_event}} != 0)}
\DoxyCodeLine{82         \textcolor{keywordflow}{return};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{comment}{// Otherwise, reset the number of ticks until the next event}}
\DoxyCodeLine{85     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_abf1a0f66bbce7162968437985fd65471}{m\_ticks\_until\_next\_event}} = \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_adf42c9a1226e5b2de6e547eb26d26510}{m\_ticks\_between\_events}};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     \textcolor{comment}{// Raise the time event}}
\DoxyCodeLine{88 \textcolor{comment}{//    Time time = get\_time();}}
\DoxyCodeLine{89 \textcolor{comment}{//    raise\_event(new TimeEvent(\&time));}}
\DoxyCodeLine{90 \}}

\end{DoxyCode}


References m\+\_\+ticks\+\_\+between\+\_\+events, and m\+\_\+ticks\+\_\+until\+\_\+next\+\_\+event.

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!read\_hardware\_clock@{read\_hardware\_clock}}
\index{read\_hardware\_clock@{read\_hardware\_clock}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{read\_hardware\_clock()}{read\_hardware\_clock()}}
{\footnotesize\ttfamily uint8\+\_\+t Clock\+::read\+\_\+hardware\+\_\+clock (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{address }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



read the current time from the hardware clock and return it 


\begin{DoxyParams}{Parameters}
{\em address} & The address of the register to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the register 
\end{DoxyReturn}


Definition at line 99 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{100 \{}
\DoxyCodeLine{101     \textcolor{comment}{// Send the address to the hardware clock}}
\DoxyCodeLine{102     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad4057fa9725f73ccf20eeaff0cd28a23}{m\_command\_port}}.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1Port8Bit_a6ede8fba6ba7e26c5982a91a3d5ffa72}{write}}(\mbox{\hyperlink{amd__am79c973_8h_ac0d31ca829f934cccd89f8054e02773e}{address}});}
\DoxyCodeLine{103 }
\DoxyCodeLine{104     \textcolor{comment}{// read the value from the hardware clock}}
\DoxyCodeLine{105     \textcolor{keywordflow}{return} \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_a6d62ea94e81648255c5f34900f41b75d}{m\_data\_port}}.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1Port8Bit_a425297307d64cb5d9889b32767f8fdc3}{read}}();}
\DoxyCodeLine{106 \}}

\end{DoxyCode}


References address, m\+\_\+command\+\_\+port, m\+\_\+data\+\_\+port, Max\+O\+S\+::hardwarecommunication\+::\+Port8\+Bit\+::read(), and Max\+O\+S\+::hardwarecommunication\+::\+Port8\+Bit\+::write().



Referenced by activate(), and get\+\_\+time().



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_a93c66ecaa24a0024735e8ca110c23bae}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_a93c66ecaa24a0024735e8ca110c23bae}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_24\_hour\_clock@{m\_24\_hour\_clock}}
\index{m\_24\_hour\_clock@{m\_24\_hour\_clock}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_24\_hour\_clock}{m\_24\_hour\_clock}}
{\footnotesize\ttfamily bool Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+24\+\_\+hour\+\_\+clock\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 130 of file clock.\+h.



Referenced by activate(), and get\+\_\+time().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_aa1fe13def15785a6c01f4db495228f24}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_apic@{m\_apic}}
\index{m\_apic@{m\_apic}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_apic}{m\_apic}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedProgrammableInterruptController}{hardwarecommunication\+::\+Advanced\+Programmable\+Interrupt\+Controller}}$\ast$ Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+apic\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 137 of file clock.\+h.



Referenced by calibrate().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_ab008d858cc950af7173ec4a01fca7d3b}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_ab008d858cc950af7173ec4a01fca7d3b}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_binary@{m\_binary}}
\index{m\_binary@{m\_binary}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_binary}{m\_binary}}
{\footnotesize\ttfamily bool Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+binary\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 129 of file clock.\+h.



Referenced by activate(), and binary\+\_\+representation().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad4057fa9725f73ccf20eeaff0cd28a23}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_ad4057fa9725f73ccf20eeaff0cd28a23}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_command\_port@{m\_command\_port}}
\index{m\_command\_port@{m\_command\_port}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_command\_port}{m\_command\_port}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+command\+\_\+port\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 134 of file clock.\+h.



Referenced by read\+\_\+hardware\+\_\+clock().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_a6d62ea94e81648255c5f34900f41b75d}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_a6d62ea94e81648255c5f34900f41b75d}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_data\_port@{m\_data\_port}}
\index{m\_data\_port@{m\_data\_port}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_data\_port}{m\_data\_port}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+data\+\_\+port\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 133 of file clock.\+h.



Referenced by read\+\_\+hardware\+\_\+clock().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_adf42c9a1226e5b2de6e547eb26d26510}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_adf42c9a1226e5b2de6e547eb26d26510}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_ticks\_between\_events@{m\_ticks\_between\_events}}
\index{m\_ticks\_between\_events@{m\_ticks\_between\_events}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_ticks\_between\_events}{m\_ticks\_between\_events}}
{\footnotesize\ttfamily uint16\+\_\+t Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+ticks\+\_\+between\+\_\+events \{ 0 \}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 140 of file clock.\+h.



Referenced by handle\+\_\+interrupt().

\mbox{\Hypertarget{classMaxOS_1_1drivers_1_1clock_1_1Clock_abf1a0f66bbce7162968437985fd65471}\label{classMaxOS_1_1drivers_1_1clock_1_1Clock_abf1a0f66bbce7162968437985fd65471}} 
\index{MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}!m\_ticks\_until\_next\_event@{m\_ticks\_until\_next\_event}}
\index{m\_ticks\_until\_next\_event@{m\_ticks\_until\_next\_event}!MaxOS::drivers::clock::Clock@{MaxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_ticks\_until\_next\_event}{m\_ticks\_until\_next\_event}}
{\footnotesize\ttfamily uint16\+\_\+t Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+ticks\+\_\+until\+\_\+next\+\_\+event \{ 1 \}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 141 of file clock.\+h.



Referenced by handle\+\_\+interrupt().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/drivers/clock/\mbox{\hyperlink{clock_8h}{clock.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/drivers/clock/\mbox{\hyperlink{clock_8cpp}{clock.\+cpp}}\end{DoxyCompactItemize}
