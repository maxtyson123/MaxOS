\hypertarget{kernel_8cpp}{}\doxysection{/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/kernel.cpp File Reference}
\label{kernel_8cpp}\index{/home/runner/work/MaxOS/MaxOS/kernel/src/kernel.cpp@{/home/runner/work/MaxOS/MaxOS/kernel/src/kernel.cpp}}
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$common/version.\+h$>$}\newline
{\ttfamily \#include $<$common/kprint.\+h$>$}\newline
{\ttfamily \#include $<$hardwarecommunication/interrupts.\+h$>$}\newline
{\ttfamily \#include $<$hardwarecommunication/pci.\+h$>$}\newline
{\ttfamily \#include $<$hardwarecommunication/acpi.\+h$>$}\newline
{\ttfamily \#include $<$hardwarecommunication/apic.\+h$>$}\newline
{\ttfamily \#include $<$drivers/disk/ata.\+h$>$}\newline
{\ttfamily \#include $<$drivers/console/console.\+h$>$}\newline
{\ttfamily \#include $<$drivers/console/serial.\+h$>$}\newline
{\ttfamily \#include $<$drivers/console/textmode.\+h$>$}\newline
{\ttfamily \#include $<$drivers/console/vesaboot.\+h$>$}\newline
{\ttfamily \#include $<$drivers/driver.\+h$>$}\newline
{\ttfamily \#include $<$drivers/ethernet/amd\+\_\+am79c973.\+h$>$}\newline
{\ttfamily \#include $<$drivers/peripherals/keyboard.\+h$>$}\newline
{\ttfamily \#include $<$drivers/peripherals/mouse.\+h$>$}\newline
{\ttfamily \#include $<$drivers/video/vesa.\+h$>$}\newline
{\ttfamily \#include $<$drivers/video/video.\+h$>$}\newline
{\ttfamily \#include $<$gui/desktop.\+h$>$}\newline
{\ttfamily \#include $<$gui/window.\+h$>$}\newline
{\ttfamily \#include $<$gui/widgets/text.\+h$>$}\newline
{\ttfamily \#include $<$gui/widgets/button.\+h$>$}\newline
{\ttfamily \#include $<$gui/widgets/inputbox.\+h$>$}\newline
{\ttfamily \#include $<$net/ethernetframe.\+h$>$}\newline
{\ttfamily \#include $<$net/arp.\+h$>$}\newline
{\ttfamily \#include $<$net/ipv4.\+h$>$}\newline
{\ttfamily \#include $<$net/icmp.\+h$>$}\newline
{\ttfamily \#include $<$net/udp.\+h$>$}\newline
{\ttfamily \#include $<$net/tcp.\+h$>$}\newline
{\ttfamily \#include $<$processes/process.\+h$>$}\newline
{\ttfamily \#include $<$processes/scheduler.\+h$>$}\newline
{\ttfamily \#include $<$system/cpu.\+h$>$}\newline
{\ttfamily \#include $<$system/syscalls.\+h$>$}\newline
{\ttfamily \#include $<$memory/memorymanagement.\+h$>$}\newline
{\ttfamily \#include $<$memory/physical.\+h$>$}\newline
{\ttfamily \#include $<$memory/virtual.\+h$>$}\newline
{\ttfamily \#include $<$filesystem/msdospart.\+h$>$}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(x)~out = x; cout $<$$<$ out; cout $<$$<$ (string)\char`\"{} \char`\"{} $\ast$ (sub\+\_\+boot\+\_\+width -\/ \mbox{\hyperlink{udp_8h_a1892eba2086d12ac2b09005aeb09ea3b}{out.\+length}}() -\/ 6) $<$$<$ tick $<$$<$ \char`\"{}\textbackslash{}n\char`\"{};
\item 
\#define \mbox{\hyperlink{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}{header}}(x)~cout $<$$<$ \char`\"{}\textbackslash{}n\textbackslash{}n\char`\"{} $<$$<$ A\+N\+S\+I\+\_\+\+C\+O\+L\+O\+U\+RS\mbox{[}F\+G\+\_\+\+White\mbox{]} $<$$<$ \char`\"{}\mbox{[}\char`\"{} $<$$<$ string(x).center(sub\+\_\+boot\+\_\+width -\/ 2) $<$$<$ \char`\"{}\mbox{]}\textbackslash{}n\char`\"{} $<$$<$ A\+N\+S\+I\+\_\+\+C\+O\+L\+O\+U\+RS\mbox{[}Reset\mbox{]};
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \mbox{\hyperlink{kernel_8cpp_a12d367671a45721e5f93f37959360759}{constructor}}) ()
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{kernel_8cpp_adb9a0feb0c70ccbff82716bf531a2e42}{call\+Constructors}} ()
\item 
void \mbox{\hyperlink{kernel_8cpp_a64d1f63d75fef5a193446b997b7a9090}{kernel\+Main}} (unsigned long addr, unsigned long magic)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
void $\ast$ \mbox{\hyperlink{kernel_8cpp_a19df960d2907e9c08a720ae7683e632c}{\+\_\+\+\_\+dso\+\_\+handle}} = nullptr
\item 
\mbox{\hyperlink{kernel_8cpp_a12d367671a45721e5f93f37959360759}{constructor}} \mbox{\hyperlink{kernel_8cpp_a00bc71da06b4a8e02a8587bf37dd984b}{start\+\_\+ctors}}
\item 
\mbox{\hyperlink{kernel_8cpp_a12d367671a45721e5f93f37959360759}{constructor}} \mbox{\hyperlink{kernel_8cpp_affa4f606954d8d9a7edcb66df47b7f1d}{end\+\_\+ctors}}
\item 
\mbox{\hyperlink{classMaxOS_1_1drivers_1_1console_1_1ConsoleStream}{Console\+Stream}} $\ast$ \mbox{\hyperlink{kernel_8cpp_a8a91cb8e583436630a67b65651fb043e}{active\+\_\+stream}} = nullptr
\item 
volatile uint64\+\_\+t \mbox{\hyperlink{kernel_8cpp_a19f262860236e9c10064948f12f89636}{p4\+\_\+table}} \mbox{[}512\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}\label{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}} 
\index{kernel.cpp@{kernel.cpp}!header@{header}}
\index{header@{header}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{header}{header}}
{\footnotesize\ttfamily \#define header(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~cout $<$$<$ \char`\"{}\textbackslash{}n\textbackslash{}n\char`\"{} $<$$<$ A\+N\+S\+I\+\_\+\+C\+O\+L\+O\+U\+RS\mbox{[}F\+G\+\_\+\+White\mbox{]} $<$$<$ \char`\"{}\mbox{[}\char`\"{} $<$$<$ string(x).center(sub\+\_\+boot\+\_\+width -\/ 2) $<$$<$ \char`\"{}\mbox{]}\textbackslash{}n\char`\"{} $<$$<$ A\+N\+S\+I\+\_\+\+C\+O\+L\+O\+U\+RS\mbox{[}Reset\mbox{]};}

\mbox{\Hypertarget{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}\label{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}} 
\index{kernel.cpp@{kernel.cpp}!log@{log}}
\index{log@{log}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{log}{log}}
{\footnotesize\ttfamily \#define log(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~out = x; cout $<$$<$ out; cout $<$$<$ (string)\char`\"{} \char`\"{} $\ast$ (sub\+\_\+boot\+\_\+width -\/ \mbox{\hyperlink{udp_8h_a1892eba2086d12ac2b09005aeb09ea3b}{out.\+length}}() -\/ 6) $<$$<$ tick $<$$<$ \char`\"{}\textbackslash{}n\char`\"{};}



\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{kernel_8cpp_a12d367671a45721e5f93f37959360759}\label{kernel_8cpp_a12d367671a45721e5f93f37959360759}} 
\index{kernel.cpp@{kernel.cpp}!constructor@{constructor}}
\index{constructor@{constructor}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{constructor}{constructor}}
{\footnotesize\ttfamily typedef void($\ast$ constructor) ()}



Definition at line 80 of file kernel.\+cpp.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{kernel_8cpp_adb9a0feb0c70ccbff82716bf531a2e42}\label{kernel_8cpp_adb9a0feb0c70ccbff82716bf531a2e42}} 
\index{kernel.cpp@{kernel.cpp}!callConstructors@{callConstructors}}
\index{callConstructors@{callConstructors}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{callConstructors()}{callConstructors()}}
{\footnotesize\ttfamily void call\+Constructors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 85 of file kernel.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{86 \{}
\DoxyCodeLine{87     \textcolor{keywordflow}{for}(\mbox{\hyperlink{kernel_8cpp_a12d367671a45721e5f93f37959360759}{constructor}}* \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} = \&\mbox{\hyperlink{kernel_8cpp_a00bc71da06b4a8e02a8587bf37dd984b}{start\_ctors}}; \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} != \&\mbox{\hyperlink{kernel_8cpp_affa4f606954d8d9a7edcb66df47b7f1d}{end\_ctors}}; \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}++)        \textcolor{comment}{//Iterate over all constructors}}
\DoxyCodeLine{88         (*\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}})();                                                     \textcolor{comment}{//Call the constructor}}
\DoxyCodeLine{89 \}}

\end{DoxyCode}


References end\+\_\+ctors, Max\+O\+S\+::drivers\+::peripherals\+::i, and start\+\_\+ctors.

\mbox{\Hypertarget{kernel_8cpp_a64d1f63d75fef5a193446b997b7a9090}\label{kernel_8cpp_a64d1f63d75fef5a193446b997b7a9090}} 
\index{kernel.cpp@{kernel.cpp}!kernelMain@{kernelMain}}
\index{kernelMain@{kernelMain}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{kernelMain()}{kernelMain()}}
{\footnotesize\ttfamily void kernel\+Main (\begin{DoxyParamCaption}\item[{unsigned long}]{addr,  }\item[{unsigned long}]{magic }\end{DoxyParamCaption})}

Boot Done ///

How this idle works\+: I was debugging along and released that on the first ever schedule it will set current\+\_\+thread-\/$>$execution\+\_\+state = cpu\+\_\+state; where it is assumed cpu\+\_\+state is the current thread state (ie what we have just been scheduling) and thus saves it in that thread. However, as the first thread has not had a chance to be scheduled yet, the current state is not the expected first thread\textquotesingle{}s state and instead is the cpu state of the kernel. Now I could either fix that or leave it in as a cool way of never fully leaving kernel\+Main and also having a idle\+\_\+proc

Definition at line 94 of file kernel.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{95 \{}
\DoxyCodeLine{96     \textcolor{comment}{// Initialise the serial console}}
\DoxyCodeLine{97     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1SerialConsole}{SerialConsole}} serialConsole;}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     \textcolor{comment}{// Confirm the bootloader}}
\DoxyCodeLine{100     \mbox{\hyperlink{kprint_8h_adf7b5d69e4c25995b3211b91b27f33b6}{ASSERT}}(magic == \mbox{\hyperlink{multiboot_8h_a18088e9abdbc843745e5e59973481475}{MULTIBOOT2\_BOOTLOADER\_MAGIC}}, \textcolor{stringliteral}{"Multiboot2 Bootloader Not Detected"});}
\DoxyCodeLine{101 }
\DoxyCodeLine{102     \textcolor{comment}{// Make the multiboot header}}
\DoxyCodeLine{103     \mbox{\hyperlink{classMaxOS_1_1system_1_1Multiboot}{Multiboot}} multiboot(addr);}
\DoxyCodeLine{104     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"-\/= MaxOS booted =-\/\(\backslash\)n"});}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager}{InterruptManager}} interrupts;}
\DoxyCodeLine{107     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"-\/= IDT set up =-\/\(\backslash\)n"});}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     uint32\_t mbi\_size = *(uint32\_t *) (addr + MemoryManager::s\_higher\_half\_kernel\_offset);}
\DoxyCodeLine{110     \mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager}{PhysicalMemoryManager}} pmm(addr + mbi\_size, \&multiboot, (uint64\_t*)\mbox{\hyperlink{kernel_8cpp_a19f262860236e9c10064948f12f89636}{p4\_table}});}
\DoxyCodeLine{111     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"-\/= Physical Memory Manager set up =-\/\(\backslash\)n"});}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \mbox{\hyperlink{classMaxOS_1_1memory_1_1VirtualMemoryManager}{VirtualMemoryManager}} vmm(\textcolor{keyword}{true});}
\DoxyCodeLine{114     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"-\/= Virtual Memory Manager set up =-\/\(\backslash\)n"});}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{comment}{// Initialise the VESA Driver}}
\DoxyCodeLine{117     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoElectronicsStandardsAssociation}{VideoElectronicsStandardsAssociation}} vesa(multiboot.get\_framebuffer());}
\DoxyCodeLine{118     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoDriver}{VideoDriver}}* videoDriver = (\mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoDriver}{VideoDriver}}*)\&vesa;}
\DoxyCodeLine{119     videoDriver-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1video_1_1VideoDriver_ac067543429b5dc0cd408951a1d57a7f9}{set\_mode}}((\textcolor{keywordtype}{int})multiboot.get\_framebuffer()-\/>common.framebuffer\_width,}
\DoxyCodeLine{120                           (int)multiboot.get\_framebuffer()-\/>common.framebuffer\_height,}
\DoxyCodeLine{121                           (int)multiboot.get\_framebuffer()-\/>common.framebuffer\_bpp);}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{comment}{// Initialise the memory manager}}
\DoxyCodeLine{125     \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager}{MemoryManager}} memoryManager(\&vmm);}
\DoxyCodeLine{126     MemoryManager::s\_kernel\_memory\_manager = \&memoryManager;}
\DoxyCodeLine{127     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"-\/= Memory Manager set up =-\/\(\backslash\)n"});}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{comment}{// Initialise Console}}
\DoxyCodeLine{130     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1console_1_1VESABootConsole}{VESABootConsole}} console(\&vesa);}
\DoxyCodeLine{131     console.clear();}
\DoxyCodeLine{132     console.print\_logo();}
\DoxyCodeLine{133 }
\DoxyCodeLine{134     \textcolor{comment}{// Create a stream for the console}}
\DoxyCodeLine{135     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1console_1_1ConsoleArea}{ConsoleArea}} mainConsoleArea(\&console, 0, 0, console.width(), console.height(), \mbox{\hyperlink{namespaceMaxOS_1_1common_a163092be7d061323a91e03e6e8965da9ab62102734f62ebcaacfe43023d16fc22}{ConsoleColour::DarkGrey}}, \mbox{\hyperlink{namespaceMaxOS_1_1common_a163092be7d061323a91e03e6e8965da9a3fab4e904157b2e96be41a69c8ae0553}{ConsoleColour::Black}});}
\DoxyCodeLine{136     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1console_1_1ConsoleStream}{ConsoleStream}} cout(\&mainConsoleArea);}
\DoxyCodeLine{137     \mbox{\hyperlink{kernel_8cpp_a8a91cb8e583436630a67b65651fb043e}{active\_stream}} = \&cout;}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{comment}{// Header constants}}
\DoxyCodeLine{140     \textcolor{keyword}{const} \textcolor{keywordtype}{string} tick = (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"[ "} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a963caaa3cbd8256af316c9af89da311c}{FG\_Green}}] + \textcolor{stringliteral}{"OK"} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] + \textcolor{stringliteral}{" ]"};}
\DoxyCodeLine{141     \textcolor{keyword}{const} \textcolor{keywordtype}{string} boot\_title = \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}(\textcolor{stringliteral}{"Kernel Boot Sequence -\/ MaxOS v"}) + \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}(VERSION\_STRING) + \textcolor{stringliteral}{" [build "} + \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}(BUILD\_NUMBER) + \textcolor{stringliteral}{"]"};}
\DoxyCodeLine{142     \textcolor{keyword}{const} \textcolor{keywordtype}{int} boot\_width = boot\_title.\mbox{\hyperlink{classMaxOS_1_1String_acf733b9f4647d948a153dda31d5995a0}{length}}() + 20;}
\DoxyCodeLine{143     \textcolor{keyword}{const} \textcolor{keywordtype}{int} sub\_boot\_width = boot\_width;}
\DoxyCodeLine{144 }
\DoxyCodeLine{145     \textcolor{comment}{// Print helpers}}
\DoxyCodeLine{146     \textcolor{keywordtype}{string} out = \textcolor{stringliteral}{""};}
\DoxyCodeLine{147 \textcolor{preprocessor}{    \#define log(x) out = x; cout << out; cout << (string)" " * (sub\_boot\_width -\/ out.length() -\/ 6) << tick << "\(\backslash\)n";}}
\DoxyCodeLine{148 \textcolor{preprocessor}{    \#define header(x) cout << "\(\backslash\)n\(\backslash\)n" << ANSI\_COLOURS[FG\_White] << "[" << string(x).center(sub\_boot\_width -\/ 2) << "]\(\backslash\)n" << ANSI\_COLOURS[Reset];}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150     \textcolor{comment}{// Print the header}}
\DoxyCodeLine{151     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01aae63a86af0fe18addfa886254b94efcc}{FG\_Blue}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"="} * boot\_width << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{152     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a2feeb686125636b0feba237c0c12f65b}{FG\_Cyan}}] << boot\_title.\mbox{\hyperlink{classMaxOS_1_1String_ab282882421b9a427219f6bcb36dcb5b0}{center}}(boot\_width) << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{153     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01aae63a86af0fe18addfa886254b94efcc}{FG\_Blue}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"="} * boot\_width << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{154 }
\DoxyCodeLine{155     \textcolor{comment}{// Stuff done earlier}}
\DoxyCodeLine{156     \mbox{\hyperlink{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}{header}}(\textcolor{stringliteral}{"Initialising System Components"})}
\DoxyCodeLine{157     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Serial \mbox{\hyperlink{classMaxOS_1_1drivers_1_1console_1_1Console}{Console}}");}
\DoxyCodeLine{158     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Parsed \mbox{\hyperlink{classMaxOS_1_1system_1_1Multiboot}{Multiboot}}");}
\DoxyCodeLine{159     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Paging");}
\DoxyCodeLine{160     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Interrupt Manager");}
\DoxyCodeLine{161     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Physical Memory Manager");}
\DoxyCodeLine{162     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Virtual Memory Manager");}
\DoxyCodeLine{163     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Memory Manager (Kernel)");}
\DoxyCodeLine{164     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Video \mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}}");}
\DoxyCodeLine{165 }
\DoxyCodeLine{166     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler}{Scheduler}} scheduler(\&interrupts);}
\DoxyCodeLine{167     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler}{Scheduler}}");}
\DoxyCodeLine{168 }
\DoxyCodeLine{169     \mbox{\hyperlink{classMaxOS_1_1system_1_1SyscallManager}{SyscallManager}} syscalls(\&interrupts);}
\DoxyCodeLine{170     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up Syscalls");}
\DoxyCodeLine{171 }
\DoxyCodeLine{172     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverManager}{DriverManager}} driverManager;}
\DoxyCodeLine{173     \mbox{\hyperlink{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}{header}}("Initialising Hardware")}
\DoxyCodeLine{174 }
\DoxyCodeLine{175     \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedConfigurationAndPowerInterface}{AdvancedConfigurationAndPowerInterface}} acpi(\&multiboot);}
\DoxyCodeLine{176     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up ACPI");}
\DoxyCodeLine{177 }
\DoxyCodeLine{178     \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedProgrammableInterruptController}{AdvancedProgrammableInterruptController}} apic(\&acpi);}
\DoxyCodeLine{179     interrupts.set\_apic(apic.get\_local\_apic());}
\DoxyCodeLine{180     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}("Set Up APIC");}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 }
\DoxyCodeLine{183     \textcolor{comment}{// Keyboard}}
\DoxyCodeLine{184     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1peripherals_1_1KeyboardDriver}{KeyboardDriver}} keyboard(\&interrupts);}
\DoxyCodeLine{185     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1peripherals_1_1KeyboardInterpreterEN__US}{KeyboardInterpreterEN\_US}} keyboardInterpreter;}
\DoxyCodeLine{186     keyboard.connect\_input\_stream\_event\_handler(\&keyboardInterpreter);}
\DoxyCodeLine{187     driverManager.add\_driver(\&keyboard);}
\DoxyCodeLine{188     \mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect}{interrupt\_redirect\_t}} keyboardRedirect = \{}
\DoxyCodeLine{189         .\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a76765f5aa84e5fb559be5ec37eb8d5d8}{type}} = 0x1,}
\DoxyCodeLine{190         .index = 0x12,}
\DoxyCodeLine{191         .interrupt = 0x21,}
\DoxyCodeLine{192         .destination = 0x00,}
\DoxyCodeLine{193         .flags = 0x00,}
\DoxyCodeLine{194         .mask = \textcolor{keyword}{false},}
\DoxyCodeLine{195     \};}
\DoxyCodeLine{196     apic.get\_io\_apic() -\/> set\_redirect(\&keyboardRedirect);}
\DoxyCodeLine{197     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(\textcolor{stringliteral}{"Set Up Keyboard"});}
\DoxyCodeLine{198 }
\DoxyCodeLine{199     \textcolor{comment}{// Mouse}}
\DoxyCodeLine{200     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1peripherals_1_1MouseDriver}{MouseDriver}} mouse(\&interrupts);}
\DoxyCodeLine{201     driverManager.add\_driver(\&mouse);}
\DoxyCodeLine{202     \mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect}{interrupt\_redirect\_t}} mouseRedirect = \{}
\DoxyCodeLine{203         .\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a76765f5aa84e5fb559be5ec37eb8d5d8}{type}} = 0xC,}
\DoxyCodeLine{204         .index = 0x28,}
\DoxyCodeLine{205         .interrupt = 0x2C,}
\DoxyCodeLine{206         .destination = 0x00,}
\DoxyCodeLine{207         .flags = 0x00,}
\DoxyCodeLine{208         .mask = \textcolor{keyword}{false},}
\DoxyCodeLine{209     \};}
\DoxyCodeLine{210     apic.get\_io\_apic() -\/> set\_redirect(\&mouseRedirect);}
\DoxyCodeLine{211     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(\textcolor{stringliteral}{"Set Up Mouse"});}
\DoxyCodeLine{212 }
\DoxyCodeLine{213     \textcolor{comment}{// CPU}}
\DoxyCodeLine{214     \mbox{\hyperlink{classMaxOS_1_1system_1_1CPU}{CPU}} cpu;}
\DoxyCodeLine{215     cpu.\mbox{\hyperlink{classMaxOS_1_1system_1_1CPU_a1227d972e880f4dcc6974172de28d6dd}{init\_tss}}();}
\DoxyCodeLine{216     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(\textcolor{stringliteral}{"Set Up CPU"});}
\DoxyCodeLine{217 }
\DoxyCodeLine{218     \textcolor{comment}{// Clock}}
\DoxyCodeLine{219     \mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}} kernelClock(\&interrupts, \&apic, 1);}
\DoxyCodeLine{220     driverManager.add\_driver(\&kernelClock);}
\DoxyCodeLine{221     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(\textcolor{stringliteral}{"Set Up Clock"});}
\DoxyCodeLine{222 }
\DoxyCodeLine{223     \textcolor{comment}{// Driver Selectors}}
\DoxyCodeLine{224     \mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{Vector<DriverSelector*>}} driverSelectors;}
\DoxyCodeLine{225 }
\DoxyCodeLine{226     \textcolor{comment}{//PCI}}
\DoxyCodeLine{227     \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}{PeripheralComponentInterconnectController}} PCIController;}
\DoxyCodeLine{228     driverSelectors.\mbox{\hyperlink{classMaxOS_1_1common_1_1Vector_ac753563317978358eb995f9eea7c1558}{push\_back}}(\&PCIController);}
\DoxyCodeLine{229     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(\textcolor{stringliteral}{"Set Up PCI"});}
\DoxyCodeLine{230 }
\DoxyCodeLine{231     \textcolor{comment}{//USB}}
\DoxyCodeLine{232     \textcolor{comment}{//UniversalSerialBusController USBController;}}
\DoxyCodeLine{233     \textcolor{comment}{//driverSelectors.push\_back(\&USBController);}}
\DoxyCodeLine{234     \textcolor{comment}{//log("Set Up USB");}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236     \mbox{\hyperlink{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}{header}}(\textcolor{stringliteral}{"Device Management"})}
\DoxyCodeLine{237 }
\DoxyCodeLine{238     \textcolor{comment}{// Find the drivers}}
\DoxyCodeLine{239     cout << "Finding Drivers" << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a84b22940d4cdc49b771c1b0cb12904ef}{FG\_White}}];}
\DoxyCodeLine{240     for(\mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{Vector}}<\mbox{\hyperlink{classMaxOS_1_1drivers_1_1DriverSelector}{DriverSelector}}*>::iterator selector = driverSelectors.begin(); selector != driverSelectors.\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcac5c891a2193a9343527cb202bb7346c2}{end}}(); selector++)}
\DoxyCodeLine{241     \{}
\DoxyCodeLine{242       cout << \textcolor{stringliteral}{"."};}
\DoxyCodeLine{243       (*selector)-\/>select\_drivers(\&driverManager, \&interrupts);}
\DoxyCodeLine{244     \}}
\DoxyCodeLine{245     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"."}*(boot\_width -\/ driverSelectors.\mbox{\hyperlink{classMaxOS_1_1common_1_1Vector_a26ab739162841be07b98088128ea4520}{size}}() -\/ 15 -\/ 9) << (\textcolor{keywordtype}{string})\textcolor{stringliteral}{"[ "} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a963caaa3cbd8256af316c9af89da311c}{FG\_Green}}] + \textcolor{stringliteral}{"FOUND"} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] + \textcolor{stringliteral}{" ]"} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{246 }
\DoxyCodeLine{247     \textcolor{comment}{// Resetting devices}}
\DoxyCodeLine{248     cout << \textcolor{stringliteral}{"Resetting Devices"} << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a84b22940d4cdc49b771c1b0cb12904ef}{FG\_White}}];}
\DoxyCodeLine{249     uint32\_t resetWaitTime = 0;}
\DoxyCodeLine{250     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{Vector<Driver*>::iterator}} driver = driverManager.drivers.begin(); driver != driverManager.drivers.end(); driver++)}
\DoxyCodeLine{251     \{}
\DoxyCodeLine{252       cout << \textcolor{stringliteral}{"."};}
\DoxyCodeLine{253       uint32\_t waitTime = (*driver)-\/>reset();}
\DoxyCodeLine{254 }
\DoxyCodeLine{255       \textcolor{comment}{// If the wait time is longer than the current longest wait time, set it as the new longest wait time}}
\DoxyCodeLine{256       \textcolor{keywordflow}{if}(waitTime > resetWaitTime)}
\DoxyCodeLine{257         resetWaitTime = waitTime;}
\DoxyCodeLine{258     \}}
\DoxyCodeLine{259     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"."}*(boot\_width -\/ driverManager.drivers.size() -\/ 17 -\/ 9) << (\textcolor{keywordtype}{string})\textcolor{stringliteral}{"[ "} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a963caaa3cbd8256af316c9af89da311c}{FG\_Green}}] + \textcolor{stringliteral}{"RESET"} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] + \textcolor{stringliteral}{" ]"} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{comment}{// Interrupts}}
\DoxyCodeLine{262     interrupts.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager_ab94a571ecb1d28fb72ffc14cb9840082}{activate}}();}
\DoxyCodeLine{263     \mbox{\hyperlink{kernel_8cpp_ae2af432da844bad9087b73802d11b4ee}{log}}(\textcolor{stringliteral}{"Activating Interrupts"});}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     \textcolor{comment}{// Post interrupt activation}}
\DoxyCodeLine{266     kernelClock.calibrate();}
\DoxyCodeLine{267     kernelClock.delay(resetWaitTime);}
\DoxyCodeLine{268     \mbox{\hyperlink{structMaxOS_1_1common_1_1Time}{Time}} now = kernelClock.get\_time();}
\DoxyCodeLine{269     cout << \textcolor{stringliteral}{"TIME: "} << now.\mbox{\hyperlink{structMaxOS_1_1common_1_1Time_af8f034e11fabae72d23f527b529ec897}{hour}} << \textcolor{stringliteral}{":"} << now.\mbox{\hyperlink{structMaxOS_1_1common_1_1Time_a0f93e01ba1b79fe42fb04ca8302bb01e}{minute}} << \textcolor{stringliteral}{":"} << now.\mbox{\hyperlink{structMaxOS_1_1common_1_1Time_a7868cdcabc0d92e9aa7e19379a730226}{second}} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{270 }
\DoxyCodeLine{271     \mbox{\hyperlink{kernel_8cpp_ae2a1cf80596e62d43dc14835ace90b6b}{header}}(\textcolor{stringliteral}{"Finalisation"})}
\DoxyCodeLine{272 }
\DoxyCodeLine{273     \textcolor{comment}{// Initialise the drivers}}
\DoxyCodeLine{274     cout <<  "Initialising Devices" << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a84b22940d4cdc49b771c1b0cb12904ef}{FG\_White}}];}
\DoxyCodeLine{275     for(\mbox{\hyperlink{classMaxOS_1_1common_1_1Vector}{Vector}}<\mbox{\hyperlink{classMaxOS_1_1drivers_1_1Driver}{Driver}}*>::iterator driver = driverManager.drivers.begin(); driver != driverManager.drivers.\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcac5c891a2193a9343527cb202bb7346c2}{end}}(); driver++)}
\DoxyCodeLine{276     \{}
\DoxyCodeLine{277       cout << \textcolor{stringliteral}{"."};}
\DoxyCodeLine{278       (*driver)-\/>initialise();}
\DoxyCodeLine{279     \}}
\DoxyCodeLine{280     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"."}*(boot\_width -\/ driverManager.drivers.size() -\/ 20 -\/ 15) << (\textcolor{keywordtype}{string})\textcolor{stringliteral}{"[ "} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a963caaa3cbd8256af316c9af89da311c}{FG\_Green}}] + \textcolor{stringliteral}{"INITIALISED"} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] + \textcolor{stringliteral}{" ]"} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{281 }
\DoxyCodeLine{282 }
\DoxyCodeLine{283     \textcolor{comment}{// activate the drivers}}
\DoxyCodeLine{284     cout << \textcolor{stringliteral}{"Activating Devices"} << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a84b22940d4cdc49b771c1b0cb12904ef}{FG\_White}}];}
\DoxyCodeLine{285     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{Vector<Driver*>::iterator}} driver = driverManager.drivers.begin(); driver != driverManager.drivers.end(); driver++)}
\DoxyCodeLine{286     \{}
\DoxyCodeLine{287       cout << \textcolor{stringliteral}{"."};}
\DoxyCodeLine{288       (*driver)-\/>activate();}
\DoxyCodeLine{289     \}}
\DoxyCodeLine{290     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"."}*(boot\_width -\/ driverManager.drivers.size() -\/ 18 -\/ 13) << (\textcolor{keywordtype}{string})\textcolor{stringliteral}{"[ "} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a963caaa3cbd8256af316c9af89da311c}{FG\_Green}}] + \textcolor{stringliteral}{"ACTIVATED"} + \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] + \textcolor{stringliteral}{" ]"} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{291 }
\DoxyCodeLine{292 }
\DoxyCodeLine{293     \textcolor{comment}{// Print the footer}}
\DoxyCodeLine{294     cout << \textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"};}
\DoxyCodeLine{295     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01aae63a86af0fe18addfa886254b94efcc}{FG\_Blue}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"-\/"} * boot\_width << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{296     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a2feeb686125636b0feba237c0c12f65b}{FG\_Cyan}}] << \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}(\textcolor{stringliteral}{" -\/-\/ Kernel Ready -\/-\/"}).\mbox{\hyperlink{classMaxOS_1_1String_ab282882421b9a427219f6bcb36dcb5b0}{center}}(boot\_width) << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{297     cout << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01aae63a86af0fe18addfa886254b94efcc}{FG\_Blue}}] << (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}})\textcolor{stringliteral}{"-\/"} * boot\_width << \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}] << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{298     cout.set\_cursor(0, console.height() -\/ 1);}
\DoxyCodeLine{299 }
\DoxyCodeLine{300     \textcolor{comment}{// Idle Process}}
\DoxyCodeLine{301     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}}* idle = \textcolor{keyword}{new} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}}(\textcolor{stringliteral}{"kernelMain Idle"}, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr},0, \textcolor{keyword}{true});}
\DoxyCodeLine{302     idle-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_af8482adefd92ca758c67a98a197444ea}{memory\_manager}} = \&memoryManager;}
\DoxyCodeLine{303     scheduler.add\_process(idle);}
\DoxyCodeLine{304     idle-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_ad8173b9cedf33f4f14536985edc5a509}{set\_pid}}(0);}
\DoxyCodeLine{305 }
\DoxyCodeLine{306     \textcolor{comment}{// Load executables}}
\DoxyCodeLine{307     scheduler.load\_multiboot\_elfs(\&multiboot);}
\DoxyCodeLine{308 }
\DoxyCodeLine{309     \textcolor{comment}{// Start the Scheduler \& updates the clock handler}}
\DoxyCodeLine{310     interrupts.\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1InterruptManager_abbcbff53fabcefe8b5f77e1750b69813}{set\_interrupt\_handler}}(0x20, \&scheduler);}
\DoxyCodeLine{311     scheduler.activate();}
\DoxyCodeLine{312 }
\DoxyCodeLine{313 }
\DoxyCodeLine{314     \textcolor{comment}{// TODO:}}
\DoxyCodeLine{315     \textcolor{comment}{//       -\/ Doxygen for classes \& structs, Fix some more errors/warnings, kernel more c++ support, clang tidy, remove statics where possible and use inline for setup, clean up main, all enums use enum class, update notes, public variables check up, includes fix up, old code review, types, const referencing, classes}}
\DoxyCodeLine{316     \textcolor{comment}{//       -\/ PCI to drivers page in osdev book, ubsan section maybe}}
\DoxyCodeLine{317 }
\DoxyCodeLine{318 }
\DoxyCodeLine{320     \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"\%h\%s[System Booted]\%s MaxOS v\%s\(\backslash\)n"}, \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a963caaa3cbd8256af316c9af89da311c}{FG\_Green}}], \mbox{\hyperlink{namespaceMaxOS_1_1common_a3364e04f094e16c00bed0dafa17c4b1c}{ANSI\_COLOURS}}[\mbox{\hyperlink{namespaceMaxOS_1_1common_ac660b07c00db1fe517a6f9ab5d1e5c01a6ef1cd5a9d3fa65e570b4125468d3427}{Reset}}], VERSION\_STRING);}
\DoxyCodeLine{321 }
\DoxyCodeLine{322 }
\DoxyCodeLine{332     \textcolor{keywordflow}{while} (\textcolor{keyword}{true})\{}
\DoxyCodeLine{333 }
\DoxyCodeLine{334       \textcolor{comment}{// Print the ticks (debuging)}}
\DoxyCodeLine{335       \textcolor{comment}{//\_kprintf("\%hTick: \%d\(\backslash\)r", scheduler.get\_ticks());}}
\DoxyCodeLine{336 }
\DoxyCodeLine{337       \textcolor{comment}{// yield ? wait until figured out the task manager cpu \%}}
\DoxyCodeLine{338 }
\DoxyCodeLine{339       \textcolor{comment}{// Make sure the compiler doesn't optimise the loop away}}
\DoxyCodeLine{340       \textcolor{keyword}{asm}(\textcolor{stringliteral}{"nop"});}
\DoxyCodeLine{341 }
\DoxyCodeLine{342     \}}
\DoxyCodeLine{343 \}}

\end{DoxyCode}


References \+\_\+kprintf, Max\+O\+S\+::processes\+::\+Scheduler\+::activate(), Max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Manager\+::activate(), active\+\_\+stream, Max\+O\+S\+::drivers\+::\+Driver\+Manager\+::add\+\_\+driver(), Max\+O\+S\+::processes\+::\+Scheduler\+::add\+\_\+process(), Max\+O\+S\+::common\+::\+A\+N\+S\+I\+\_\+\+C\+O\+L\+O\+U\+RS, A\+S\+S\+E\+RT, Max\+O\+S\+::common\+::\+Vector$<$ Type $>$\+::begin(), Max\+O\+S\+::common\+::\+Black, Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::calibrate(), Max\+O\+S\+::\+String\+::center(), Max\+O\+S\+::drivers\+::console\+::\+Console\+::clear(), multiboot\+\_\+tag\+\_\+framebuffer\+::common, Max\+O\+S\+::common\+::\+Generic\+Input\+Stream\+::connect\+\_\+input\+\_\+stream\+\_\+event\+\_\+handler(), Max\+O\+S\+::common\+::\+Dark\+Grey, Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::delay(), Max\+O\+S\+::drivers\+::\+Driver\+Manager\+::drivers, Max\+O\+S\+::common\+::\+Vector$<$ Type $>$\+::end(), Max\+O\+S\+::common\+::\+F\+G\+\_\+\+Blue, Max\+O\+S\+::common\+::\+F\+G\+\_\+\+Cyan, Max\+O\+S\+::common\+::\+F\+G\+\_\+\+Green, Max\+O\+S\+::common\+::\+F\+G\+\_\+\+White, multiboot\+\_\+tag\+\_\+framebuffer\+\_\+common\+::framebuffer\+\_\+bpp, multiboot\+\_\+tag\+\_\+framebuffer\+\_\+common\+::framebuffer\+\_\+height, multiboot\+\_\+tag\+\_\+framebuffer\+\_\+common\+::framebuffer\+\_\+width, Max\+O\+S\+::system\+::\+Multiboot\+::get\+\_\+framebuffer(), Max\+O\+S\+::hardwarecommunication\+::\+Advanced\+Programmable\+Interrupt\+Controller\+::get\+\_\+io\+\_\+apic(), Max\+O\+S\+::hardwarecommunication\+::\+Advanced\+Programmable\+Interrupt\+Controller\+::get\+\_\+local\+\_\+apic(), Max\+O\+S\+::drivers\+::clock\+::\+Clock\+::get\+\_\+time(), header, Max\+O\+S\+::drivers\+::console\+::\+V\+E\+S\+A\+Boot\+Console\+::height(), Max\+O\+S\+::common\+::\+Time\+::hour, Max\+O\+S\+::system\+::\+C\+P\+U\+::init\+\_\+tss(), Max\+O\+S\+::\+String\+::length(), Max\+O\+S\+::processes\+::\+Scheduler\+::load\+\_\+multiboot\+\_\+elfs(), log, Max\+O\+S\+::processes\+::\+Process\+::memory\+\_\+manager, Max\+O\+S\+::common\+::\+Time\+::minute, M\+U\+L\+T\+I\+B\+O\+O\+T2\+\_\+\+B\+O\+O\+T\+L\+O\+A\+D\+E\+R\+\_\+\+M\+A\+G\+IC, p4\+\_\+table, Max\+O\+S\+::drivers\+::console\+::\+V\+E\+S\+A\+Boot\+Console\+::print\+\_\+logo(), Max\+O\+S\+::common\+::\+Vector$<$ Type $>$\+::push\+\_\+back(), Max\+O\+S\+::common\+::\+Reset, Max\+O\+S\+::common\+::\+Time\+::second, Max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Manager\+::set\+\_\+apic(), Max\+O\+S\+::drivers\+::console\+::\+Console\+Stream\+::set\+\_\+cursor(), Max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Manager\+::set\+\_\+interrupt\+\_\+handler(), Max\+O\+S\+::drivers\+::video\+::\+Video\+Driver\+::set\+\_\+mode(), Max\+O\+S\+::processes\+::\+Process\+::set\+\_\+pid(), Max\+O\+S\+::common\+::\+Vector$<$ Type $>$\+::size(), Max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::type, and Max\+O\+S\+::drivers\+::console\+::\+V\+E\+S\+A\+Boot\+Console\+::width().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{kernel_8cpp_a19df960d2907e9c08a720ae7683e632c}\label{kernel_8cpp_a19df960d2907e9c08a720ae7683e632c}} 
\index{kernel.cpp@{kernel.cpp}!\_\_dso\_handle@{\_\_dso\_handle}}
\index{\_\_dso\_handle@{\_\_dso\_handle}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{\_\_dso\_handle}{\_\_dso\_handle}}
{\footnotesize\ttfamily void$\ast$ \+\_\+\+\_\+dso\+\_\+handle = nullptr}



Definition at line 76 of file kernel.\+cpp.

\mbox{\Hypertarget{kernel_8cpp_a8a91cb8e583436630a67b65651fb043e}\label{kernel_8cpp_a8a91cb8e583436630a67b65651fb043e}} 
\index{kernel.cpp@{kernel.cpp}!active\_stream@{active\_stream}}
\index{active\_stream@{active\_stream}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{active\_stream}{active\_stream}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1drivers_1_1console_1_1ConsoleStream}{Console\+Stream}}$\ast$ active\+\_\+stream = nullptr}



Definition at line 91 of file kernel.\+cpp.



Referenced by kernel\+Main().

\mbox{\Hypertarget{kernel_8cpp_affa4f606954d8d9a7edcb66df47b7f1d}\label{kernel_8cpp_affa4f606954d8d9a7edcb66df47b7f1d}} 
\index{kernel.cpp@{kernel.cpp}!end\_ctors@{end\_ctors}}
\index{end\_ctors@{end\_ctors}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{end\_ctors}{end\_ctors}}
{\footnotesize\ttfamily \mbox{\hyperlink{kernel_8cpp_a12d367671a45721e5f93f37959360759}{constructor}} end\+\_\+ctors}



Definition at line 84 of file kernel.\+cpp.



Referenced by call\+Constructors().

\mbox{\Hypertarget{kernel_8cpp_a19f262860236e9c10064948f12f89636}\label{kernel_8cpp_a19f262860236e9c10064948f12f89636}} 
\index{kernel.cpp@{kernel.cpp}!p4\_table@{p4\_table}}
\index{p4\_table@{p4\_table}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{p4\_table}{p4\_table}}
{\footnotesize\ttfamily volatile uint64\+\_\+t p4\+\_\+table\mbox{[}512\mbox{]}}



Referenced by kernel\+Main().

\mbox{\Hypertarget{kernel_8cpp_a00bc71da06b4a8e02a8587bf37dd984b}\label{kernel_8cpp_a00bc71da06b4a8e02a8587bf37dd984b}} 
\index{kernel.cpp@{kernel.cpp}!start\_ctors@{start\_ctors}}
\index{start\_ctors@{start\_ctors}!kernel.cpp@{kernel.cpp}}
\doxysubsubsection{\texorpdfstring{start\_ctors}{start\_ctors}}
{\footnotesize\ttfamily \mbox{\hyperlink{kernel_8cpp_a12d367671a45721e5f93f37959360759}{constructor}} start\+\_\+ctors}



Definition at line 83 of file kernel.\+cpp.



Referenced by call\+Constructors().

