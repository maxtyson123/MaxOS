\doxysection{Max\+OS\+::filesystem\+::format\+::Fat32\+File Class Reference}
\hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File}{}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File}\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}


Handles the file operations on the FAT32 filesystem.  




{\ttfamily \#include $<$fat32.\+h$>$}

Inheritance diagram for Max\+OS\+::filesystem\+::format\+::Fat32\+File\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classMaxOS_1_1filesystem_1_1format_1_1Fat32File}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_a5211e5c750a0cd115248ede7f3dd553b}{Fat32\+File}} (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume}{Fat32\+Volume}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{volume}}, \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Directory}{Fat32\+Directory}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dir\+\_\+entry\+\_\+t}} \texorpdfstring{$\ast$}{*}info, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \&\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ada67576556e0415df8bf213d0ce50991}{name}})
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aa3b3ffc295ed3b83388fc0bbeeb552d4}{\texorpdfstring{$\sim$}{\string~}\+Fat32\+File}} () final
\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_af63e21a0f74c08b0074259cea8c375f9}{write}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Write data to the file (at the current seek position, updated to be += amount) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_a82edeaaf7f5ff1654f34e5b2da809889}{read}} (\mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Read data from the file (at the current seek position, updated to be += amount) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aedf8ab18a47f703fb50ebfee7c116198}{flush}} () \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Flush the file to the disk. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aaaf4bb26323f73f610d2893886a912d3}{first\+\_\+cluster}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File}{Max\+OS\+::filesystem\+::\+File}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ae039af5807fc385f41b60644725d15d0}{File}} ()
\item 
virtual \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ac704ebdf5f57d7a1c5ddf409d797fb69}{\texorpdfstring{$\sim$}{\string~}\+File}} ()
\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_aa5315e6f1fdd27481ec88524041f2410}{seek}} (\mbox{\hyperlink{namespaceMaxOS_1_1filesystem_a873ee5a569a9920bf834c717148328c1}{Seek\+Type}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{seek\+\_\+type}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} offset)
\begin{DoxyCompactList}\small\item\em Seek to a position in the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_aae991c597c0bc4c5eb44c1f3b06a21ec}{position}} ()
\begin{DoxyCompactList}\small\item\em Get where the file is currently at (amount read/write/seeked) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a6797fd90178f476d319966e1fc6f501a}{size}} ()
\begin{DoxyCompactList}\small\item\em Get the size of the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ada67576556e0415df8bf213d0ce50991}{name}} ()
\begin{DoxyCompactList}\small\item\em Get the name of the file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File}{Max\+OS\+::filesystem\+::\+File}}}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\+\_\+offset}}
\item 
\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a98335b9c813e11733b3b12a7b4fb9087}{m\+\_\+name}}
\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\+\_\+size}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles the file operations on the FAT32 filesystem. 

Definition at line \mbox{\hyperlink{fat32_8h_source_l00203}{203}} of file \mbox{\hyperlink{fat32_8h_source}{fat32.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_a5211e5c750a0cd115248ede7f3dd553b}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_a5211e5c750a0cd115248ede7f3dd553b} 
\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}!Fat32File@{Fat32File}}
\index{Fat32File@{Fat32File}!MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}
\doxysubsubsection{\texorpdfstring{Fat32File()}{Fat32File()}}
{\footnotesize\ttfamily Fat32\+File\+::\+Fat32\+File (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume}{Fat32\+Volume}} \texorpdfstring{$\ast$}{*}}]{volume,  }\item[{\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Directory}{Fat32\+Directory}} \texorpdfstring{$\ast$}{*}}]{parent,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dir\+\_\+entry\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{info,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \&}]{name }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{fat32_8cpp_source_l00222}{222}} of file \mbox{\hyperlink{fat32_8cpp_source}{fat32.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00223\ :\ m\_volume(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{volume}}),}
\DoxyCodeLine{00224\ \ \ m\_parent\_directory(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}}),}
\DoxyCodeLine{00225\ \ \ m\_entry(info),}
\DoxyCodeLine{00226\ \ \ m\_first\_cluster((info-\/>first\_cluster\_high\ <<\ 16)\ |\ info-\/>first\_cluster\_low)}
\DoxyCodeLine{00227\ \{}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a98335b9c813e11733b3b12a7b4fb9087}{m\_name}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ada67576556e0415df8bf213d0ce50991}{name}};}
\DoxyCodeLine{00230\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}}\ =\ info-\/>size;}
\DoxyCodeLine{00231\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ =\ 0;}
\DoxyCodeLine{00232\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{filesystem_8h_source_l00033}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+name}}, \mbox{\hyperlink{filesystem_8h_source_l00032}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+offset}}, \mbox{\hyperlink{filesystem_8h_source_l00034}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+size}}, and \mbox{\hyperlink{filesystem_8cpp_source_l00078}{Max\+OS\+::filesystem\+::\+File\+::name()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aa3b3ffc295ed3b83388fc0bbeeb552d4}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aa3b3ffc295ed3b83388fc0bbeeb552d4} 
\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}!````~Fat32File@{\texorpdfstring{$\sim$}{\string~}Fat32File}}
\index{````~Fat32File@{\texorpdfstring{$\sim$}{\string~}Fat32File}!MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}Fat32File()}{\string~Fat32File()}}
{\footnotesize\ttfamily Fat32\+File\+::\texorpdfstring{$\sim$}{\string~}\+Fat32\+File (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [default]}}



\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aaaf4bb26323f73f610d2893886a912d3}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aaaf4bb26323f73f610d2893886a912d3} 
\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}!first\_cluster@{first\_cluster}}
\index{first\_cluster@{first\_cluster}!MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}
\doxysubsubsection{\texorpdfstring{first\_cluster()}{first\_cluster()}}
{\footnotesize\ttfamily uint32\+\_\+t Max\+OS\+::filesystem\+::format\+::\+Fat32\+File\+::first\+\_\+cluster (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{fat32_8h_source_l00221}{221}} of file \mbox{\hyperlink{fat32_8h_source}{fat32.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00221\ \{\ \textcolor{keywordflow}{return}\ m\_first\_cluster;\ \}}

\end{DoxyCode}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aedf8ab18a47f703fb50ebfee7c116198}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_aedf8ab18a47f703fb50ebfee7c116198} 
\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}!flush@{flush}}
\index{flush@{flush}!MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}
\doxysubsubsection{\texorpdfstring{flush()}{flush()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Fat32\+File\+::flush (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Flush the file to the disk. 



Reimplemented from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_af87fa862de707575b8badd044a5af80e}{Max\+OS\+::filesystem\+::\+File}}.



Definition at line \mbox{\hyperlink{fat32_8cpp_source_l00395}{395}} of file \mbox{\hyperlink{fat32_8cpp_source}{fat32.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00396\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_af87fa862de707575b8badd044a5af80e}{File::flush}}();}
\DoxyCodeLine{00397\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{filesystem_8cpp_source_l00037}{Max\+OS\+::filesystem\+::\+File\+::flush()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_a82edeaaf7f5ff1654f34e5b2da809889}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_a82edeaaf7f5ff1654f34e5b2da809889} 
\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}!read@{read}}
\index{read@{read}!MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}
\doxysubsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Fat32\+File\+::read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}}}]{amount }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Read data from the file (at the current seek position, updated to be += amount) 


\begin{DoxyParams}{Parameters}
{\em data} & The byte buffer to read into \\
\hline
{\em amount} & The amount of data to read \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a3385ab264cdca0faed533b17d701bab4}{Max\+OS\+::filesystem\+::\+File}}.



Definition at line \mbox{\hyperlink{fat32_8cpp_source_l00343}{343}} of file \mbox{\hyperlink{fat32_8cpp_source}{fat32.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.bytes\_per\_sector\ *\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;}
\DoxyCodeLine{00345\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ buffer(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}});}
\DoxyCodeLine{00346\ \ \ \ \ buffer.clear();}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ =\ 0;}
\DoxyCodeLine{00349\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_read}}\ =\ 0;}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ file}}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ =\ m\_first\_cluster;}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ !=\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}})\ \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_1_1format_a21e185e98587cd02f56fcd5b93cafe64acf542699ffaa1a09c5b27c0f72cd3f6f}{ClusterState::END\_OF\_CHAIN}};\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_ae41ed06c929a596714cf3e0906647986}{next\_cluster}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}))\ \{}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ clusters\ before\ the\ offset}}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}})\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}})\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}};}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ each\ sector\ in\ the\ cluster}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_af466a9d32fd2bf17acb2efa91031ded0}{lba\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_aba48c72b1770313b4b4a9a01af962008}{data\_lba}}\ +\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ -\/\ 2)\ *\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ =\ 0;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ <\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}++)}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a5d5ea78e0213ece71259dc171b3bd239}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a9fa1c1952cece4f322ba0f2552f16c24}{read}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}},\ \&buffer,\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.bytes\_per\_sector);}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ buffer.set\_offset(0);}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ offset\ is\ in\ the\ middle\ of\ the\ cluster}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}}\ =\ 0;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ >\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}})}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}};}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ how\ many\ bytes\ are\ being\ copied\ (read\ from\ cluster\ at\ offset?\ or\ read\ part\ of\ cluster?)}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster\_remaining\_bytes}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}};}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_remaining\_bytes}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_read}};}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster\_remaining\_bytes}}\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_remaining\_bytes}})\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster\_remaining\_bytes}}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_remaining\_bytes}};}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ >\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}})\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ the\ data}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ buffer.copy\_from(\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_read}});}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_read}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}};}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Dont\ read\ more\ than\ needed}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_read}}\ >=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00387\ \ \ \ \ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_read}};}
\DoxyCodeLine{00390\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fat32_8h_source_l00172}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::bpb}}, \mbox{\hyperlink{buffer_8cpp_source_l00061}{Max\+OS\+::common\+::\+Buffer\+::clear()}}, \mbox{\hyperlink{buffer_8cpp_source_l00186}{Max\+OS\+::common\+::\+Buffer\+::copy\+\_\+from()}}, \mbox{\hyperlink{icmp_8h_source_l00004}{data}}, \mbox{\hyperlink{fat32_8h_source_l00180}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::data\+\_\+lba}}, \mbox{\hyperlink{fat32_8h_source_l00183}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::disk}}, \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_1_1format_a21e185e98587cd02f56fcd5b93cafe64acf542699ffaa1a09c5b27c0f72cd3f6f}{Max\+OS\+::filesystem\+::format\+::\+END\+\_\+\+OF\+\_\+\+CHAIN}}, \mbox{\hyperlink{filesystem_8h_source_l00032}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+offset}}, \mbox{\hyperlink{fat32_8cpp_source_l00053}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::next\+\_\+cluster()}}, \mbox{\hyperlink{disk_8cpp_source_l00022}{Max\+OS\+::drivers\+::disk\+::\+Disk\+::read()}}, and \mbox{\hyperlink{buffer_8cpp_source_l00121}{Max\+OS\+::common\+::\+Buffer\+::set\+\_\+offset()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_af63e21a0f74c08b0074259cea8c375f9}\label{classMaxOS_1_1filesystem_1_1format_1_1Fat32File_af63e21a0f74c08b0074259cea8c375f9} 
\index{MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}!write@{write}}
\index{write@{write}!MaxOS::filesystem::format::Fat32File@{MaxOS::filesystem::format::Fat32File}}
\doxysubsubsection{\texorpdfstring{write()}{write()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Fat32\+File\+::write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}}}]{amount }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Write data to the file (at the current seek position, updated to be += amount) 


\begin{DoxyParams}{Parameters}
{\em data} & The byte buffer to write \\
\hline
{\em amount} & The amount of data to write \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_acf705eb008519880b9a9d5db150eb6c8}{Max\+OS\+::filesystem\+::\+File}}.



Definition at line \mbox{\hyperlink{fat32_8cpp_source_l00242}{242}} of file \mbox{\hyperlink{fat32_8cpp_source}{fat32.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.bytes\_per\_sector\ *\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;}
\DoxyCodeLine{00245\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ buffer(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}});}
\DoxyCodeLine{00246\ \ \ \ \ buffer.clear();}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ =\ 0;}
\DoxyCodeLine{00249\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}}\ =\ 0;}
\DoxyCodeLine{00250\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{last}}\ =\ m\_first\_cluster;}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ file}}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{last}};}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ !=\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}})\ \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_1_1format_a21e185e98587cd02f56fcd5b93cafe64acf542699ffaa1a09c5b27c0f72cd3f6f}{ClusterState::END\_OF\_CHAIN}};\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_ae41ed06c929a596714cf3e0906647986}{next\_cluster}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}))\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{last}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}};}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ cluster\ to\ read\ from\ (blank\ file)}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ ==\ 0)}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ clusters\ before\ the\ offset}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}})\ <\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}})\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}};}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ each\ sector\ in\ the\ cluster\ (prevent\ overwriting\ the\ data)}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_af466a9d32fd2bf17acb2efa91031ded0}{lba\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_aba48c72b1770313b4b4a9a01af962008}{data\_lba}}\ +\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster}}\ -\/\ 2)\ *\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ =\ 0;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ <\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}++)}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a5d5ea78e0213ece71259dc171b3bd239}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a9fa1c1952cece4f322ba0f2552f16c24}{read}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}},\ \&buffer,\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.bytes\_per\_sector);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ buffer.set\_offset(0);}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ offset\ is\ in\ the\ middle\ of\ the\ cluster}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}}\ =\ 0;}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ >\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}})}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}};}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ how\ many\ bytes\ are\ being\ copied\ (read\ from\ cluster\ at\ offset?}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ or\ read\ part\ of\ cluster?)}}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster\_remaining\_bytes}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}};}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_remaining\_bytes}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}};}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster\_remaining\_bytes}}\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_remaining\_bytes}})\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{cluster\_remaining\_bytes}}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_remaining\_bytes}};}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ >\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}})\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ data}}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ buffer.copy\_from(\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_offset}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}});}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ buffer.set\_offset(0);}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ the\ data\ back\ to\ the\ disk}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ =\ 0;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ <\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}++)}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a5d5ea78e0213ece71259dc171b3bd239}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a307fc8dc97cc4c8f3668a18a1e0257de}{write}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}},\ \&buffer,\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.bytes\_per\_sector);}
\DoxyCodeLine{00295\ \ \ \ \ \}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{comment}{//\ Extend\ the\ file}}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}}\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})\ \{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Allocate\ a\ new\ cluster}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{new\_cluster}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a2ad6d0cd23155bcee69a6c712edd3d5e}{allocate\_cluster}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{last}});}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{new\_cluster}}\ ==\ 0)}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{last}}\ ==\ 0)}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ m\_first\_cluster\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{new\_cluster}};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ data}}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}})\ >\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_space}}\ :\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}});}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ buffer.copy\_from(\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}},\ 0,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}});}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_to\_copy}};}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ buffer.set\_offset(0);}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ the\ data\ back\ to\ the\ disk}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_af466a9d32fd2bf17acb2efa91031ded0}{lba\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_aba48c72b1770313b4b4a9a01af962008}{data\_lba}}\ +\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{new\_cluster}}\ -\/\ 2)\ *\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ =\ 0;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}\ <\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.sectors\_per\_cluster;\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}}++)}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a5d5ea78e0213ece71259dc171b3bd239}{disk}}-\/>\mbox{\hyperlink{classMaxOS_1_1drivers_1_1disk_1_1Disk_a307fc8dc97cc4c8f3668a18a1e0257de}{write}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lba}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sector}},\ \&buffer,\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Volume_a88fa8cf8322df1bc922905e66d5569f4}{bpb}}.bytes\_per\_sector);}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Go\ to\ the\ next\ cluster}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{last}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{new\_cluster}};}
\DoxyCodeLine{00321\ \ \ \ \ \}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{comment}{//\ Update\ file\ size}}
\DoxyCodeLine{00324\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bytes\_written}};}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ >\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}})}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}};}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{comment}{//\ Update\ entry\ info}}
\DoxyCodeLine{00329\ \ \ \ \ m\_entry-\/>size\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}};}
\DoxyCodeLine{00330\ \ \ \ \ m\_entry-\/>first\_cluster\_high\ =\ (m\_first\_cluster\ >>\ 16)\ \&\ 0xFFFF;}
\DoxyCodeLine{00331\ \ \ \ \ m\_entry-\/>first\_cluster\_low\ =\ m\_first\_cluster\ \&\ 0xFFFF;}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{comment}{//\ TODO:\ When\ implemented\ as\ a\ usermode\ driver\ save\ the\ time}}
\DoxyCodeLine{00333\ \ \ \ \ m\_parent\_directory-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1Fat32Directory_af6a79f3a013a04d730d409bf317c2da4}{save\_entry\_to\_disk}}(m\_entry);}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fat32_8cpp_source_l00129}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::allocate\+\_\+cluster()}}, \mbox{\hyperlink{fat32_8h_source_l00172}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::bpb}}, \mbox{\hyperlink{buffer_8cpp_source_l00061}{Max\+OS\+::common\+::\+Buffer\+::clear()}}, \mbox{\hyperlink{buffer_8cpp_source_l00186}{Max\+OS\+::common\+::\+Buffer\+::copy\+\_\+from()}}, \mbox{\hyperlink{icmp_8h_source_l00004}{data}}, \mbox{\hyperlink{fat32_8h_source_l00180}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::data\+\_\+lba}}, \mbox{\hyperlink{fat32_8h_source_l00183}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::disk}}, \mbox{\hyperlink{namespaceMaxOS_1_1filesystem_1_1format_a21e185e98587cd02f56fcd5b93cafe64acf542699ffaa1a09c5b27c0f72cd3f6f}{Max\+OS\+::filesystem\+::format\+::\+END\+\_\+\+OF\+\_\+\+CHAIN}}, \mbox{\hyperlink{filesystem_8h_source_l00032}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+offset}}, \mbox{\hyperlink{filesystem_8h_source_l00034}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+size}}, \mbox{\hyperlink{fat32_8cpp_source_l00053}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Volume\+::next\+\_\+cluster()}}, \mbox{\hyperlink{disk_8cpp_source_l00022}{Max\+OS\+::drivers\+::disk\+::\+Disk\+::read()}}, \mbox{\hyperlink{fat32_8cpp_source_l00566}{Max\+OS\+::filesystem\+::format\+::\+Fat32\+Directory\+::save\+\_\+entry\+\_\+to\+\_\+disk()}}, \mbox{\hyperlink{buffer_8cpp_source_l00121}{Max\+OS\+::common\+::\+Buffer\+::set\+\_\+offset()}}, and \mbox{\hyperlink{disk_8cpp_source_l00040}{Max\+OS\+::drivers\+::disk\+::\+Disk\+::write()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/filesystem/format/\mbox{\hyperlink{fat32_8h}{fat32.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/filesystem/format/\mbox{\hyperlink{fat32_8cpp}{fat32.\+cpp}}\end{DoxyCompactItemize}
