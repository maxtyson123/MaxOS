\doxysection{ipv4.\+cpp}
\hypertarget{ipv4_8cpp_source}{}\label{ipv4_8cpp_source}\index{/home/runner/work/MaxOS/MaxOS/kernel/src/net/ipv4.cpp@{/home/runner/work/MaxOS/MaxOS/kernel/src/net/ipv4.cpp}}
\mbox{\hyperlink{ipv4_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ipv4_8h}{net/ipv4.h}}>}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00011}00011\ \textcolor{keyword}{using\ namespace\ }MaxOS;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00012}00012\ \textcolor{keyword}{using\ namespace\ }MaxOS::common;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00013}00013\ \textcolor{keyword}{using\ namespace\ }MaxOS::net;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00014}00014\ \textcolor{keyword}{using\ namespace\ }MaxOS::memory;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00015}00015\ \textcolor{keyword}{using\ namespace\ }MaxOS::drivers;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00016}00016\ \textcolor{keyword}{using\ namespace\ }MaxOS::drivers::ethernet;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00022}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a7f1699ce0212b8e1a0c6e1798832220f}{00022}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a7f1699ce0212b8e1a0c6e1798832220f}{IPV4AddressResolver::IPV4AddressResolver}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{InternetProtocolHandler}}\ *internetProtocolHandler)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00023}00023\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00025}00025\ \ \ \ \ internetProtocolHandler\ -\/>\ RegisterIPV4AddressResolver(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00027}00027\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00031}00031\ IPV4AddressResolver::\string~IPV4AddressResolver()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00038}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a788d824dc4bb0f42b97043e6b7cb0607}{00038}}\ MediaAccessControlAddress\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a788d824dc4bb0f42b97043e6b7cb0607}{IPV4AddressResolver::Resolve}}(InternetProtocolAddress)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{return}\ 0xFFFFFFFFFFFF;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00040}00040\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00048}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a5cc0d3c0785d94dce17057efd9e8e8e3}{00048}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a5cc0d3c0785d94dce17057efd9e8e8e3}{IPV4AddressResolver::Store}}(InternetProtocolAddress,\ MediaAccessControlAddress)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00050}00050\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00054}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a6f97d3a5c8213e1869754cff7c92ab82}{00054}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a6f97d3a5c8213e1869754cff7c92ab82}{IPV4PayloadHandler::IPV4PayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{InternetProtocolHandler}}*\ internetProtocolHandler,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00056}00056\ \ \ \ \ \textcolor{comment}{//\ Store\ vars}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00057}00057\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2b80f1e0d750928b8d49fdaa71949bc8}{internetProtocolHandler}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2b80f1e0d750928b8d49fdaa71949bc8}{internetProtocolHandler}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00058}00058\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_ab1eaa4092632033c05e5f8b22e7f5fc3}{ipProtocol}}\ =\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00060}00060\ \ \ \ \ \textcolor{comment}{//Register\ handler}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00061}00061\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2b80f1e0d750928b8d49fdaa71949bc8}{internetProtocolHandler}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae912712622f50ac2a0d31c6781849ccb}{connectIPV4PayloadHandler}}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00063}00063\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00065}00065\ IPV4PayloadHandler::\string~IPV4PayloadHandler()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00076}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a7463073902bdd6f754805a99bba9a000}{00076}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a7463073902bdd6f754805a99bba9a000}{IPV4PayloadHandler::handleInternetProtocolPayload}}(net::InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{srcIP\_BE}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ net::InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ *\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{internetprotocolPayload}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00081}00081\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00090}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_ab9c9b54a757481840ffa8701ea8265af}{00090}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_ab9c9b54a757481840ffa8701ea8265af}{IPV4PayloadHandler::Send}}(InternetProtocolAddress\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payloadData}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00093}00093\ \ \ \ \ \textcolor{comment}{//Pass\ to\ backend}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00094}00094\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2b80f1e0d750928b8d49fdaa71949bc8}{internetProtocolHandler}}\ -\/>\ sendInternetProtocolPacket(\mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}},\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_ab1eaa4092632033c05e5f8b22e7f5fc3}{ipProtocol}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payloadData}},\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00096}00096\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00107}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae6157a2dba220eb761e339dffec52653}{00107}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae6157a2dba220eb761e339dffec52653}{InternetProtocolHandler::InternetProtocolHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFrameHandler}{EthernetFrameHandler}}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{backend}},\ InternetProtocolAddress\ ownInternetProtocolAddress,\ InternetProtocolAddress\ defaultGatewayInternetProtocolAddress,\ SubnetMask\ subnetMask,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{OutputStream}}*\ errorMessages)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00108}00108\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler}{EthernetFramePayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{backend}},\ 0x0800)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00109}00109\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00110}00110\ \ \ \ \ \textcolor{comment}{//Store\ vars}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00111}00111\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00112}00112\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aedf2d70f9d2b9ff838e31917b093499f}{defaultGatewayInternetProtocolAddress}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aedf2d70f9d2b9ff838e31917b093499f}{defaultGatewayInternetProtocolAddress}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00113}00113\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00114}00114\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00115}00115\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00117}00117\ InternetProtocolHandler::\string~InternetProtocolHandler()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00128}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ad3d1bb7473fe8b1c77a25ed14316d4b6}{00128}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ad3d1bb7473fe8b1c77a25ed14316d4b6}{InternetProtocolHandler::handleEthernetframePayload}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframePayload}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00130}00130\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"{}IP:\ Handling\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00132}00132\ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ size\ is\ big\ enough\ to\ contain\ an\ ethernet\ frame}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00133}00133\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}\ <\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}))}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00136}00136\ \ \ \ \ \textcolor{comment}{//Convert\ to\ struct\ for\ easier\ use}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00137}00137\ \ \ \ \ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframePayload}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00138}00138\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00140}00140\ \ \ \ \ \textcolor{comment}{//Only\ handle\ if\ it\ is\ for\ this\ device}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00141}00141\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}}\ ==\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{GetInternetProtocolAddress}}())}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00142}00142\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ length\ of\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ >\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ length\ is\ bigger\ than\ the\ size\ of\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ =\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ so,\ set\ length\ to\ size\ (this\ stops\ heartbleed\ attacks\ as\ it\ will\ not\ read\ past\ the\ end\ of\ the\ message,\ which\ the\ attacker\ could\ have\ filled\ with\ data)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ handler\ for\ the\ protocol}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00148}00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Pair}{Map<uint8\_t,\ IPV4PayloadHandler*>::iterator}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handlerIterator}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af250ac9a1c0a0cb1ad9db7f2f750d588}{IPV4PayloadHandlers}}.find(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handlerIterator}}\ !=\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af250ac9a1c0a0cb1ad9db7f2f750d588}{IPV4PayloadHandlers}}.end())\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handlerIterator}}\ -\/>\ second;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ -\/>\ handleInternetProtocolPayload(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframePayload}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}),\ \mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}));}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00154}00154\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00157}00157\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00159}00159\ \ \ \ \ \textcolor{comment}{//If\ the\ data\ is\ to\ be\ sent\ back\ again}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00160}00160\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}})\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Swap\ source\ and\ destination}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00163}00163\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Store\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00164}00164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ destination\ IP\ to\ source\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00165}00165\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ source\ IP\ to\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00167}00167\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a1c954c79d7e772d87d708498a586f206}{timeToLive}}\ =\ 0x40;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Reset\ TTL}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00168}00168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{intel__i217_8h_a59eac9627282a484fbaf0aa7aa3b8a9a}{checksum}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{Checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}},\ 4\ *\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_abf2b1d816d4e2e459b2ed1bda26cb904}{headerLength}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Reset\ checksum\ as\ the\ source\ and\ destination\ IP\ have\ changed\ so\ has\ the\ time\ to\ live\ and\ therefore\ there\ is\ a\ different\ header}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00170}00170\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00172}00172\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"{}IP:\ Handled\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00173}00173\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00174}00174\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00185}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a55f21552e4dcf3b2256e24f97db84142}{00185}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a55f21552e4dcf3b2256e24f97db84142}{InternetProtocolHandler::sendInternetProtocolPacket}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ *\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00186}00186\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00187}00187\ \ \ \ \ \textcolor{keyword}{auto}*\ buffer\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*)\mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a983c849ff604367f7c8a0e70172bb331}{MemoryManager::kmalloc}}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}})\ +\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Allocate\ memory\ for\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00188}00188\ \ \ \ \ \textcolor{keyword}{auto}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}*)buffer;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Convert\ to\ struct\ for\ easier\ use}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00190}00190\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_ab22abc2906422da61885ac6c8e6a1a59}{version}}\ =\ 4;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ version}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00191}00191\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_abf2b1d816d4e2e459b2ed1bda26cb904}{headerLength}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}})/4;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ header\ length}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00192}00192\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_ab0548e81efcf280a5ae280858e578cde}{typeOfService}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ type\ of\ service\ (not\ private)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00194}00194\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ =\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ total\ length}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00195}00195\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ =\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ \&\ 0xFF00)\ >>\ 8)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ big\ endian\ (Swap\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ \&\ 0x00FF)\ <<\ 8);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ big\ endian\ (Swap\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00198}00198\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a5868ad3e30cea561af39afae3efa4a7a}{identifier}}\ =\ 0x100;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ identification\ TODO:\ do\ properly}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00199}00199\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_ae5fbba8e197a2e68174867191be7ddac}{flagsAndOffset}}\ =\ 0x0040;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ flags/offset,\ 0x40\ because\ we\ are\ not\ fragmenting\ (TODO:\ doesnt\ work\ for\ packets\ bigger\ than\ 1500\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00201}00201\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a1c954c79d7e772d87d708498a586f206}{timeToLive}}\ =\ 0x40;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ time\ to\ live}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00202}00202\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}}\ =\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ protocol}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00203}00203\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00204}00204\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00205}00205\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{GetInternetProtocolAddress}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ source\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00207}00207\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{intel__i217_8h_a59eac9627282a484fbaf0aa7aa3b8a9a}{checksum}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ checksum\ to\ 0,\ init\ with\ 0\ as\ checksum\ funct\ will\ also\ add\ this\ value}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00208}00208\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{intel__i217_8h_a59eac9627282a484fbaf0aa7aa3b8a9a}{checksum}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{Checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}));\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Calculate\ checksum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00210}00210\ \ \ \ \ \textcolor{comment}{//Copy\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00211}00211\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_buffer}}\ =\ buffer\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ pointer\ to\ the\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00212}00212\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}};\ i++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ through\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00213}00213\ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_buffer}}[i]\ =\ \mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}[i];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Copy\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00215}00215\ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ destination\ is\ on\ the\ same\ subnet,\ The\ if\ condition\ determines\ if\ the\ destination\ device\ is\ on\ the\ same\ Local\ network\ as\ the\ source\ device\ .\ and\ if\ they\ are\ not\ on\ the\ same\ local\ network\ then\ we\ resolve\ the\ ip\ address\ of\ the\ gateway\ .}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00216}00216\ \ \ \ \ InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ route\ to\ destination\ IP\ by\ default}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00217}00217\ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}}\ \&\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}})\ !=\ (\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}}\ \&\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}}))\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ destination\ is\ on\ the\ same\ subnet}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00218}00218\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aedf2d70f9d2b9ff838e31917b093499f}{defaultGatewayInternetProtocolAddress}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ not,\ set\ route\ to\ gateway\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Print\ debug\ info}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00220}00220\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MAC}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5a1696bf5e661719d4d65b42736717f9}{resolver}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a788d824dc4bb0f42b97043e6b7cb0607}{Resolve}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00222}00222\ \ \ \ \ \textcolor{comment}{//Send\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00223}00223\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_ac54f71ce7d512ba22a6f3306ad459a70}{frameHandler}}\ -\/>\ sendEthernetFrame(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MAC}},\ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_a902f9382cf1085858a123e304550ad80}{handledType}},\ buffer,\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}));\ \ \ \ \ \ \textcolor{comment}{//Send\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00224}00224\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_abaa5e54c1428654efa1c81b69e12eb20}{MemoryManager::kfree}}(buffer);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Free\ memory}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00225}00225\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00234}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{00234}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{InternetProtocolHandler::Checksum}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}\ *\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00235}00235\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00236}00236\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Init\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00237}00237\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00238}00238\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}}/2;\ i++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ through\ data\ (/2\ bc\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00239}00239\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ +=\ ((\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}[i]\ \&\ 0xFF00)\ >>\ 8)\ |\ ((\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}[i]\ \&\ 0x00FF)\ <<\ 8);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ data\ to\ sum\ in\ big\ endian}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00240}00240\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00241}00241\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}}\ \%\ 2)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ there\ is\ an\ odd\ number\ of\ bytes}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00242}00242\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ +=\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}})((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}})[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}}-\/1])\ <<\ 8;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ the\ last\ byte\ to\ the\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00243}00243\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00244}00244\ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFFFF0000)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//While\ there\ is\ a\ carry}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00245}00245\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFFFF)\ +\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ >>\ 16);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ the\ carry\ to\ the\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00246}00246\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00247}00247\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\string~\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFF00)\ >>\ 8)\ |\ ((\string~\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0x00FF)\ <<\ 8);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00248}00248\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00255}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a90fee0461e08b49e85dfc8fc3c617fd2}{00255}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a90fee0461e08b49e85dfc8fc3c617fd2}{InternetProtocolHandler::RegisterIPV4AddressResolver}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver}{IPV4AddressResolver}}\ *resolver)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00256}00256\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00257}00257\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5a1696bf5e661719d4d65b42736717f9}{resolver}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5a1696bf5e661719d4d65b42736717f9}{resolver}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00258}00258\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00259}00259\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00271}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{00271}}\ InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{InternetProtocolHandler::CreateInternetProtocolAddress}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00272}00272\ \ \ \ \ InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00273}00273\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00274}00274\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00275}00275\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00276}00276\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00277}00277\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00285}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_afe355c241075103457e041325d9b86c0}{00285}}\ InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_afe355c241075103457e041325d9b86c0}{InternetProtocolHandler::Parse}}(\textcolor{keywordtype}{string}\ address)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00286}00286\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[4];}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00287}00287\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00288}00288\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00289}00289\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit}}\ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}})}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00290}00290\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00291}00291\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00292}00292\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ address.length();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00293}00293\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(address[i]\ ==\ \textcolor{charliteral}{'.'})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}++;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00296}00296\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00297}00297\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00298}00298\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}]\ *=\ 10;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00299}00299\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}]\ +=\ address[i]\ -\/\ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00300}00300\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00302}00302\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{CreateInternetProtocolAddress}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[0],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[1],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[2],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[3]);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00303}00303\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00304}00304\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00315}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a381d0d9daecb7fd7118125cb1e083cd4}{00315}}\ SubnetMask\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a381d0d9daecb7fd7118125cb1e083cd4}{InternetProtocolHandler::CreateSubnetMask}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00316}00316\ \ \ \ \ \textcolor{keywordflow}{return}\ (SubnetMask)\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{CreateInternetProtocolAddress}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00317}00317\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00318}00318\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00324}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{00324}}\ InternetProtocolAddress\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{InternetProtocolHandler::GetInternetProtocolAddress}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00325}00325\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00326}00326\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00333}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a19e57b1275f830876149c174d7cba632}{00333}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MediaAccessControlAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a19e57b1275f830876149c174d7cba632}{InternetProtocolHandler::GetMediaAccessControlAddress}}()\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00334}00334\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_ac54f71ce7d512ba22a6f3306ad459a70}{frameHandler}}\ -\/>\ getMAC();}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00335}00335\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00336}00336\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00342}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae912712622f50ac2a0d31c6781849ccb}{00342}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae912712622f50ac2a0d31c6781849ccb}{InternetProtocolHandler::connectIPV4PayloadHandler}}(\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}}\ *\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00343}00343\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af250ac9a1c0a0cb1ad9db7f2f750d588}{IPV4PayloadHandlers}}.insert(\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}}\ -\/>\ ipProtocol,\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00344}00344\ \}}

\end{DoxyCode}
