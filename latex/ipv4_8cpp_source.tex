\doxysection{ipv4.\+cpp}
\hypertarget{ipv4_8cpp_source}{}\label{ipv4_8cpp_source}\index{/home/runner/work/MaxOS/MaxOS/kernel/src/net/ipv4.cpp@{/home/runner/work/MaxOS/MaxOS/kernel/src/net/ipv4.cpp}}
\mbox{\hyperlink{ipv4_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ipv4_8h}{net/ipv4.h}}>}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00011}00011\ \textcolor{keyword}{using\ namespace\ }MaxOS;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00012}00012\ \textcolor{keyword}{using\ namespace\ }MaxOS::common;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00013}00013\ \textcolor{keyword}{using\ namespace\ }MaxOS::net;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00014}00014\ \textcolor{keyword}{using\ namespace\ }MaxOS::memory;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00015}00015\ \textcolor{keyword}{using\ namespace\ }MaxOS::drivers;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00016}00016\ \textcolor{keyword}{using\ namespace\ }MaxOS::drivers::ethernet;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00022}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_ad89ee99bea8b397f9b7b8bd4c30e8d2f}{00022}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_ad89ee99bea8b397f9b7b8bd4c30e8d2f}{IPV4AddressResolver::IPV4AddressResolver}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{InternetProtocolHandler}}*\ internet\_protocol\_handler)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00024}00024\ \ \ \ \ internet\_protocol\_handler-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aefdf601418f4d5cb0365cda0cfb1c599}{register\_ipv\_4\_address\_resolver}}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00026}00026\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00029}00029\ IPV4AddressResolver::\string~IPV4AddressResolver()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00037}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_aeae6ed788ffdc7d369383407cd9d5dc3}{00037}}\ \mbox{\hyperlink{ethernet_8h_a65f54d2d9dfdb9eafd1affd62abe8d18}{MediaAccessControlAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_aeae6ed788ffdc7d369383407cd9d5dc3}{IPV4AddressResolver::resolve}}(\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ address)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00038}00038\ \ \ \ \ \textcolor{keywordflow}{return}\ 0xFFFFFFFFFFFF;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00039}00039\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00047}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a48f416a6fe380ac1c58dade131516fd9}{00047}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_a48f416a6fe380ac1c58dade131516fd9}{IPV4AddressResolver::store}}(\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{internet\_protocol\_address}},\ \mbox{\hyperlink{ethernet_8h_a65f54d2d9dfdb9eafd1affd62abe8d18}{MediaAccessControlAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{media\_access\_control\_address}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00049}00049\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00057}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_ab4e0d5a54a7b74e7e8c7b65950e79353}{00057}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_ab4e0d5a54a7b74e7e8c7b65950e79353}{IPV4PayloadHandler::IPV4PayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{InternetProtocolHandler}}*\ internet\_protocol\_handler,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ protocol)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00059}00059\ \ \ \ \ \textcolor{comment}{//\ Store\ vars}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00060}00060\ \ \ \ \ this-\/>internet\_protocol\_handler\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a8f837ba5e88224d46e5653239ffed050}{internet\_protocol\_handler}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00061}00061\ \ \ \ \ this-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a671810706f40888f86863523da6c58f0}{ip\_protocol}}\ =\ protocol;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00063}00063\ \ \ \ \ \textcolor{comment}{//Register\ handler}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00064}00064\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a8f837ba5e88224d46e5653239ffed050}{internet\_protocol\_handler}}-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a51098baf2f165b6ca0a2148a00d56f1f}{connect\_ipv\_4\_payload\_handler}}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00066}00066\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00068}00068\ IPV4PayloadHandler::\string~IPV4PayloadHandler()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00079}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a0a77f0da7508cabc239b0f7830ef03dc}{00079}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a0a77f0da7508cabc239b0f7830ef03dc}{IPV4PayloadHandler::handle\_internet\_protocol\_payload}}(\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{net::InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{src\_ip\_be}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{net::InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dst\_ip\_be}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{internetprotocol\_payload}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00083}00083\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00084}00084\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00093}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2bb888c9e34031fe53b58add430d604e}{00093}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2bb888c9e34031fe53b58add430d604e}{IPV4PayloadHandler::send}}(\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ destination\_ip,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payload\_data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00096}00096\ \ \ \ \ \textcolor{comment}{//Pass\ to\ backend}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00097}00097\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a8f837ba5e88224d46e5653239ffed050}{internet\_protocol\_handler}}-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a891608af68cd8d9dd9e5be5aac16f915}{send\_internet\_protocol\_packet}}(destination\_ip,\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a671810706f40888f86863523da6c58f0}{ip\_protocol}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payload\_data}},\ size);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00099}00099\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00110}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_afbc74662f833b7c1ec8a7481d01e9ff6}{00110}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_afbc74662f833b7c1ec8a7481d01e9ff6}{InternetProtocolHandler::InternetProtocolHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFrameHandler}{EthernetFrameHandler}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{backend}},\ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ own\_internet\_protocol\_address,\ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ default\_gateway\_internet\_protocol\_address,\ \mbox{\hyperlink{ipv4_8h_a675fed9f30ec224711b40893d3f784d6}{SubnetMask}}\ subnet\_mask,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{OutputStream}}*\ error\_messages)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00111}00111\ :\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler}{EthernetFramePayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{backend}},\ 0x0800)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00112}00112\ \ \ \ \ \textcolor{comment}{//Store\ vars}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00113}00113\ \ \ \ \ this-\/>own\_internet\_protocol\_address\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ab0c3a3204764ece751deff25ce41e6af}{own\_internet\_protocol\_address}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00114}00114\ \ \ \ \ this-\/>default\_gateway\_internet\_protocol\_address\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a728268d179dbd2501ba0d4a3fa0fb3ce}{default\_gateway\_internet\_protocol\_address}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00115}00115\ \ \ \ \ this-\/>subnet\_mask\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1279fccb2269273b5de40d7952d5eb42}{subnet\_mask}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00116}00116\ \ \ \ \ this-\/>error\_messages\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a17f06d1d1e87c15fa5896e420ab2cd38}{error\_messages}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00117}00117\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00119}00119\ InternetProtocolHandler::\string~InternetProtocolHandler()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00130}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a80b18cb44a1c9fae882d2a65cf9c576a}{00130}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a80b18cb44a1c9fae882d2a65cf9c576a}{InternetProtocolHandler::handle\_ethernetframe\_payload}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframe\_payload}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00132}00132\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a17f06d1d1e87c15fa5896e420ab2cd38}{error\_messages}}-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"{}IP:\ Handling\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00134}00134\ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ size\ is\ big\ enough\ to\ contain\ an\ ethernet\ frame}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00135}00135\ \ \ \ \ \textcolor{keywordflow}{if}(size\ <\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}))}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00138}00138\ \ \ \ \ \textcolor{comment}{//Convert\ to\ struct\ for\ easier\ use}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00139}00139\ \ \ \ \ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}*)\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframe\_payload}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00140}00140\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{send\_back}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00142}00142\ \ \ \ \ \textcolor{comment}{//Only\ handle\ if\ it\ is\ for\ this\ device}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00143}00143\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>destination\_ip\ ==\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1c7b476a4ff9f946407a44be120871da}{get\_internet\_protocol\_address}}())\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ length\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>total\_length;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ length\ of\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(length\ >}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ size)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ length\ is\ bigger\ than\ the\ size\ of\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ length\ =\ size;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ so,\ set\ length\ to\ size\ (this\ stops\ heartbleed\ attacks\ as\ it\ will\ not\ read\ past\ the\ end\ of\ the\ message,\ which\ the\ attacker\ could\ have\ filled\ with\ data)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ handler\ for\ the\ protocol}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Pair}{Map<uint8\_t,\ IPV4PayloadHandler*>::iterator}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler\_iterator}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1f483e94e85f55543c14305680d90ccc}{ipv\_4\_payload\_handlers}}.find(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>protocol);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler\_iterator}}\ !=\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1f483e94e85f55543c14305680d90ccc}{ipv\_4\_payload\_handlers}}.end())\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler\_iterator}}-\/>second;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{send\_back}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}-\/>handle\_internet\_protocol\_payload(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>source\_ip,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>destination\_ip,}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframe\_payload}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}),}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ length\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}));}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00158}00158\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00161}00161\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00163}00163\ \ \ \ \ \textcolor{comment}{//If\ the\ data\ is\ to\ be\ sent\ back\ again}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00164}00164\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{send\_back}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00166}00166\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Swap\ source\ and\ destination}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00167}00167\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>destination\_ip;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Store\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00168}00168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>destination\_ip\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>source\_ip;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ destination\ IP\ to\ source\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00169}00169\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>source\_ip\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ source\ IP\ to\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00171}00171\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>time\_to\_live\ =\ 0x40;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Reset\ TTL}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00172}00172\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>checksum\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa31fa08acedfffa9bffac7b2ed7eb2ac}{checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}},\ 4\ *}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_message}}-\/>header\_length);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Reset\ checksum\ as\ the\ source\ and\ destination\ IP\ have\ changed\ so\ has\ the\ time\ to\ live\ and\ therefore\ there\ is\ a\ different\ header}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00175}00175\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00177}00177\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a17f06d1d1e87c15fa5896e420ab2cd38}{error\_messages}}-\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"{}IP:\ Handled\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00178}00178\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{send\_back}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00179}00179\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00190}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a891608af68cd8d9dd9e5be5aac16f915}{00190}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a891608af68cd8d9dd9e5be5aac16f915}{InternetProtocolHandler::send\_internet\_protocol\_packet}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dst\_ip\_be}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ protocol,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ data,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00191}00191\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00192}00192\ \ \ \ \ \textcolor{keyword}{auto}*\ buffer\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*)\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a983c849ff604367f7c8a0e70172bb331}{MemoryManager::kmalloc}}(}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00193}00193\ \ \ \ \ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}})\ +\ size);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Allocate\ memory\ for\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00194}00194\ \ \ \ \ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}*)\ buffer;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Convert\ to\ struct\ for\ easier\ use}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00196}00196\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>version\ =\ 4;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ version}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00197}00197\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>header\_length\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}})\ /}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ header\ length}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00199}00199\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>type\_of\_service\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ type\ of\ service\ (not\ private)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00201}00201\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>total\_length\ =\ size\ +}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ total\ length}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00203}00203\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>total\_length\ =\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>total\_length\ \&\ 0xFF00)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00204}00204\ \ \ \ \ >>\ 8)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ big\ endian\ (Swap\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>total\_length\ \&\ 0x00FF)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00206}00206\ \ \ \ \ <<\ 8);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ big\ endian\ (Swap\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00208}00208\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>identifier\ =\ 0x100;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ identification\ TODO:\ do\ properly}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00209}00209\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>flags\_and\_offset\ =\ 0x0040;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ flags/offset,\ 0x40\ because\ we\ are\ not\ fragmenting\ (TODO:\ doesnt\ work\ for\ packets\ bigger\ than\ 1500\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00211}00211\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>time\_to\_live\ =\ 0x40;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ time\ to\ live}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00212}00212\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>protocol\ =\ protocol;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ protocol}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00214}00214\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>destination\_ip\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dst\_ip\_be}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00215}00215\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>source\_ip\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1c7b476a4ff9f946407a44be120871da}{get\_internet\_protocol\_address}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ source\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00217}00217\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>checksum\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ checksum\ to\ 0,\ init\ with\ 0\ as\ checksum\ funct\ will\ also\ add\ this\ value}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00218}00218\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}-\/>checksum\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa31fa08acedfffa9bffac7b2ed7eb2ac}{checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}));\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Calculate\ checksum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00221}00221\ \ \ \ \ \textcolor{comment}{//Copy\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00222}00222\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_buffer}}\ =\ buffer\ +}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ pointer\ to\ the\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00224}00224\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00225}00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size;\ i++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ through\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00226}00226\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_buffer}}[i]\ =\ data[i];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Copy\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00228}00228\ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ destination\ is\ on\ the\ same\ subnet,\ The\ if\ condition\ determines\ if\ the\ destination\ device\ is\ on\ the\ same\ Local\ network\ as\ the\ source\ device\ .\ and\ if\ they\ are\ not\ on\ the\ same\ local\ network\ then\ we\ resolve\ the\ ip\ address\ of\ the\ gateway\ .}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00229}00229\ \ \ \ \ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dst\_ip\_be}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ route\ to\ destination\ IP\ by\ default}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00230}00230\ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dst\_ip\_be}}\ \&\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1279fccb2269273b5de40d7952d5eb42}{subnet\_mask}})\ !=\ (\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ab0c3a3204764ece751deff25ce41e6af}{own\_internet\_protocol\_address}}\ \&}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1279fccb2269273b5de40d7952d5eb42}{subnet\_mask}}))\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ destination\ is\ on\ the\ same\ subnet}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00232}00232\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a728268d179dbd2501ba0d4a3fa0fb3ce}{default\_gateway\_internet\_protocol\_address}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ not,\ set\ route\ to\ gateway\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00233}00233\ \ \ \ \ \textcolor{comment}{//Print\ debug\ info}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00234}00234\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{mac}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5a1696bf5e661719d4d65b42736717f9}{resolver}}-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver_aeae6ed788ffdc7d369383407cd9d5dc3}{resolve}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00235}00235\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00236}00236\ \ \ \ \ \textcolor{comment}{//Send\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00237}00237\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_aa215b4095959300944028084f3ce3477}{frame\_handler}}-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFrameHandler_a2dd555f0cb2dd5513783a68e0f46d4a6}{send\_ethernet\_frame}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{mac}},\ this-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_a8e16c8efa846bd8afde20ca68294d621}{handled\_type}},\ buffer,\ size\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1IPV4Header}{IPV4Header}}));\ \ \ \ \ \ \textcolor{comment}{//Send\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00238}00238\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_abaa5e54c1428654efa1c81b69e12eb20}{MemoryManager::kfree}}(}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00239}00239\ \ \ \ \ buffer);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Free\ memory}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00240}00240\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00249}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa31fa08acedfffa9bffac7b2ed7eb2ac}{00249}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa31fa08acedfffa9bffac7b2ed7eb2ac}{InternetProtocolHandler::checksum}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*\ data,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{length\_in\_bytes}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00251}00251\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Init\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00252}00252\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00253}00253\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{length\_in\_bytes}}\ /}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2;\ i++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ through\ data\ (/2\ bc\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00255}00255\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ +=\ ((data[i]\ \&\ 0xFF00)\ >>\ 8)\ |}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((data[i]\ \&\ 0x00FF)\ <<\ 8);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ data\ to\ sum\ in\ big\ endian}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00258}00258\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{length\_in\_bytes}}\ \%}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00259}00259\ \ \ \ \ \ \ \ 2)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ there\ is\ an\ odd\ number\ of\ bytes}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00260}00260\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ +=\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}})\ ((\textcolor{keywordtype}{char}*)\ data)[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{length\_in\_bytes}}\ -\/\ 1])}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00261}00261\ \ \ \ \ \ \ \ \ <<\ 8;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ the\ last\ byte\ to\ the\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00262}00262\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00263}00263\ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ 0xFFFF0000)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//While\ there\ is\ a\ carry}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00265}00265\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFFFF)\ +}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ >>\ 16);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ the\ carry\ to\ the\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00267}00267\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00268}00268\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\string~\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFF00)\ >>\ 8)\ |\ ((\string~\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0x00FF)\ <<\ 8);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00269}00269\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00270}00270\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00276}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aefdf601418f4d5cb0365cda0cfb1c599}{00276}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aefdf601418f4d5cb0365cda0cfb1c599}{InternetProtocolHandler::register\_ipv\_4\_address\_resolver}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4AddressResolver}{IPV4AddressResolver}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipv4\_resolver}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00278}00278\ \ \ \ \ this-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5a1696bf5e661719d4d65b42736717f9}{resolver}}\ =\ ipv4\_resolver;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00280}00280\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00292}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5f949ba73368bc271ab11377c0a53da7}{00292}}\ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5f949ba73368bc271ab11377c0a53da7}{InternetProtocolHandler::create\_internet\_protocol\_address}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00293}00293\ \ \ \ \ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00294}00294\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00295}00295\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00296}00296\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00297}00297\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00298}00298\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00299}00299\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00306}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a70a2a7fc0de6796871dc8b2b3f2da48b}{00306}}\ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a70a2a7fc0de6796871dc8b2b3f2da48b}{InternetProtocolHandler::parse}}(\textcolor{keywordtype}{string}\ address)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00307}00307\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[4];}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00308}00308\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00309}00309\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_digit}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00310}00310\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\&\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit}}\ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}})}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00311}00311\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00313}00313\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ address.length();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00314}00314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(address[i]\ ==\ \textcolor{charliteral}{'.'})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_digit}}++;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00317}00317\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00318}00318\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00319}00319\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_digit}}]\ *=\ 10;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00320}00320\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_digit}}]\ +=\ address[i]\ -\/\ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00321}00321\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00323}00323\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5f949ba73368bc271ab11377c0a53da7}{create\_internet\_protocol\_address}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[0],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[1],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[2],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[3]);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00324}00324\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00336}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1740f1648819cb794e20e28f86bf8732}{00336}}\ \mbox{\hyperlink{ipv4_8h_a675fed9f30ec224711b40893d3f784d6}{SubnetMask}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1740f1648819cb794e20e28f86bf8732}{InternetProtocolHandler::create\_subnet\_mask}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00337}00337\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{ipv4_8h_a675fed9f30ec224711b40893d3f784d6}{SubnetMask}})\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a5f949ba73368bc271ab11377c0a53da7}{create\_internet\_protocol\_address}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00338}00338\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00339}00339\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00345}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1c7b476a4ff9f946407a44be120871da}{00345}}\ \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1c7b476a4ff9f946407a44be120871da}{InternetProtocolHandler::get\_internet\_protocol\_address}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00346}00346\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ab0c3a3204764ece751deff25ce41e6af}{own\_internet\_protocol\_address}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00347}00347\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00348}00348\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00354}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a8ff2723aa3184388b10021455b0ed472}{00354}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MediaAccessControlAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a8ff2723aa3184388b10021455b0ed472}{InternetProtocolHandler::get\_media\_access\_control\_address}}()\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00355}00355\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_aa215b4095959300944028084f3ce3477}{frame\_handler}}-\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFrameHandler_a5443870f425db02cb64458af19fb9082}{get\_mac}}();}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00356}00356\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00363}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a51098baf2f165b6ca0a2148a00d56f1f}{00363}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a51098baf2f165b6ca0a2148a00d56f1f}{InternetProtocolHandler::connect\_ipv\_4\_payload\_handler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipv\_4\_payload\_handler}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00364}00364\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1f483e94e85f55543c14305680d90ccc}{ipv\_4\_payload\_handlers}}.insert(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipv\_4\_payload\_handler}}-\/>ip\_protocol,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipv\_4\_payload\_handler}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00365}00365\ \}}

\end{DoxyCode}
