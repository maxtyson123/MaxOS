\doxysection{ipv4.\+cpp}
\hypertarget{ipv4_8cpp_source}{}\label{ipv4_8cpp_source}\index{/home/runner/work/MaxOS/MaxOS/kernel/src/net/ipv4.cpp@{/home/runner/work/MaxOS/MaxOS/kernel/src/net/ipv4.cpp}}
\mbox{\hyperlink{ipv4_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00001}00001\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00002}00002\ \textcolor{comment}{//\ Created\ by\ 98max\ on\ 22/11/2022.}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00003}00003\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ipv4_8h}{net/ipv4.h}}>}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00007}00007\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceMaxOS}{MaxOS}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00008}00008\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceMaxOS_1_1common}{MaxOS::common}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00009}00009\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceMaxOS_1_1net}{MaxOS::net}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00010}00010\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceMaxOS_1_1memory}{MaxOS::memory}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00011}00011\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceMaxOS_1_1drivers}{MaxOS::drivers}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00012}00012\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1ethernet}{MaxOS::drivers::ethernet}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00018}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_aa9a233eb567c1e2354c1b18891a46412}{00018}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_aa9a233eb567c1e2354c1b18891a46412}{InternetProtocolAddressResolver::InternetProtocolAddressResolver}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{InternetProtocolHandler}}\ *internetProtocolHandler)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00019}00019\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00021}00021\ \ \ \ \ internetProtocolHandler\ -\/>\ RegisterInternetProtocolAddressResolver(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00023}00023\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00027}00027\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_a2375a3aab6f4ce58f01290336f962516}{InternetProtocolAddressResolver::\string~InternetProtocolAddressResolver}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00029}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_aa75e8e59c64acf4f6dabc778f65f2522}{00029}}\ \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1ethernet_a65f54d2d9dfdb9eafd1affd62abe8d18}{MediaAccessControlAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_aa75e8e59c64acf4f6dabc778f65f2522}{InternetProtocolAddressResolver::Resolve}}(\mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{return}\ 0xFFFFFFFFFFFF;\ \textcolor{comment}{//\ the\ broadcast\ address}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00031}00031\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00033}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_af587cedecbb5e49acd99e193ccce1e57}{00033}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_af587cedecbb5e49acd99e193ccce1e57}{InternetProtocolAddressResolver::Store}}(\mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}},\ \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1ethernet_a65f54d2d9dfdb9eafd1affd62abe8d18}{MediaAccessControlAddress}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00035}00035\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00039}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_aa84ea5b14f12e69aaa6ad2b2d95871dc}{00039}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_aa84ea5b14f12e69aaa6ad2b2d95871dc}{InternetProtocolPayloadHandler::InternetProtocolPayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{InternetProtocolHandler}}*\ internetProtocolHandler,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00041}00041\ \ \ \ \ \textcolor{comment}{//\ Store\ vars}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00042}00042\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_af2365749bed6df7757755cf83f30eb42}{internetProtocolHandler}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_af2365749bed6df7757755cf83f30eb42}{internetProtocolHandler}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00043}00043\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_a77a9581fdebcdb58395175a171991f53}{ipProtocol}}\ =\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00045}00045\ \ \ \ \ \textcolor{comment}{//Register\ handler}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00046}00046\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_af2365749bed6df7757755cf83f30eb42}{internetProtocolHandler}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ace68ceb220909f204ff9140a19e7bc53}{connectInternetProtocolPayloadHandler}}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00048}00048\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00050}00050\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_ae99eea39c990fd2c549a89ddbab863ad}{InternetProtocolPayloadHandler::\string~InternetProtocolPayloadHandler}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00061}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_aaef48d6a7ff6c478f9bf561097c82c01}{00061}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_aaef48d6a7ff6c478f9bf561097c82c01}{InternetProtocolPayloadHandler::handleInternetProtocolPayload}}(\mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{net::InternetProtocolAddress}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{net::InternetProtocolAddress}},}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ *,}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00065}00065\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00066}00066\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00076}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_a547124e71c39318710ca97724adc447b}{00076}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_a547124e71c39318710ca97724adc447b}{InternetProtocolPayloadHandler::Send}}(\mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payloadData}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00079}00079\ \ \ \ \ \textcolor{comment}{//Pass\ to\ backend}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00080}00080\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_af2365749bed6df7757755cf83f30eb42}{internetProtocolHandler}}\ -\/>\ sendInternetProtocolPacket(\mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}},\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler_a77a9581fdebcdb58395175a171991f53}{ipProtocol}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payloadData}},\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00082}00082\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00088}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae6157a2dba220eb761e339dffec52653}{00088}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ae6157a2dba220eb761e339dffec52653}{InternetProtocolHandler::InternetProtocolHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFrameHandler}{EthernetFrameHandler}}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{backend}},\ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ ownInternetProtocolAddress,\ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ defaultGatewayInternetProtocolAddress,\ \mbox{\hyperlink{namespaceMaxOS_1_1net_a675fed9f30ec224711b40893d3f784d6}{SubnetMask}}\ subnetMask,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{OutputStream}}*\ errorMessages)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00089}00089\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler}{EthernetFramePayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{backend}},\ 0x0800)}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00090}00090\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00091}00091\ \ \ \ \ \textcolor{comment}{//Store\ vars}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00092}00092\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00093}00093\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aedf2d70f9d2b9ff838e31917b093499f}{defaultGatewayInternetProtocolAddress}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aedf2d70f9d2b9ff838e31917b093499f}{defaultGatewayInternetProtocolAddress}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00094}00094\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00095}00095\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00096}00096\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00098}00098\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af7c23c1c67531f0add5de160d1b8f6c2}{InternetProtocolHandler::\string~InternetProtocolHandler}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00107}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ad3d1bb7473fe8b1c77a25ed14316d4b6}{00107}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ad3d1bb7473fe8b1c77a25ed14316d4b6}{InternetProtocolHandler::handleEthernetframePayload}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframePayload}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00109}00109\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"{}IP:\ Handling\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00111}00111\ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ size\ is\ big\ enough\ to\ contain\ an\ ethernet\ frame}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00112}00112\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}\ <\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}))}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00115}00115\ \ \ \ \ \textcolor{comment}{//Convert\ to\ struct\ for\ easier\ use}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00116}00116\ \ \ \ \ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframePayload}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00117}00117\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00119}00119\ \ \ \ \ \textcolor{comment}{//Only\ handle\ if\ it\ is\ for\ this\ device}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00120}00120\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}}\ ==\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{GetInternetProtocolAddress}}())}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00121}00121\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00122}00122\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ length\ of\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ >\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ length\ is\ bigger\ than\ the\ size\ of\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ =\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ so,\ set\ length\ to\ size\ (this\ stops\ heartbleed\ attacks\ as\ it\ will\ not\ read\ past\ the\ end\ of\ the\ message,\ which\ the\ attacker\ could\ have\ filled\ with\ data)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ handler\ for\ the\ protocol}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00127}00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Pair}{Map<uint8\_t,\ InternetProtocolPayloadHandler*>::iterator}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handlerIterator}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a02d5538729b8002f918cc6a8f0759c77}{internetProtocolPayloadHandlers}}.find(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handlerIterator}}\ !=\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a02d5538729b8002f918cc6a8f0759c77}{internetProtocolPayloadHandlers}}.end())\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler}{InternetProtocolPayloadHandler}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handlerIterator}}\ -\/>\ second;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{handler}}\ -\/>\ handleInternetProtocolPayload(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ethernetframePayload}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}),\ \mbox{\hyperlink{intel__i217_8h_aebb70c2aab3407a9f05334c47131a43b}{length}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}));}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00133}00133\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00136}00136\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00138}00138\ \ \ \ \ \textcolor{comment}{//If\ the\ data\ is\ to\ be\ sent\ back\ again}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00139}00139\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}})\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Swap\ source\ and\ destination}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Store\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ destination\ IP\ to\ source\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ source\ IP\ to\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a1c954c79d7e772d87d708498a586f206}{timeToLive}}\ =\ 0x40;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Reset\ TTL}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{intel__i217_8h_a59eac9627282a484fbaf0aa7aa3b8a9a}{checksum}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{Checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}},\ 4\ *\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ipMessage}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_abf2b1d816d4e2e459b2ed1bda26cb904}{headerLength}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Reset\ checksum\ as\ the\ source\ and\ destination\ IP\ have\ changed\ so\ has\ the\ time\ to\ live\ and\ therefore\ there\ is\ a\ different\ header}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ Set\ the\ identifier}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00151}00151\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00153}00153\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a25f68427ce3892eb029d819c96eae55e}{errorMessages}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"{}IP:\ Handled\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00154}00154\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{sendBack}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00155}00155\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00166}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a55f21552e4dcf3b2256e24f97db84142}{00166}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a55f21552e4dcf3b2256e24f97db84142}{InternetProtocolHandler::sendInternetProtocolPacket}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ *\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00168}00168\ \ \ \ \ \textcolor{keyword}{auto}*\ buffer\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*)\mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a983c849ff604367f7c8a0e70172bb331}{MemoryManager::kmalloc}}(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}})\ +\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Allocate\ memory\ for\ the\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00169}00169\ \ \ \ \ \textcolor{keyword}{auto}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}*)buffer;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Convert\ to\ struct\ for\ easier\ use}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00171}00171\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_ab22abc2906422da61885ac6c8e6a1a59}{version}}\ =\ 4;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ version}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00172}00172\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_abf2b1d816d4e2e459b2ed1bda26cb904}{headerLength}}\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}})/4;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ header\ length}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00173}00173\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_ab0548e81efcf280a5ae280858e578cde}{typeOfService}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ type\ of\ service\ (not\ private)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00175}00175\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ =\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ total\ length}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00176}00176\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ =\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ \&\ 0xFF00)\ >>\ 8)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ big\ endian\ (Swap\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a46d6b08cf598408355fa1fc5c1de902a}{totalLength}}\ \&\ 0x00FF)\ <<\ 8);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ big\ endian\ (Swap\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00179}00179\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a5868ad3e30cea561af39afae3efa4a7a}{identifier}}\ =\ 0x100;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ identification\ TODO:\ do\ properly}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00180}00180\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_ae5fbba8e197a2e68174867191be7ddac}{flagsAndOffset}}\ =\ 0x0040;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ flags/offset,\ 0x40\ because\ we\ are\ not\ fragmenting\ (TODO:\ doesnt\ work\ for\ packets\ bigger\ than\ 1500\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00182}00182\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_a1c954c79d7e772d87d708498a586f206}{timeToLive}}\ =\ 0x40;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ time\ to\ live}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00183}00183\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}}\ =\ \mbox{\hyperlink{arp_8h_ab551400c74271f35d0c79f81d29cffbb}{protocol}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ protocol}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00184}00184\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00185}00185\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_afcc7048c1d9643cebaf1806fa4de390e}{destinationIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ destination\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00186}00186\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{ipv4_8h_aed74aa5789cabec794d6961455e80db3}{sourceIP}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{GetInternetProtocolAddress}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ source\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00188}00188\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{intel__i217_8h_a59eac9627282a484fbaf0aa7aa3b8a9a}{checksum}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ checksum\ to\ 0,\ init\ with\ 0\ as\ checksum\ funct\ will\ also\ add\ this\ value}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00189}00189\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}}\ -\/>\ \mbox{\hyperlink{intel__i217_8h_a59eac9627282a484fbaf0aa7aa3b8a9a}{checksum}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{Checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{message}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}));\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Calculate\ checksum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00191}00191\ \ \ \ \ \textcolor{comment}{//Copy\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00192}00192\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_buffer}}\ =\ buffer\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ pointer\ to\ the\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00193}00193\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}};\ i++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ through\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00194}00194\ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{data\_buffer}}[i]\ =\ \mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}[i];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Copy\ data}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00196}00196\ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ destination\ is\ on\ the\ same\ subnet,\ The\ if\ condition\ determines\ if\ the\ destination\ device\ is\ on\ the\ same\ Local\ network\ as\ the\ source\ device\ .\ and\ if\ they\ are\ not\ on\ the\ same\ local\ network\ then\ we\ resolve\ the\ ip\ address\ of\ the\ gateway\ .}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00197}00197\ \ \ \ \ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Set\ route\ to\ destination\ IP\ by\ default}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00198}00198\ \ \ \ \ \textcolor{keywordflow}{if}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dstIP\_BE}}\ \&\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}})\ !=\ (\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}}\ \&\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_af447a51eb097abba8be48fdb18eae6a7}{subnetMask}}))\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ the\ destination\ is\ on\ the\ same\ subnet}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00199}00199\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aedf2d70f9d2b9ff838e31917b093499f}{defaultGatewayInternetProtocolAddress}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ not,\ set\ route\ to\ gateway\ IP}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Print\ debug\ info}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00201}00201\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MAC}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aebd33925e99ef913e8afd31c1c0b4a8d}{resolver}}\ -\/>\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver_aa75e8e59c64acf4f6dabc778f65f2522}{Resolve}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{route}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00203}00203\ \ \ \ \ \textcolor{comment}{//Send\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00204}00204\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_ac54f71ce7d512ba22a6f3306ad459a70}{frameHandler}}\ -\/>\ sendEthernetFrame(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MAC}},\ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_a902f9382cf1085858a123e304550ad80}{handledType}},\ buffer,\ \mbox{\hyperlink{ext2_8h_aaba88b24a21a6c70c895c0d55f4a69a0}{size}}\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1InternetProtocolV4Header}{InternetProtocolV4Header}}));\ \ \ \ \ \ \textcolor{comment}{//Send\ message}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00205}00205\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_abaa5e54c1428654efa1c81b69e12eb20}{MemoryManager::kfree}}(buffer);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Free\ memory}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00206}00206\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00215}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{00215}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a95cad129c9c0a16f40334bc373586412}{InternetProtocolHandler::Checksum}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}\ *\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00217}00217\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Init\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00219}00219\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}}/2;\ i++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Loop\ through\ data\ (/2\ bc\ bytes)}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00220}00220\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ +=\ ((\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}[i]\ \&\ 0xFF00)\ >>\ 8)\ |\ ((\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}[i]\ \&\ 0x00FF)\ <<\ 8);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ data\ to\ sum\ in\ big\ endian}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00222}00222\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}}\ \%\ 2)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ there\ is\ an\ odd\ number\ of\ bytes}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00223}00223\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ +=\ ((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}})((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}})[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{lengthInBytes}}-\/1])\ <<\ 8;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ the\ last\ byte\ to\ the\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00225}00225\ \ \ \ \ \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFFFF0000)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//While\ there\ is\ a\ carry}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00226}00226\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFFFF)\ +\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ >>\ 16);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Add\ the\ carry\ to\ the\ sum}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00228}00228\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\string~\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0xFF00)\ >>\ 8)\ |\ ((\string~\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{temp}}\ \&\ 0x00FF)\ <<\ 8);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00229}00229\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00231}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a64f10c98db6120cf3cffcdf2d33d6db1}{00231}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a64f10c98db6120cf3cffcdf2d33d6db1}{InternetProtocolHandler::RegisterInternetProtocolAddressResolver}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolAddressResolver}{InternetProtocolAddressResolver}}\ *resolver)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00233}00233\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aebd33925e99ef913e8afd31c1c0b4a8d}{resolver}}\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aebd33925e99ef913e8afd31c1c0b4a8d}{resolver}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00235}00235\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00237}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{00237}}\ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{InternetProtocolHandler::CreateInternetProtocolAddress}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00238}00238\ \ \ \ \ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00239}00239\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00240}00240\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00241}00241\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}}\ <<\ 8)\ |\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00242}00242\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{result}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00243}00243\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00245}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_afe355c241075103457e041325d9b86c0}{00245}}\ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_afe355c241075103457e041325d9b86c0}{InternetProtocolHandler::Parse}}(\textcolor{keywordtype}{string}\ \mbox{\hyperlink{amd__am79c973_8h_ab6b52376c1b9d81e6ea6f95a1225f832}{address}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00246}00246\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[4];}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00248}00248\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00249}00249\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit}}\ :\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}})}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00250}00250\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00252}00252\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{amd__am79c973_8h_ab6b52376c1b9d81e6ea6f95a1225f832}{address}}.length();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{amd__am79c973_8h_ab6b52376c1b9d81e6ea6f95a1225f832}{address}}[i]\ ==\ \textcolor{charliteral}{'.'})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}++;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00256}00256\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00258}00258\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}]\ *=\ 10;}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00259}00259\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{currentDigit}}]\ +=\ \mbox{\hyperlink{amd__am79c973_8h_ab6b52376c1b9d81e6ea6f95a1225f832}{address}}[i]\ -\/\ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00260}00260\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00262}00262\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{CreateInternetProtocolAddress}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[0],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[1],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[2],\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digits}}[3]);}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00263}00263\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00264}00264\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00265}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a381d0d9daecb7fd7118125cb1e083cd4}{00265}}\ \mbox{\hyperlink{namespaceMaxOS_1_1net_a675fed9f30ec224711b40893d3f784d6}{SubnetMask}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a381d0d9daecb7fd7118125cb1e083cd4}{InternetProtocolHandler::CreateSubnetMask}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00266}00266\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{namespaceMaxOS_1_1net_a675fed9f30ec224711b40893d3f784d6}{SubnetMask}})\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a3f7fcfa4bd0b8ea9dcc76d987affd875}{CreateInternetProtocolAddress}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit1}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit2}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit3}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{digit4}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00267}00267\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00269}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{00269}}\ \mbox{\hyperlink{namespaceMaxOS_1_1net_af037c025feb88b952b167f4dfa2709a0}{InternetProtocolAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a1b07ff5f95fac500efa2c2ba0e661324}{InternetProtocolHandler::GetInternetProtocolAddress}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00270}00270\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa0f90002940b50c7ad0d433a4cf0e01e}{ownInternetProtocolAddress}};}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00271}00271\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00273}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a19e57b1275f830876149c174d7cba632}{00273}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{MediaAccessControlAddress}}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a19e57b1275f830876149c174d7cba632}{InternetProtocolHandler::GetMediaAccessControlAddress}}()\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00274}00274\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1EthernetFramePayloadHandler_ac54f71ce7d512ba22a6f3306ad459a70}{frameHandler}}\ -\/>\ getMAC();}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00275}00275\ \}}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00277}\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ace68ceb220909f204ff9140a19e7bc53}{00277}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_ace68ceb220909f204ff9140a19e7bc53}{InternetProtocolHandler::connectInternetProtocolPayloadHandler}}(\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolPayloadHandler}{InternetProtocolPayloadHandler}}\ *\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{internetProtocolPayloadHandler}})\ \{}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00278}00278\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_a02d5538729b8002f918cc6a8f0759c77}{internetProtocolPayloadHandlers}}.insert(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{internetProtocolPayloadHandler}}\ -\/>\ ipProtocol,\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{internetProtocolPayloadHandler}});}
\DoxyCodeLine{\Hypertarget{ipv4_8cpp_source_l00279}00279\ \}}

\end{DoxyCode}
