\hypertarget{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}{}\doxysection{max\+OS\+::hardwarecommunication\+::Peripheral\+Component\+Interconnect\+Controller Class Reference}
\label{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}\index{maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}}


Handles the selecting and loading of drivers for P\+CI devices.  




{\ttfamily \#include $<$pci.\+h$>$}

Inheritance diagram for max\+OS\+::hardwarecommunication\+::Peripheral\+Component\+Interconnect\+Controller\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a80d982d6e9bc8407795d38c8c7ac1c6b}{Peripheral\+Component\+Interconnect\+Controller}} (\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} $\ast$)
\begin{DoxyCompactList}\small\item\em \+\_\+\+\_\+\+C\+O\+N\+T\+R\+O\+L\+L\+E\+R\+\_\+\+\_\+\+\_\+ \end{DoxyCompactList}\item 
\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}{$\sim$\+Peripheral\+Component\+Interconnect\+Controller}} ()
\item 
void \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ac25d2d2f6ed315454ebbfac26070d72b}{select\+\_\+drivers}} (\mbox{\hyperlink{classmaxOS_1_1drivers_1_1DriverSelectorEventHandler}{drivers\+::\+Driver\+Selector\+Event\+Handler}} $\ast$handler, \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$interrupt\+\_\+manager, \mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} $\ast$error\+\_\+message\+\_\+stream)
\begin{DoxyCompactList}\small\item\em Select the driver for the device. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver}{drivers\+::\+Driver}} $\ast$ \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}{get\+\_\+driver}} (\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}} dev, \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager}{Interrupt\+Manager}} $\ast$interrupt\+\_\+manager)
\begin{DoxyCompactList}\small\item\em Get the driver for the device. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}{list\+\_\+known\+\_\+deivce}} (\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}} dev)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles the selecting and loading of drivers for P\+CI devices. 

Definition at line 77 of file pci.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a80d982d6e9bc8407795d38c8c7ac1c6b}\label{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a80d982d6e9bc8407795d38c8c7ac1c6b}} 
\index{maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}!PeripheralComponentInterconnectController@{PeripheralComponentInterconnectController}}
\index{PeripheralComponentInterconnectController@{PeripheralComponentInterconnectController}!maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{PeripheralComponentInterconnectController()}{PeripheralComponentInterconnectController()}}
{\footnotesize\ttfamily Peripheral\+Component\+Interconnect\+Controller\+::\+Peripheral\+Component\+Interconnect\+Controller (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} $\ast$}]{stream }\end{DoxyParamCaption})}



\+\_\+\+\_\+\+C\+O\+N\+T\+R\+O\+L\+L\+E\+R\+\_\+\+\_\+\+\_\+ 



Definition at line 80 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{81 : m\_data\_port(0xCFC),}
\DoxyCodeLine{82   m\_command\_port(0xCF8),}
\DoxyCodeLine{83   m\_debug\_messages\_stream(stream)}
\DoxyCodeLine{84 \{}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}\label{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a355955bf5e632fc0b0f9276986a18dd7}} 
\index{maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}!````~PeripheralComponentInterconnectController@{$\sim$PeripheralComponentInterconnectController}}
\index{````~PeripheralComponentInterconnectController@{$\sim$PeripheralComponentInterconnectController}!maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{$\sim$PeripheralComponentInterconnectController()}{~PeripheralComponentInterconnectController()}}
{\footnotesize\ttfamily Peripheral\+Component\+Interconnect\+Controller\+::$\sim$\+Peripheral\+Component\+Interconnect\+Controller (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 88 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{88                                                                                       \{}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}\label{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}} 
\index{maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}!get\_driver@{get\_driver}}
\index{get\_driver@{get\_driver}!maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{get\_driver()}{get\_driver()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver}{Driver}} $\ast$ Peripheral\+Component\+Interconnect\+Controller\+::get\+\_\+driver (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}}}]{dev,  }\item[{\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager}{Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager }\end{DoxyParamCaption})}



Get the driver for the device. 


\begin{DoxyParams}{Parameters}
{\em dev} & Device descriptor \\
\hline
{\em interrupt\+\_\+manager} & Interrupt manager \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Driver for the device, 0 if there is no driver 
\end{DoxyReturn}


Definition at line 238 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{238                                                                                                                                                      \{}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     \textcolor{comment}{// Dont use new here, manually allocate memory instead}}
\DoxyCodeLine{241 }
\DoxyCodeLine{242     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver}{Driver}}* driver = 0;}
\DoxyCodeLine{243     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_afa96f5e0f3d5f5e93d7e6c66d84a7e0b}{vendor\_id}})}
\DoxyCodeLine{244     \{}
\DoxyCodeLine{245         \textcolor{keywordflow}{case} 0x1022:    \textcolor{comment}{//AMD}}
\DoxyCodeLine{246         \{}
\DoxyCodeLine{247             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}})}
\DoxyCodeLine{248             \{}
\DoxyCodeLine{249                 \textcolor{keywordflow}{case} 0x2000:    \textcolor{comment}{//am79c971}}
\DoxyCodeLine{250                 \{}
\DoxyCodeLine{251                     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}* result = (\mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}*)MemoryManager::s\_active\_memory\_manager}
\DoxyCodeLine{252                           -\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}));}
\DoxyCodeLine{253                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1amd__am79c973}{amd\_am79c973}}(\&dev, interrupt\_manager);}
\DoxyCodeLine{254                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{255 }
\DoxyCodeLine{256                 \}}
\DoxyCodeLine{257                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{258                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{259             \}}
\DoxyCodeLine{260             \textcolor{keywordflow}{break};}
\DoxyCodeLine{261         \}}
\DoxyCodeLine{262         \textcolor{keywordflow}{case} 0x8086:  \textcolor{comment}{//Intel}}
\DoxyCodeLine{263         \{}
\DoxyCodeLine{264             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}})}
\DoxyCodeLine{265             \{}
\DoxyCodeLine{266                 \textcolor{keywordflow}{case} 0x100E: \textcolor{comment}{//i217 (Ethernet Controller)}}
\DoxyCodeLine{267                 \{}
\DoxyCodeLine{268                     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}* result = (\mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}*)MemoryManager::s\_active\_memory\_manager}
\DoxyCodeLine{269                           -\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}));}
\DoxyCodeLine{270                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classmaxOS_1_1drivers_1_1ethernet_1_1intel__i217}{intel\_i217}}(\&dev, interrupt\_manager);}
\DoxyCodeLine{271                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{272                 \}}
\DoxyCodeLine{273                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{274                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{275             \}}
\DoxyCodeLine{276             \textcolor{keywordflow}{break};}
\DoxyCodeLine{277         \}\textcolor{comment}{//End Intel}}
\DoxyCodeLine{278     \}}
\DoxyCodeLine{279 }
\DoxyCodeLine{280     \textcolor{comment}{//If there is no driver for the particular device, go into generic devices}}
\DoxyCodeLine{281     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a4b4a73fa4835731965c2c24ee70bac1d}{class\_id}})}
\DoxyCodeLine{282     \{}
\DoxyCodeLine{283         \textcolor{keywordflow}{case} 0x03: \textcolor{comment}{//Graphics}}
\DoxyCodeLine{284         \{}
\DoxyCodeLine{285 }
\DoxyCodeLine{286             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a30e57fa5c651aca222e09c7cc7b87c71}{subclass\_id}})}
\DoxyCodeLine{287             \{}
\DoxyCodeLine{288                 \textcolor{keywordflow}{case} 0x00:  \textcolor{comment}{//VGA}}
\DoxyCodeLine{289                 \{}
\DoxyCodeLine{290                     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}* result = (\mbox{\hyperlink{classmaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}*)MemoryManager::s\_active\_memory\_manager-\/>malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}));}
\DoxyCodeLine{291                     \textcolor{keyword}{new} (result) \mbox{\hyperlink{classmaxOS_1_1drivers_1_1video_1_1VideoGraphicsArray}{VideoGraphicsArray}}();}
\DoxyCodeLine{292                     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{293                 \}}
\DoxyCodeLine{294             \}}
\DoxyCodeLine{295             \textcolor{keywordflow}{break};}
\DoxyCodeLine{296         \}}
\DoxyCodeLine{297     \}}
\DoxyCodeLine{298 }
\DoxyCodeLine{299     \textcolor{keywordflow}{return} driver;}
\DoxyCodeLine{300 \}}

\end{DoxyCode}


References max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::class\+\_\+id, max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::device\+\_\+id, max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::subclass\+\_\+id, and max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id.



Referenced by select\+\_\+drivers().

\mbox{\Hypertarget{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}\label{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}} 
\index{maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}!list\_known\_deivce@{list\_known\_deivce}}
\index{list\_known\_deivce@{list\_known\_deivce}!maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{list\_known\_deivce()}{list\_known\_deivce()}}
{\footnotesize\ttfamily void Peripheral\+Component\+Interconnect\+Controller\+::list\+\_\+known\+\_\+deivce (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{Peripheral\+Component\+Interconnect\+Device\+Descriptor}}}]{dev }\end{DoxyParamCaption})}



Definition at line 303 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{303                                                                                                                      \{}
\DoxyCodeLine{304     \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_afa96f5e0f3d5f5e93d7e6c66d84a7e0b}{vendor\_id}})}
\DoxyCodeLine{305     \{}
\DoxyCodeLine{306         \textcolor{keywordflow}{case} 0x1022:}
\DoxyCodeLine{307         \{}
\DoxyCodeLine{308             \textcolor{comment}{// The vendor is AMD}}
\DoxyCodeLine{309             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"AMD "});}
\DoxyCodeLine{310 }
\DoxyCodeLine{311             \textcolor{comment}{// List the device}}
\DoxyCodeLine{312             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}})}
\DoxyCodeLine{313             \{}
\DoxyCodeLine{314                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{315                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}});}
\DoxyCodeLine{316                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{317             \}}
\DoxyCodeLine{318             \textcolor{keywordflow}{break};}
\DoxyCodeLine{319         \}}
\DoxyCodeLine{320 }
\DoxyCodeLine{321         \textcolor{keywordflow}{case} 0x106B:}
\DoxyCodeLine{322         \{}
\DoxyCodeLine{323             \textcolor{comment}{// The vendor is Apple}}
\DoxyCodeLine{324             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Apple "});}
\DoxyCodeLine{325 }
\DoxyCodeLine{326             \textcolor{comment}{// List the device}}
\DoxyCodeLine{327             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}})}
\DoxyCodeLine{328             \{}
\DoxyCodeLine{329                 \textcolor{keywordflow}{case} 0x003F:}
\DoxyCodeLine{330                 \{}
\DoxyCodeLine{331                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"KeyLargo/Intrepid USB"});}
\DoxyCodeLine{332                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{333                 \}}
\DoxyCodeLine{334 }
\DoxyCodeLine{335                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{336                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}});}
\DoxyCodeLine{337                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{338             \}}
\DoxyCodeLine{339             \textcolor{keywordflow}{break};}
\DoxyCodeLine{340         \}}
\DoxyCodeLine{341 }
\DoxyCodeLine{342         \textcolor{keywordflow}{case} 1234:}
\DoxyCodeLine{343         \{}
\DoxyCodeLine{344             \textcolor{comment}{// The vendor is QEMU}}
\DoxyCodeLine{345             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"QEMU "});}
\DoxyCodeLine{346 }
\DoxyCodeLine{347             \textcolor{comment}{// List the device}}
\DoxyCodeLine{348             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}})}
\DoxyCodeLine{349             \{}
\DoxyCodeLine{350 }
\DoxyCodeLine{351                 \textcolor{keywordflow}{case} 0x1111:}
\DoxyCodeLine{352                 \{}
\DoxyCodeLine{353                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Virtual Video Controller"});}
\DoxyCodeLine{354                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{355                 \}}
\DoxyCodeLine{356             \}}
\DoxyCodeLine{357             \textcolor{keywordflow}{break};}
\DoxyCodeLine{358         \}}
\DoxyCodeLine{359 }
\DoxyCodeLine{360         \textcolor{keywordflow}{case} 0x8086:}
\DoxyCodeLine{361         \{}
\DoxyCodeLine{362             \textcolor{comment}{// The vendor is Intel}}
\DoxyCodeLine{363             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Intel "});}
\DoxyCodeLine{364 }
\DoxyCodeLine{365             \textcolor{comment}{// List the device}}
\DoxyCodeLine{366             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}})}
\DoxyCodeLine{367             \{}
\DoxyCodeLine{368 }
\DoxyCodeLine{369                 \textcolor{keywordflow}{case} 0x1237:}
\DoxyCodeLine{370                 \{}
\DoxyCodeLine{371                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"440FX"});}
\DoxyCodeLine{372                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{373                 \}}
\DoxyCodeLine{374 }
\DoxyCodeLine{375                 \textcolor{keywordflow}{case} 0x2415:}
\DoxyCodeLine{376                 \{}
\DoxyCodeLine{377                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"AC'97"});}
\DoxyCodeLine{378                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{379                 \}}
\DoxyCodeLine{380 }
\DoxyCodeLine{381                 \textcolor{keywordflow}{case} 0x7000:}
\DoxyCodeLine{382                 \{}
\DoxyCodeLine{383                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX3"});}
\DoxyCodeLine{384                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{385 }
\DoxyCodeLine{386                 \}}
\DoxyCodeLine{387 }
\DoxyCodeLine{388                 \textcolor{keywordflow}{case} 0x7010:}
\DoxyCodeLine{389                 \{}
\DoxyCodeLine{390                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX4"});}
\DoxyCodeLine{391                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{392 }
\DoxyCodeLine{393                 \}}
\DoxyCodeLine{394 }
\DoxyCodeLine{395                 \textcolor{keywordflow}{case} 0x7111:}
\DoxyCodeLine{396                 \{}
\DoxyCodeLine{397                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX3"});}
\DoxyCodeLine{398                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{399                 \}}
\DoxyCodeLine{400 }
\DoxyCodeLine{401                 \textcolor{keywordflow}{case} 0x7113:}
\DoxyCodeLine{402                 \{}
\DoxyCodeLine{403                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"PIIX4 ACPI"});}
\DoxyCodeLine{404                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{405                 \}}
\DoxyCodeLine{406 }
\DoxyCodeLine{407                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{408                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{409 }
\DoxyCodeLine{410             \}}
\DoxyCodeLine{411             \textcolor{keywordflow}{break};}
\DoxyCodeLine{412         \}}
\DoxyCodeLine{413 }
\DoxyCodeLine{414         \textcolor{keywordflow}{case} 0x80EE: \{}
\DoxyCodeLine{415 }
\DoxyCodeLine{416             \textcolor{comment}{// The vendor is VirtualBox}}
\DoxyCodeLine{417             m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"VirtualBox "});}
\DoxyCodeLine{418 }
\DoxyCodeLine{419             \textcolor{comment}{// List the device}}
\DoxyCodeLine{420             \textcolor{keywordflow}{switch} (dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}}) \{}
\DoxyCodeLine{421 }
\DoxyCodeLine{422                 \textcolor{keywordflow}{case} 0xBEEF: \{}
\DoxyCodeLine{423                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Graphics Adapter"});}
\DoxyCodeLine{424                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{425                 \}}
\DoxyCodeLine{426 }
\DoxyCodeLine{427                 \textcolor{keywordflow}{case} 0xCAFE: \{}
\DoxyCodeLine{428                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"Guest Service"});}
\DoxyCodeLine{429                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{430                 \}}
\DoxyCodeLine{431             \}}
\DoxyCodeLine{432             \textcolor{keywordflow}{break};}
\DoxyCodeLine{433         \}}
\DoxyCodeLine{434 }
\DoxyCodeLine{435         \textcolor{keywordflow}{default}:    \textcolor{comment}{// Unknown}}
\DoxyCodeLine{436           m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_afa96f5e0f3d5f5e93d7e6c66d84a7e0b}{vendor\_id}});}
\DoxyCodeLine{437           m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{" "});}
\DoxyCodeLine{438           m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_a810813a72bc51936c4926e182d74b739}{write\_hex}}(dev.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_a8cf5c86f59f3712245ab3de755e97923}{device\_id}});}
\DoxyCodeLine{439           \textcolor{keywordflow}{break};}
\DoxyCodeLine{440 }
\DoxyCodeLine{441     \}}
\DoxyCodeLine{442 \}}

\end{DoxyCode}


References max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::device\+\_\+id, max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id, max\+O\+S\+::common\+::\+Output\+Stream\+::write(), and max\+O\+S\+::common\+::\+Output\+Stream\+::write\+\_\+hex().



Referenced by select\+\_\+drivers().

\mbox{\Hypertarget{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ac25d2d2f6ed315454ebbfac26070d72b}\label{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ac25d2d2f6ed315454ebbfac26070d72b}} 
\index{maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}!select\_drivers@{select\_drivers}}
\index{select\_drivers@{select\_drivers}!maxOS::hardwarecommunication::PeripheralComponentInterconnectController@{maxOS::hardwarecommunication::PeripheralComponentInterconnectController}}
\doxysubsubsection{\texorpdfstring{select\_drivers()}{select\_drivers()}}
{\footnotesize\ttfamily void Peripheral\+Component\+Interconnect\+Controller\+::select\+\_\+drivers (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmaxOS_1_1drivers_1_1DriverSelectorEventHandler}{drivers\+::\+Driver\+Selector\+Event\+Handler}} $\ast$}]{handler,  }\item[{\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager,  }\item[{\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} $\ast$}]{error\+\_\+message\+\_\+stream }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Select the driver for the device. 


\begin{DoxyParams}{Parameters}
{\em driver\+Manager} & device driver manager \\
\hline
{\em interrupt\+\_\+manager} & Interrupt manager \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Driver for the device 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classmaxOS_1_1drivers_1_1DriverSelector_a02dbf388fe58fdf82fa546a6a4945848}{max\+O\+S\+::drivers\+::\+Driver\+Selector}}.



Definition at line 159 of file pci.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{160 \{}
\DoxyCodeLine{161     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} bus = 0; bus < 8; ++bus) \{}
\DoxyCodeLine{162         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} device = 0; device < 32; ++device) \{}
\DoxyCodeLine{163 }
\DoxyCodeLine{164             \textcolor{keywordtype}{int} numFunctions = (device\_has\_functions(bus, device)) ? 8 : 1;}
\DoxyCodeLine{165 }
\DoxyCodeLine{166             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \textcolor{keyword}{function} = 0; \textcolor{keyword}{function} < numFunctions; ++\textcolor{keyword}{function}) \{}
\DoxyCodeLine{167 }
\DoxyCodeLine{168                 \textcolor{comment}{// Get the device descriptor, if the vendor id is 0x0000 or 0xFFFF, the device is not present/ready}}
\DoxyCodeLine{169                 \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor}{PeripheralComponentInterconnectDeviceDescriptor}} deviceDescriptor = get\_device\_descriptor(bus, device, \textcolor{keyword}{function});}
\DoxyCodeLine{170                 \textcolor{keywordflow}{if}(deviceDescriptor.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_afa96f5e0f3d5f5e93d7e6c66d84a7e0b}{vendor\_id}} == 0x0000 || deviceDescriptor.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_afa96f5e0f3d5f5e93d7e6c66d84a7e0b}{vendor\_id}} == 0x0001 || deviceDescriptor.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_afa96f5e0f3d5f5e93d7e6c66d84a7e0b}{vendor\_id}} == 0xFFFF)}
\DoxyCodeLine{171                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 }
\DoxyCodeLine{174                 \textcolor{comment}{// Get port number}}
\DoxyCodeLine{175                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} barNum = 5; barNum >= 0; barNum-\/-\/)\{}
\DoxyCodeLine{176                     \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1BaseAddressRegister}{BaseAddressRegister}} bar = get\_base\_address\_register(bus, device, \textcolor{keyword}{function}, barNum);}
\DoxyCodeLine{177                     \textcolor{keywordflow}{if}(bar.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a4acb381574f93f8cc59a7d56f3f6034e}{address}} \&\& (bar.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a58f57a8446751b8fa210f4f3c04cd62b}{type}} == \mbox{\hyperlink{namespacemaxOS_1_1hardwarecommunication_a7e1d99ea113ddb98b2bcff65103032f7adf1cf5779c35e53512305a529ce4b2df}{InputOutput}}))}
\DoxyCodeLine{178                         deviceDescriptor.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_aabf5da2750a3d84279b26adfa75ce733}{port\_base}} = (uint32\_t)bar.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1BaseAddressRegister_a4acb381574f93f8cc59a7d56f3f6034e}{address}};}
\DoxyCodeLine{179                 \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181                 \textcolor{comment}{// write to the debug stream}}
\DoxyCodeLine{182                 m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(deviceDescriptor.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectDeviceDescriptor_ab2ce5626480b7a91ebe27ea3f2d31229}{get\_type}}());}
\DoxyCodeLine{183                 m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{": "});}
\DoxyCodeLine{184 }
\DoxyCodeLine{185                 \textcolor{comment}{// Select the driver and print information about the device}}
\DoxyCodeLine{186                 \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver}{Driver}}* driver = \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_ad3499aa1e24262d36e5b1456ea3e92c1}{get\_driver}}(deviceDescriptor, interrupt\_manager);}
\DoxyCodeLine{187                 \textcolor{keywordflow}{if}(driver != 0)\{}
\DoxyCodeLine{188                   handler-\/>\mbox{\hyperlink{classmaxOS_1_1drivers_1_1DriverSelectorEventHandler_ad25298d6b14e6f790715563932cca77e}{on\_driver\_selected}}(driver);}
\DoxyCodeLine{189                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(driver-\/>\mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver_a7ad761c929a49cfebd8c443f5af788f6}{get\_vendor\_name}}());}
\DoxyCodeLine{190                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{" "});}
\DoxyCodeLine{191                   m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(driver-\/>\mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver_a65b06f2917f7a781e68f3748e81806b6}{get\_device\_name}}());}
\DoxyCodeLine{192                 \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{193                   \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1PeripheralComponentInterconnectController_a8d9c39a9f59f70a97172fbdac6bccd82}{list\_known\_deivce}}(deviceDescriptor);}
\DoxyCodeLine{194                 \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196                 \textcolor{comment}{// New line}}
\DoxyCodeLine{197                 m\_debug\_messages\_stream-\/>\mbox{\hyperlink{classmaxOS_1_1common_1_1OutputStream_acd9ebbe1729dded0d4156f32ae77da95}{write}}(\textcolor{stringliteral}{"\(\backslash\)n"});}
\DoxyCodeLine{198             \}}
\DoxyCodeLine{199         \}}
\DoxyCodeLine{200     \}}
\DoxyCodeLine{201 \}}

\end{DoxyCode}


References max\+O\+S\+::hardwarecommunication\+::\+Base\+Address\+Register\+::address, max\+O\+S\+::drivers\+::\+Driver\+::get\+\_\+device\+\_\+name(), get\+\_\+driver(), max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::get\+\_\+type(), max\+O\+S\+::drivers\+::\+Driver\+::get\+\_\+vendor\+\_\+name(), max\+O\+S\+::hardwarecommunication\+::\+Input\+Output, list\+\_\+known\+\_\+deivce(), max\+O\+S\+::drivers\+::\+Driver\+Selector\+Event\+Handler\+::on\+\_\+driver\+\_\+selected(), max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::port\+\_\+base, max\+O\+S\+::hardwarecommunication\+::\+Base\+Address\+Register\+::type, max\+O\+S\+::hardwarecommunication\+::\+Peripheral\+Component\+Interconnect\+Device\+Descriptor\+::vendor\+\_\+id, and max\+O\+S\+::common\+::\+Output\+Stream\+::write().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/hardwarecommunication/\mbox{\hyperlink{pci_8h}{pci.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/hardwarecommunication/\mbox{\hyperlink{pci_8cpp}{pci.\+cpp}}\end{DoxyCompactItemize}
