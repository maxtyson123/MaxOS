\hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock}{}\doxysection{max\+OS\+::drivers\+::clock\+::Clock Class Reference}
\label{classmaxOS_1_1drivers_1_1clock_1_1Clock}\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}


\mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver}{Driver}} for the C\+M\+OS Real Time \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}}.  




{\ttfamily \#include $<$clock.\+h$>$}

Inheritance diagram for max\+OS\+::drivers\+::clock\+::Clock\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.240310cm]{classmaxOS_1_1drivers_1_1clock_1_1Clock}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_aacf40bf9ec346f817c46b1c170e2db4e}{Clock}} (\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$interrupt\+\_\+manager, uint16\+\_\+t time\+\_\+between\+\_\+events=10)
\begin{DoxyCompactList}\small\item\em {\bfseries{\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}}}} \end{DoxyCompactList}\item 
\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_afc976ce68fa85e15cc06f9ed47bddb7c}{$\sim$\+Clock}} ()
\item 
void \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7d105f260a9197c78e77e0ba437f0168}{activate}} () override
\begin{DoxyCompactList}\small\item\em Activates the clock, setting the binary coded decimal representation flag. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_abc9de19ed4bbd05fa8e449ef0df48ad5}{delay}} (uint32\+\_\+t milliseconds)
\begin{DoxyCompactList}\small\item\em Delays the program for a specified number of milliseconds (rounded to the nearest 100) \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacemaxOS_a6a3d939df112a32e3a1655b764931088}{string}} \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_afff456a86d73eda4507a2fe503485ac5}{get\+\_\+vendor\+\_\+name}} () final
\begin{DoxyCompactList}\small\item\em Gets the name of the vendor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacemaxOS_a6a3d939df112a32e3a1655b764931088}{string}} \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad3eddc94ae13577816756ff70c72a02a}{get\+\_\+device\+\_\+name}} () final
\begin{DoxyCompactList}\small\item\em Gets the name of the device. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a1f0352d2346a3bef618e5c6f3bc71c0c}{handle\+\_\+interrupt}} () final
\begin{DoxyCompactList}\small\item\em Handle the R\+TC interrupt, raising the clock event if enough time has passed. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\+\_\+hardware\+\_\+clock}} (uint8\+\_\+t \mbox{\hyperlink{amd__am79c973_8h_ac0d31ca829f934cccd89f8054e02773e}{address}})
\begin{DoxyCompactList}\small\item\em read the current time from the hardware clock and return it \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\+\_\+representation}} (uint8\+\_\+t number)
\begin{DoxyCompactList}\small\item\em The binary representation of a number. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_abee5b3a5ce66060e8e252d807119bd17}{m\+\_\+binary\+\_\+coded\+\_\+decimal\+\_\+representation}}
\item 
\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad02999d90b05ffc6d7738cd633b3ec64}{m\+\_\+data\+\_\+port}}
\item 
\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a957d9b0d2c1cb0f253e7bbe768139b3e}{m\+\_\+command\+\_\+port}}
\item 
uint16\+\_\+t \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7468dd1f25f9e84099c99c4f924138b5}{m\+\_\+ticks\+\_\+between\+\_\+events}} \{ 0 \}
\item 
uint16\+\_\+t \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_aaaef648bb176dd6d0370c68ea947f5db}{m\+\_\+ticks\+\_\+until\+\_\+next\+\_\+event}} \{ 1 \}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver}{Driver}} for the C\+M\+OS Real Time \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}}. 

Definition at line 56 of file clock.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_aacf40bf9ec346f817c46b1c170e2db4e}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_aacf40bf9ec346f817c46b1c170e2db4e}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!Clock@{Clock}}
\index{Clock@{Clock}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{Clock()}{Clock()}}
{\footnotesize\ttfamily Clock\+::\+Clock (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager}{hardwarecommunication\+::\+Interrupt\+Manager}} $\ast$}]{interrupt\+\_\+manager,  }\item[{uint16\+\_\+t}]{time\+\_\+between\+\_\+events = {\ttfamily 10} }\end{DoxyParamCaption})}



{\bfseries{\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}}}} 

Constructor for the \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock}{Clock}} class


\begin{DoxyParams}{Parameters}
{\em interrupt\+\_\+manager} & The interrupt manager \\
\hline
{\em time\+\_\+between\+\_\+events} & The time between events in 10ths of a second \\
\hline
\end{DoxyParams}


Definition at line 54 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{55 : \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver_ad69102adf099f472b9eba69c5ae20d81}{Driver}}(),}
\DoxyCodeLine{56   \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptHandler_a23513de3e722d6f7183a9b51b1d86c48}{InterruptHandler}}(interrupt\_manager-\/>\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptManager_a722d6c304662665c41bd52558baddf59}{hardware\_interrupt\_offset}}(), interrupt\_manager),}
\DoxyCodeLine{57   \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad02999d90b05ffc6d7738cd633b3ec64}{m\_data\_port}}(0x71), \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a957d9b0d2c1cb0f253e7bbe768139b3e}{m\_command\_port}}(0x70),}
\DoxyCodeLine{58   \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7468dd1f25f9e84099c99c4f924138b5}{m\_ticks\_between\_events}}(time\_between\_events)}
\DoxyCodeLine{59 \{}
\DoxyCodeLine{60 }
\DoxyCodeLine{61 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_afc976ce68fa85e15cc06f9ed47bddb7c}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_afc976ce68fa85e15cc06f9ed47bddb7c}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!````~Clock@{$\sim$Clock}}
\index{````~Clock@{$\sim$Clock}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{$\sim$Clock()}{~Clock()}}
{\footnotesize\ttfamily Clock\+::$\sim$\+Clock (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 63 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{63               \{}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7d105f260a9197c78e77e0ba437f0168}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7d105f260a9197c78e77e0ba437f0168}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!activate@{activate}}
\index{activate@{activate}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{activate()}{activate()}}
{\footnotesize\ttfamily void Clock\+::activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Activates the clock, setting the binary coded decimal representation flag. 



Reimplemented from \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver_a92276c08d77279b6a86c900190ef797b}{max\+O\+S\+::drivers\+::\+Driver}}.



Definition at line 145 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{145                      \{}
\DoxyCodeLine{146 }
\DoxyCodeLine{147     \textcolor{comment}{// read the status register}}
\DoxyCodeLine{148     uint8\_t \mbox{\hyperlink{intel__i217_8h_ade818037fd6c985038ff29656089758d}{status}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0xb);}
\DoxyCodeLine{149 }
\DoxyCodeLine{150     \textcolor{comment}{// If the fourth bit is 0 the binary coded decimal representation is used}}
\DoxyCodeLine{151     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_abee5b3a5ce66060e8e252d807119bd17}{m\_binary\_coded\_decimal\_representation}} = (\mbox{\hyperlink{intel__i217_8h_ade818037fd6c985038ff29656089758d}{status}} \& 4) == 0;}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \textcolor{comment}{// Convert status to binary}}
\DoxyCodeLine{154     \textcolor{comment}{// 00001011 = 0x0B (status as an example)}}
\DoxyCodeLine{155     \textcolor{comment}{// 00000100 = 0x04 (binary mask used to extract fourth bit)}}
\DoxyCodeLine{156     \textcolor{comment}{// 00000000 = 0x00 (result of bitwise AND operation with binary mask)}}
\DoxyCodeLine{157     \textcolor{comment}{// 00000000 == 0 (check if fourth bit is 0 to determine if BCD is used)}}
\DoxyCodeLine{158 \}}

\end{DoxyCode}


References m\+\_\+binary\+\_\+coded\+\_\+decimal\+\_\+representation, read\+\_\+hardware\+\_\+clock(), and status.

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!binary\_representation@{binary\_representation}}
\index{binary\_representation@{binary\_representation}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{binary\_representation()}{binary\_representation()}}
{\footnotesize\ttfamily uint8\+\_\+t Clock\+::binary\+\_\+representation (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{number }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



The binary representation of a number. 


\begin{DoxyParams}{Parameters}
{\em number} & The number to convert \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The binary representation of the number if the binary coded decimal representation is used, otherwise the number 
\end{DoxyReturn}


Definition at line 131 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{131                                                    \{}
\DoxyCodeLine{132 }
\DoxyCodeLine{133     \textcolor{comment}{// If the binary coded decimal representation is not used, return the number}}
\DoxyCodeLine{134     \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_abee5b3a5ce66060e8e252d807119bd17}{m\_binary\_coded\_decimal\_representation}})}
\DoxyCodeLine{135         \textcolor{keywordflow}{return} number;}
\DoxyCodeLine{136 }
\DoxyCodeLine{137     \textcolor{comment}{// Otherwise, return the binary representation}}
\DoxyCodeLine{138     \textcolor{keywordflow}{return} (number \& 0xf) + ((number >> 4) \& 0xf) * 10;}
\DoxyCodeLine{139 }
\DoxyCodeLine{140 \}}

\end{DoxyCode}


References m\+\_\+binary\+\_\+coded\+\_\+decimal\+\_\+representation.



Referenced by handle\+\_\+interrupt().

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_abc9de19ed4bbd05fa8e449ef0df48ad5}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_abc9de19ed4bbd05fa8e449ef0df48ad5}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!delay@{delay}}
\index{delay@{delay}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{delay()}{delay()}}
{\footnotesize\ttfamily void Clock\+::delay (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{milliseconds }\end{DoxyParamCaption})}



Delays the program for a specified number of milliseconds (rounded to the nearest 100) 


\begin{DoxyParams}{Parameters}
{\em milliseconds} & How many milliseconds to delay the program for \\
\hline
\end{DoxyParams}


Definition at line 166 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{166                                        \{}
\DoxyCodeLine{167 }
\DoxyCodeLine{168         \textcolor{comment}{// Round the number of milliseconds to the nearest 100}}
\DoxyCodeLine{169         uint64\_t rounded\_milliseconds =  ((milliseconds+99)/100);}
\DoxyCodeLine{170 }
\DoxyCodeLine{171         \textcolor{comment}{// Calculate the number of ticks until the delay is over}}
\DoxyCodeLine{172         uint64\_t ticks\_until\_delay\_is\_over = m\_ticks + rounded\_milliseconds;}
\DoxyCodeLine{173 }
\DoxyCodeLine{174         \textcolor{comment}{// Wait until the number of ticks is equal to the number of ticks until the delay is over}}
\DoxyCodeLine{175         \textcolor{keywordflow}{while}(m\_ticks < ticks\_until\_delay\_is\_over)}
\DoxyCodeLine{176             \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"nop"}); \textcolor{comment}{// execute the "nop" assembly instruction, which does nothing, but prevents the compiler from optimizing away the loop}}
\DoxyCodeLine{177 \}}

\end{DoxyCode}


Referenced by kernel\+Main().

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad3eddc94ae13577816756ff70c72a02a}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad3eddc94ae13577816756ff70c72a02a}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!get\_device\_name@{get\_device\_name}}
\index{get\_device\_name@{get\_device\_name}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{get\_device\_name()}{get\_device\_name()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacemaxOS_a6a3d939df112a32e3a1655b764931088}{string}} Clock\+::get\+\_\+device\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Gets the name of the device. 

\begin{DoxyReturn}{Returns}
The name of the device 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver_a65b06f2917f7a781e68f3748e81806b6}{max\+O\+S\+::drivers\+::\+Driver}}.



Definition at line 191 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{191                               \{}
\DoxyCodeLine{192     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"Clock"};}
\DoxyCodeLine{193 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_afff456a86d73eda4507a2fe503485ac5}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_afff456a86d73eda4507a2fe503485ac5}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!get\_vendor\_name@{get\_vendor\_name}}
\index{get\_vendor\_name@{get\_vendor\_name}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{get\_vendor\_name()}{get\_vendor\_name()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacemaxOS_a6a3d939df112a32e3a1655b764931088}{string}} Clock\+::get\+\_\+vendor\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Gets the name of the vendor. 

\begin{DoxyReturn}{Returns}
The name of the vendor 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classmaxOS_1_1drivers_1_1Driver_a7ad761c929a49cfebd8c443f5af788f6}{max\+O\+S\+::drivers\+::\+Driver}}.



Definition at line 183 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{183                               \{}
\DoxyCodeLine{184     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"Generic"};}
\DoxyCodeLine{185 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_a1f0352d2346a3bef618e5c6f3bc71c0c}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_a1f0352d2346a3bef618e5c6f3bc71c0c}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!handle\_interrupt@{handle\_interrupt}}
\index{handle\_interrupt@{handle\_interrupt}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{handle\_interrupt()}{handle\_interrupt()}}
{\footnotesize\ttfamily void Clock\+::handle\+\_\+interrupt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Handle the R\+TC interrupt, raising the clock event if enough time has passed. 



Reimplemented from \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1InterruptHandler_abd792bc53ec7dd1b70c8386853cc3c33}{max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Handler}}.



Definition at line 71 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{71                              \{}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{comment}{// Increment the number of ticks and decrement the number of ticks until the next event}}
\DoxyCodeLine{74     m\_ticks++;}
\DoxyCodeLine{75     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_aaaef648bb176dd6d0370c68ea947f5db}{m\_ticks\_until\_next\_event}}-\/-\/;}
\DoxyCodeLine{76 }
\DoxyCodeLine{77     \textcolor{comment}{// If the number of ticks until the next event is not 0 then return}}
\DoxyCodeLine{78     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_aaaef648bb176dd6d0370c68ea947f5db}{m\_ticks\_until\_next\_event}} != 0)}
\DoxyCodeLine{79         \textcolor{keywordflow}{return};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{comment}{// Otherwise, reset the number of ticks until the next event}}
\DoxyCodeLine{82     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_aaaef648bb176dd6d0370c68ea947f5db}{m\_ticks\_until\_next\_event}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7468dd1f25f9e84099c99c4f924138b5}{m\_ticks\_between\_events}};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{comment}{// Create a time object}}
\DoxyCodeLine{85     \mbox{\hyperlink{structmaxOS_1_1common_1_1Time}{Time}} time;}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     \textcolor{comment}{// read the time from the hardware clock}}
\DoxyCodeLine{88     time.\mbox{\hyperlink{structmaxOS_1_1common_1_1Time_a86d6c04809c3486c006101b78a5b23b9}{year}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x9)) + 2000;              \textcolor{comment}{// Register 9 is the year}}
\DoxyCodeLine{89     time.\mbox{\hyperlink{structmaxOS_1_1common_1_1Time_a1542e33fbb0db70c4113b9e27c2854ea}{month}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x8));                    \textcolor{comment}{// Register 8 is the month}}
\DoxyCodeLine{90     time.\mbox{\hyperlink{structmaxOS_1_1common_1_1Time_ac26b1f3e8b092976593a0c62c0483590}{day}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x7));                      \textcolor{comment}{// Register 7 is the day}}
\DoxyCodeLine{91     time.\mbox{\hyperlink{structmaxOS_1_1common_1_1Time_af3fdeb24c9789abcefdd80d598ed6d3a}{hour}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x4));                     \textcolor{comment}{// Register 4 is the hour}}
\DoxyCodeLine{92     time.\mbox{\hyperlink{structmaxOS_1_1common_1_1Time_a36a11b71cdb3485594d9cb0eafe7287a}{minute}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x2));                   \textcolor{comment}{// Register 2 is the minute}}
\DoxyCodeLine{93     time.\mbox{\hyperlink{structmaxOS_1_1common_1_1Time_a33e31d4236e2640fb1f0616cf7f822b7}{second}} = \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ada9760529d0a4a5be681e5baea0c5178}{binary\_representation}}(\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}{read\_hardware\_clock}}(0x0));                   \textcolor{comment}{// Register 0 is the second}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95     \textcolor{comment}{//Raise the clock event}}
\DoxyCodeLine{96     \mbox{\hyperlink{classmaxOS_1_1common_1_1EventManager_ae4dfdc3945e73c5294538ac3912699bb}{raise\_event}}(\textcolor{keyword}{new} \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1TimeEvent}{TimeEvent}}(\&time));}
\DoxyCodeLine{97 \}}

\end{DoxyCode}


References binary\+\_\+representation(), max\+O\+S\+::common\+::\+Time\+::day, max\+O\+S\+::common\+::\+Time\+::hour, m\+\_\+ticks\+\_\+between\+\_\+events, m\+\_\+ticks\+\_\+until\+\_\+next\+\_\+event, max\+O\+S\+::common\+::\+Time\+::minute, max\+O\+S\+::common\+::\+Time\+::month, max\+O\+S\+::common\+::\+Event\+Manager$<$ Clock\+Events $>$\+::raise\+\_\+event(), read\+\_\+hardware\+\_\+clock(), max\+O\+S\+::common\+::\+Time\+::second, and max\+O\+S\+::common\+::\+Time\+::year.

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_a2d5265022c472412b5055cd6630097ed}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!read\_hardware\_clock@{read\_hardware\_clock}}
\index{read\_hardware\_clock@{read\_hardware\_clock}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{read\_hardware\_clock()}{read\_hardware\_clock()}}
{\footnotesize\ttfamily uint8\+\_\+t Clock\+::read\+\_\+hardware\+\_\+clock (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{address }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



read the current time from the hardware clock and return it 


\begin{DoxyParams}{Parameters}
{\em address} & The address of the register to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the register 
\end{DoxyReturn}


Definition at line 106 of file clock.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{107 \{}
\DoxyCodeLine{108     \textcolor{comment}{// If the address is a time or date register, disable updates}}
\DoxyCodeLine{109     \textcolor{keywordflow}{if}(\mbox{\hyperlink{amd__am79c973_8h_ac0d31ca829f934cccd89f8054e02773e}{address}} < 10)}
\DoxyCodeLine{110     \{}
\DoxyCodeLine{111       \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a957d9b0d2c1cb0f253e7bbe768139b3e}{m\_command\_port}}.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit_a6ede8fba6ba7e26c5982a91a3d5ffa72}{write}}(0xa);}
\DoxyCodeLine{112 }
\DoxyCodeLine{113         \textcolor{comment}{// Wait until any updates are finished}}
\DoxyCodeLine{114         \textcolor{keywordflow}{while}((\mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad02999d90b05ffc6d7738cd633b3ec64}{m\_data\_port}}.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit_a425297307d64cb5d9889b32767f8fdc3}{read}}() \& (1 << 7)) != 0)}
\DoxyCodeLine{115             \textcolor{keyword}{asm} \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"nop"}); \textcolor{comment}{// execute the "nop" assembly instruction, which does nothing, but prevents the compiler from optimizing away the loop}}
\DoxyCodeLine{116     \}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{comment}{// Send the address to the hardware clock}}
\DoxyCodeLine{119     \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_a957d9b0d2c1cb0f253e7bbe768139b3e}{m\_command\_port}}.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit_a6ede8fba6ba7e26c5982a91a3d5ffa72}{write}}(\mbox{\hyperlink{amd__am79c973_8h_ac0d31ca829f934cccd89f8054e02773e}{address}});}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{// read the value from the hardware clock}}
\DoxyCodeLine{122     \textcolor{keywordflow}{return} \mbox{\hyperlink{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad02999d90b05ffc6d7738cd633b3ec64}{m\_data\_port}}.\mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit_a425297307d64cb5d9889b32767f8fdc3}{read}}();}
\DoxyCodeLine{123 \}}

\end{DoxyCode}


References address, m\+\_\+command\+\_\+port, m\+\_\+data\+\_\+port, max\+O\+S\+::hardwarecommunication\+::\+Port8\+Bit\+::read(), and max\+O\+S\+::hardwarecommunication\+::\+Port8\+Bit\+::write().



Referenced by activate(), and handle\+\_\+interrupt().



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_abee5b3a5ce66060e8e252d807119bd17}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_abee5b3a5ce66060e8e252d807119bd17}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!m\_binary\_coded\_decimal\_representation@{m\_binary\_coded\_decimal\_representation}}
\index{m\_binary\_coded\_decimal\_representation@{m\_binary\_coded\_decimal\_representation}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_binary\_coded\_decimal\_representation}{m\_binary\_coded\_decimal\_representation}}
{\footnotesize\ttfamily bool max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+binary\+\_\+coded\+\_\+decimal\+\_\+representation\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 63 of file clock.\+h.



Referenced by activate(), and binary\+\_\+representation().

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_a957d9b0d2c1cb0f253e7bbe768139b3e}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_a957d9b0d2c1cb0f253e7bbe768139b3e}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!m\_command\_port@{m\_command\_port}}
\index{m\_command\_port@{m\_command\_port}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_command\_port}{m\_command\_port}}
{\footnotesize\ttfamily \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+command\+\_\+port\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 67 of file clock.\+h.



Referenced by read\+\_\+hardware\+\_\+clock().

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad02999d90b05ffc6d7738cd633b3ec64}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_ad02999d90b05ffc6d7738cd633b3ec64}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!m\_data\_port@{m\_data\_port}}
\index{m\_data\_port@{m\_data\_port}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_data\_port}{m\_data\_port}}
{\footnotesize\ttfamily \mbox{\hyperlink{classmaxOS_1_1hardwarecommunication_1_1Port8Bit}{hardwarecommunication\+::\+Port8\+Bit}} max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+data\+\_\+port\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 66 of file clock.\+h.



Referenced by read\+\_\+hardware\+\_\+clock().

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7468dd1f25f9e84099c99c4f924138b5}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_a7468dd1f25f9e84099c99c4f924138b5}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!m\_ticks\_between\_events@{m\_ticks\_between\_events}}
\index{m\_ticks\_between\_events@{m\_ticks\_between\_events}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_ticks\_between\_events}{m\_ticks\_between\_events}}
{\footnotesize\ttfamily uint16\+\_\+t max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+ticks\+\_\+between\+\_\+events \{ 0 \}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 70 of file clock.\+h.



Referenced by handle\+\_\+interrupt().

\mbox{\Hypertarget{classmaxOS_1_1drivers_1_1clock_1_1Clock_aaaef648bb176dd6d0370c68ea947f5db}\label{classmaxOS_1_1drivers_1_1clock_1_1Clock_aaaef648bb176dd6d0370c68ea947f5db}} 
\index{maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}!m\_ticks\_until\_next\_event@{m\_ticks\_until\_next\_event}}
\index{m\_ticks\_until\_next\_event@{m\_ticks\_until\_next\_event}!maxOS::drivers::clock::Clock@{maxOS::drivers::clock::Clock}}
\doxysubsubsection{\texorpdfstring{m\_ticks\_until\_next\_event}{m\_ticks\_until\_next\_event}}
{\footnotesize\ttfamily uint16\+\_\+t max\+O\+S\+::drivers\+::clock\+::\+Clock\+::m\+\_\+ticks\+\_\+until\+\_\+next\+\_\+event \{ 1 \}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 71 of file clock.\+h.



Referenced by handle\+\_\+interrupt().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/drivers/clock/\mbox{\hyperlink{clock_8h}{clock.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/drivers/clock/\mbox{\hyperlink{clock_8cpp}{clock.\+cpp}}\end{DoxyCompactItemize}
