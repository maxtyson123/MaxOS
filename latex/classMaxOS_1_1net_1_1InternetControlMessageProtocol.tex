\doxysection{Max\+OS\+::net\+::Internet\+Control\+Message\+Protocol Class Reference}
\hypertarget{classMaxOS_1_1net_1_1InternetControlMessageProtocol}{}\label{classMaxOS_1_1net_1_1InternetControlMessageProtocol}\index{MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}}


Handles ICMP packets.  




{\ttfamily \#include $<$icmp.\+h$>$}

Inheritance diagram for Max\+OS\+::net\+::Internet\+Control\+Message\+Protocol\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classMaxOS_1_1net_1_1InternetControlMessageProtocol}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetControlMessageProtocol_a11c0880c3da08a91f5bdbe3ec8def729}{Internet\+Control\+Message\+Protocol}} (\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{Internet\+Protocol\+Handler}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a8f837ba5e88224d46e5653239ffed050}{internet\+\_\+protocol\+\_\+handler}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} \texorpdfstring{$\ast$}{*}error\+\_\+messages)
\begin{DoxyCompactList}\small\item\em Constructs an \doxylink{classMaxOS_1_1net_1_1InternetControlMessageProtocol}{Internet\+Control\+Message\+Protocol} handler. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bool}} \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetControlMessageProtocol_a9413bfb3c0a3d3ca1ec8f82d067165ef}{handle\+\_\+internet\+\_\+protocol\+\_\+payload}} (\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{net\+::\+Internet\+Protocol\+Address}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{src\+\_\+ip\+\_\+be}}, \mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{net\+::\+Internet\+Protocol\+Address}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{dst\+\_\+ip\+\_\+be}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payload\+\_\+data}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} size) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Called by the Internet\+Protocol\+Provider when a new packet has arrived. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetControlMessageProtocol_afeca1f4bb9b443d4cbb79147d3504012}{request\+\_\+echo\+\_\+reply}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\+\_\+be}})
\begin{DoxyCompactList}\small\item\em Sends an ICMP echo request to the specified IP address. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles ICMP packets. 

Definition at line \mbox{\hyperlink{icmp_8h_source_l00041}{41}} of file \mbox{\hyperlink{icmp_8h_source}{icmp.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1net_1_1InternetControlMessageProtocol_a11c0880c3da08a91f5bdbe3ec8def729}\label{classMaxOS_1_1net_1_1InternetControlMessageProtocol_a11c0880c3da08a91f5bdbe3ec8def729} 
\index{MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}!InternetControlMessageProtocol@{InternetControlMessageProtocol}}
\index{InternetControlMessageProtocol@{InternetControlMessageProtocol}!MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}}
\doxysubsubsection{\texorpdfstring{InternetControlMessageProtocol()}{InternetControlMessageProtocol()}}
{\footnotesize\ttfamily Internet\+Control\+Message\+Protocol\+::\+Internet\+Control\+Message\+Protocol (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler}{Internet\+Protocol\+Handler}} \texorpdfstring{$\ast$}{*}}]{internet\+\_\+protocol\+\_\+handler,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1OutputStream}{common\+::\+Output\+Stream}} \texorpdfstring{$\ast$}{*}}]{error\+\_\+messages }\end{DoxyParamCaption})}



Constructs an \doxylink{classMaxOS_1_1net_1_1InternetControlMessageProtocol}{Internet\+Control\+Message\+Protocol} handler. 


\begin{DoxyParams}{Parameters}
{\em internet\+\_\+protocol\+\_\+handler} & The Internet protocol handler to use. \\
\hline
{\em error\+\_\+messages} & The output stream to use for error messages. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{icmp_8cpp_source_l00021}{21}} of file \mbox{\hyperlink{icmp_8cpp_source}{icmp.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00022\ :\ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler}{IPV4PayloadHandler}}(\mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a8f837ba5e88224d46e5653239ffed050}{internet\_protocol\_handler}},\ 0x01)}
\DoxyCodeLine{00023\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{this}\ -\/>\ error\_messages\ =\ error\_messages;}
\DoxyCodeLine{00025\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1net_1_1InternetControlMessageProtocol_a9413bfb3c0a3d3ca1ec8f82d067165ef}\label{classMaxOS_1_1net_1_1InternetControlMessageProtocol_a9413bfb3c0a3d3ca1ec8f82d067165ef} 
\index{MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}!handle\_internet\_protocol\_payload@{handle\_internet\_protocol\_payload}}
\index{handle\_internet\_protocol\_payload@{handle\_internet\_protocol\_payload}!MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}}
\doxysubsubsection{\texorpdfstring{handle\_internet\_protocol\_payload()}{handle\_internet\_protocol\_payload()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{bool}} Internet\+Control\+Message\+Protocol\+::handle\+\_\+internet\+\_\+protocol\+\_\+payload (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{net\+::\+Internet\+Protocol\+Address}}}]{src\+\_\+ip\+\_\+be,  }\item[{\mbox{\hyperlink{ipv4_8h_af037c025feb88b952b167f4dfa2709a0}{net\+::\+Internet\+Protocol\+Address}}}]{dst\+\_\+ip\+\_\+be,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{payload\+\_\+data,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Called by the Internet\+Protocol\+Provider when a new packet has arrived. 


\begin{DoxyParams}{Parameters}
{\em src\+\_\+ip\+\_\+be} & The source IP address of the packet \\
\hline
{\em dst\+\_\+ip\+\_\+be} & The destination IP address of the packet \\
\hline
{\em payload\+\_\+data} & The payload of the packet \\
\hline
{\em size} & The size of the payload\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the packet is to be sent back to the sender, false otherwise
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000072}{Todo}}]Reply to ping requests 

Implement the rest of the ICMP messages \end{DoxyRefDesc}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a0a77f0da7508cabc239b0f7830ef03dc}{Max\+OS\+::net\+::\+IPV4\+Payload\+Handler}}.



Definition at line \mbox{\hyperlink{icmp_8cpp_source_l00043}{43}} of file \mbox{\hyperlink{icmp_8cpp_source}{icmp.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00047\ \{}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ error\_messages\ -\/>\ write(\textcolor{stringliteral}{"{}ICMP\ received\ a\ packet\(\backslash\)n"{}});}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ size\ is\ at\ least\ the\ size\ of\ the\ header}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{if}(size\ <\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1ICMPHeader}{ICMPHeader}}))\{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ Cast\ the\ payload\ to\ the\ ICMP\ header}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{auto}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}\ =\ (\mbox{\hyperlink{structMaxOS_1_1net_1_1ICMPHeader}{ICMPHeader}}*)\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{payload\_data}};}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}\ -\/>\ type)\ \{}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 0:\ \textcolor{comment}{//\ Echo\ reply}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 8:\ \textcolor{comment}{//\ Echo\ request}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ response}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}\ -\/>\ type\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Echo\ reply}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}\ -\/>\ checksum\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ the\ checksum}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}\ -\/>\ checksum\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa31fa08acedfffa9bffac7b2ed7eb2ac}{InternetProtocolHandler::checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1ICMPHeader}{ICMPHeader}}));\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ checksum}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \ \ \ \textcolor{comment}{//Send\ data\ back}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ipv4_8cpp_source_l00249}{Max\+OS\+::net\+::\+Internet\+Protocol\+Handler\+::checksum()}}.

\Hypertarget{classMaxOS_1_1net_1_1InternetControlMessageProtocol_afeca1f4bb9b443d4cbb79147d3504012}\label{classMaxOS_1_1net_1_1InternetControlMessageProtocol_afeca1f4bb9b443d4cbb79147d3504012} 
\index{MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}!request\_echo\_reply@{request\_echo\_reply}}
\index{request\_echo\_reply@{request\_echo\_reply}!MaxOS::net::InternetControlMessageProtocol@{MaxOS::net::InternetControlMessageProtocol}}
\doxysubsubsection{\texorpdfstring{request\_echo\_reply()}{request\_echo\_reply()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Internet\+Control\+Message\+Protocol\+::request\+\_\+echo\+\_\+reply (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{ip\+\_\+be }\end{DoxyParamCaption})}



Sends an ICMP echo request to the specified IP address. 


\begin{DoxyParams}{Parameters}
{\em ip\+\_\+be} & The IP address to send the request to \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{icmp_8cpp_source_l00084}{84}} of file \mbox{\hyperlink{icmp_8cpp_source}{icmp.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ error\_messages\ -\/>\ write(\textcolor{stringliteral}{"{}ICMP:\ Sending\ echo\ request\(\backslash\)n"{}});}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \mbox{\hyperlink{structMaxOS_1_1net_1_1ICMPHeader}{ICMPHeader}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}\ =\ \{\};}
\DoxyCodeLine{00089\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}.type\ =\ 8;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Echo\ request}}
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}.code\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Code\ must\ be\ 0}}
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}.checksum\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Checksum\ must\ be\ 0\ to\ calculate\ it}}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}.data\ =\ 0x69420;\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Data}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}}.checksum\ =\ \mbox{\hyperlink{classMaxOS_1_1net_1_1InternetProtocolHandler_aa31fa08acedfffa9bffac7b2ed7eb2ac}{InternetProtocolHandler::checksum}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint16\_t}}*)\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1ICMPHeader}{ICMPHeader}}));}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1net_1_1IPV4PayloadHandler_a2bb888c9e34031fe53b58add430d604e}{send}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{ip\_be}},\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint8\_t}}*)\ \&\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{icmp}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1net_1_1ICMPHeader}{ICMPHeader}}));}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ error\_messages\ -\/>\ write(\textcolor{stringliteral}{"{}ICMP:\ Echo\ request\ sent\(\backslash\)n"{}});}
\DoxyCodeLine{00099\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ipv4_8cpp_source_l00249}{Max\+OS\+::net\+::\+Internet\+Protocol\+Handler\+::checksum()}}, and \mbox{\hyperlink{ipv4_8cpp_source_l00093}{Max\+OS\+::net\+::\+IPV4\+Payload\+Handler\+::send()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/net/\mbox{\hyperlink{icmp_8h}{icmp.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/net/\mbox{\hyperlink{icmp_8cpp}{icmp.\+cpp}}\end{DoxyCompactItemize}
