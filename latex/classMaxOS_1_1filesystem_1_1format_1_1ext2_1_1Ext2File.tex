\doxysection{Max\+OS\+::filesystem\+::format\+::ext2\+::Ext2\+File Class Reference}
\hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File}{}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File}\index{MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}}


Handles the file operations on the \doxylink{namespaceMaxOS_1_1filesystem_1_1format_1_1ext2}{ext2} filesystem.  




{\ttfamily \#include $<$ext2.\+h$>$}

Inheritance diagram for Max\+OS\+::filesystem\+::format\+::ext2\+::Ext2\+File\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ac988fbf181910b13ed53d4756065888a}{Ext2\+File}} (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume}{Ext2\+Volume}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{volume}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{ext2_8h_a84dc3916ea975b79482a6d01f78c3d9f}{inode}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \&\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ada67576556e0415df8bf213d0ce50991}{name}})
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_a59555eda52c9bb8f3e8b17d3e4454490}{\texorpdfstring{$\sim$}{\string~}\+Ext2\+File}} () final
\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ad53e374f2bbc5858d75c333381ae7bf3}{write}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Write data to the file (at the current seek position, updated to be += amount) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}} (\mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}) \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Read data from the file (at the current seek position, updated to be += amount) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_af68118731b5f4780d4971db82e44fc7f}{flush}} () \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{final}}
\begin{DoxyCompactList}\small\item\em Flush the file to the disk. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File}{Max\+OS\+::filesystem\+::\+File}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ae039af5807fc385f41b60644725d15d0}{File}} ()
\item 
virtual \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ac704ebdf5f57d7a1c5ddf409d797fb69}{\texorpdfstring{$\sim$}{\string~}\+File}} ()
\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_aa5315e6f1fdd27481ec88524041f2410}{seek}} (\mbox{\hyperlink{namespaceMaxOS_1_1filesystem_a873ee5a569a9920bf834c717148328c1}{Seek\+Type}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{seek\+\_\+type}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} offset)
\begin{DoxyCompactList}\small\item\em Seek to a position in the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_aae991c597c0bc4c5eb44c1f3b06a21ec}{position}} ()
\begin{DoxyCompactList}\small\item\em Get where the file is currently at (amount read/write/seeked) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a6797fd90178f476d319966e1fc6f501a}{size}} ()
\begin{DoxyCompactList}\small\item\em Get the size of the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ada67576556e0415df8bf213d0ce50991}{name}} ()
\begin{DoxyCompactList}\small\item\em Get the name of the file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File}{Max\+OS\+::filesystem\+::\+File}}}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\+\_\+offset}}
\item 
\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a98335b9c813e11733b3b12a7b4fb9087}{m\+\_\+name}}
\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\+\_\+size}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles the file operations on the \doxylink{namespaceMaxOS_1_1filesystem_1_1format_1_1ext2}{ext2} filesystem. 

Definition at line \mbox{\hyperlink{ext2_8h_source_l00314}{314}} of file \mbox{\hyperlink{ext2_8h_source}{ext2.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ac988fbf181910b13ed53d4756065888a}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ac988fbf181910b13ed53d4756065888a} 
\index{MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}!Ext2File@{Ext2File}}
\index{Ext2File@{Ext2File}!MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}}
\doxysubsubsection{\texorpdfstring{Ext2File()}{Ext2File()}}
{\footnotesize\ttfamily Ext2\+File\+::\+Ext2\+File (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume}{Ext2\+Volume}} \texorpdfstring{$\ast$}{*}}]{volume,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\+\_\+t}}}]{inode,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \&}]{name }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00698}{698}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00699\ :\ m\_volume(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{volume}}),}
\DoxyCodeLine{00700\ \ \ m\_inode(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{volume}},\ \mbox{\hyperlink{ext2_8h_a84dc3916ea975b79482a6d01f78c3d9f}{inode}})}
\DoxyCodeLine{00701\ \{}
\DoxyCodeLine{00702\ }
\DoxyCodeLine{00703\ \ \ \ \ \textcolor{comment}{//\ Set\ up\ the\ base\ information}}
\DoxyCodeLine{00704\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a98335b9c813e11733b3b12a7b4fb9087}{m\_name}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ada67576556e0415df8bf213d0ce50991}{name}};}
\DoxyCodeLine{00705\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}}\ =\ m\_inode.\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1InodeHandler_a8c54bf75f58ffc8c570c6d292f4f9168}{size}}();}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{filesystem_8h_source_l00033}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+name}}, \mbox{\hyperlink{filesystem_8h_source_l00034}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+size}}, \mbox{\hyperlink{filesystem_8cpp_source_l00078}{Max\+OS\+::filesystem\+::\+File\+::name()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00512}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::size()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_a59555eda52c9bb8f3e8b17d3e4454490}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_a59555eda52c9bb8f3e8b17d3e4454490} 
\index{MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}!````~Ext2File@{\texorpdfstring{$\sim$}{\string~}Ext2File}}
\index{````~Ext2File@{\texorpdfstring{$\sim$}{\string~}Ext2File}!MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}Ext2File()}{\string~Ext2File()}}
{\footnotesize\ttfamily Ext2\+File\+::\texorpdfstring{$\sim$}{\string~}\+Ext2\+File (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [default]}}



\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_af68118731b5f4780d4971db82e44fc7f}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_af68118731b5f4780d4971db82e44fc7f} 
\index{MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}!flush@{flush}}
\index{flush@{flush}!MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}}
\doxysubsubsection{\texorpdfstring{flush()}{flush()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+File\+::flush (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Flush the file to the disk. 



Reimplemented from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_af87fa862de707575b8badd044a5af80e}{Max\+OS\+::filesystem\+::\+File}}.



Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00815}{815}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00816\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_af87fa862de707575b8badd044a5af80e}{File::flush}}();}
\DoxyCodeLine{00817\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{filesystem_8cpp_source_l00037}{Max\+OS\+::filesystem\+::\+File\+::flush()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2} 
\index{MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}!read@{read}}
\index{read@{read}!MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}}
\doxysubsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+File\+::read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}}}]{amount }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Read data from the file (at the current seek position, updated to be += amount) 


\begin{DoxyParams}{Parameters}
{\em data} & The byte buffer to read into \\
\hline
{\em amount} & The amount of data to read \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a3385ab264cdca0faed533b17d701bab4}{Max\+OS\+::filesystem\+::\+File}}.



Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00769}{769}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00770\ }
\DoxyCodeLine{00771\ \ \ \ \ \textcolor{comment}{//\ Nothing\ to\ read}}
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}}\ ==\ 0\ ||\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ ==\ 0)}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{comment}{//\ Prepare\ for\ reading}}
\DoxyCodeLine{00776\ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{00777\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00778\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ buffer(\mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}});}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{comment}{//\ Force\ bounds}}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ >\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}})}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}};}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{comment}{//\ Convert\ bytes\ to\ blocks}}
\DoxyCodeLine{00785\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_start}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ /\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}};}
\DoxyCodeLine{00786\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_offset}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ \%\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}};}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{comment}{//\ Read\ each\ block}}
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_block}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_start}};}
\DoxyCodeLine{00790\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}}\ =\ 0;}
\DoxyCodeLine{00791\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}}\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})\ \{}
\DoxyCodeLine{00792\ }
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ the\ block}}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ =\ m\_inode.\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1InodeHandler_ac72b44dc162a6569a49869cc574007fd}{block\_cache}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_block}}++];}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}},\ \&buffer);}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Where\ in\ this\ block\ to\ start\ reading}}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_block}}\ -\/\ 1\ ==\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_start}})\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_offset}}\ :\ 0;}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{readable}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}}\ <\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}})\ ?\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}})\ :\ (\mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}});}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ the\ block}}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ buffer.copy\_to(\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{readable}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}},\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}});}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ab5f905fd00423326f163ef2acff681b2}{read}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{readable}};}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \ \ \ \ \}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \ \ \textcolor{comment}{//\ Clean\ up}}
\DoxyCodeLine{00808\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}};}
\DoxyCodeLine{00809\ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{00810\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ext2_8h_source_l00298}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::block\+\_\+cache}}, \mbox{\hyperlink{ext2_8h_source_l00006}{block\+\_\+size}}, \mbox{\hyperlink{ext2_8h_source_l00247}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::block\+\_\+size}}, \mbox{\hyperlink{buffer_8cpp_source_l00273}{Max\+OS\+::common\+::\+Buffer\+::copy\+\_\+to()}}, \mbox{\hyperlink{icmp_8h_source_l00004}{data}}, \mbox{\hyperlink{ext2_8h_source_l00258}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::ext2\+\_\+lock}}, \mbox{\hyperlink{spinlock_8cpp_source_l00022}{Max\+OS\+::common\+::\+Spinlock\+::lock()}}, \mbox{\hyperlink{filesystem_8h_source_l00032}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+offset}}, \mbox{\hyperlink{filesystem_8h_source_l00034}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+size}}, \mbox{\hyperlink{ext2_8cpp_source_l00769}{read()}}, \mbox{\hyperlink{ext2_8cpp_source_l00117}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::read\+\_\+block()}}, and \mbox{\hyperlink{spinlock_8cpp_source_l00031}{Max\+OS\+::common\+::\+Spinlock\+::unlock()}}.



Referenced by \mbox{\hyperlink{ext2_8cpp_source_l00769}{read()}}.

\Hypertarget{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ad53e374f2bbc5858d75c333381ae7bf3}\label{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2File_ad53e374f2bbc5858d75c333381ae7bf3} 
\index{MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}!write@{write}}
\index{write@{write}!MaxOS::filesystem::format::ext2::Ext2File@{MaxOS::filesystem::format::ext2::Ext2File}}
\doxysubsubsection{\texorpdfstring{write()}{write()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Ext2\+File\+::write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{const}} \mbox{\hyperlink{namespaceMaxOS_1_1common_ae34c2f95637029a49836360ddf075b3d}{common\+::buffer\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{data,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}}}]{amount }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [virtual]}}



Write data to the file (at the current seek position, updated to be += amount) 


\begin{DoxyParams}{Parameters}
{\em data} & The byte buffer to write \\
\hline
{\em amount} & The amount of data to write \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_acf705eb008519880b9a9d5db150eb6c8}{Max\+OS\+::filesystem\+::\+File}}.



Definition at line \mbox{\hyperlink{ext2_8cpp_source_l00715}{715}} of file \mbox{\hyperlink{ext2_8cpp_source}{ext2.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \ \ \textcolor{comment}{//\ Nothing\ to\ write}}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ ==\ 0)}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \ \ \textcolor{comment}{//\ Prepare\ for\ writing}}
\DoxyCodeLine{00722\ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}}\ =\ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a10014d7b0ae0cc94ea281d0e6ca56500}{block\_size}};}
\DoxyCodeLine{00724\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Buffer}{buffer\_t}}\ buffer(\mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}});}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ \ \ \textcolor{comment}{//\ Expand\ the\ file}}
\DoxyCodeLine{00727\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ >\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}})}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}}\ =\ m\_inode.\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1InodeHandler_a4bab1e2c0a08c16d2395cf4d3da64b04}{grow}}((\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})\ -\/\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_a2ea111d653133dd808f65809c969358f}{m\_size}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ updated\ metadata}}
\DoxyCodeLine{00731\ \ \ \ \ m\_inode.\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1InodeHandler_a4b3d8a3e59ad907e9117dcd68da4db23}{inode}}.last\_modification\_time\ =\ time\_to\_epoch(\mbox{\hyperlink{classMaxOS_1_1drivers_1_1clock_1_1Clock_af6e633c389f02276b3c76ee4ff2c65bb}{Clock::active\_clock}}()-\/>get\_time());}
\DoxyCodeLine{00732\ \ \ \ \ m\_inode.\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1InodeHandler_ae90957a35d01a04fedf9fdbe1a8fbd49}{save}}();}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{comment}{//\ Convert\ bytes\ to\ blocks}}
\DoxyCodeLine{00735\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_start}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ /\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}};}
\DoxyCodeLine{00736\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_offset}}\ =\ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ \%\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}};}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00738\ \ \ \ \ \textcolor{comment}{//\ Write\ each\ block}}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_block}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_start}};}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{written}}\ =\ 0;}
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{written}}\ <\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}})\ \{}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ the\ block}}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint32\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}}\ =\ m\_inode.\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1InodeHandler_ac72b44dc162a6569a49869cc574007fd}{block\_cache}}[\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_block}}++];}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_ae4dc8f1dc35d79da9a4a577cf66792f3}{read\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}},\ \&buffer);}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Where\ in\ this\ block\ to\ start\ writing}}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{current\_block}}\ -\/\ 1\ ==\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_start}})\ ?\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block\_offset}}\ :\ 0;}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{writable}}\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{written}}\ <\ \mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}})\ ?\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}}\ -\/\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{written}})\ :\ (\mbox{\hyperlink{ext2_8h_a9e3fb1e50a1c71b2337df296222d9553}{block\_size}}\ -\/}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}});}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ block}}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ buffer.copy\_from(\mbox{\hyperlink{icmp_8h_a1e43bf7d608e87228b625cca2c04d641}{data}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{writable}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{buffer\_start}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{written}});}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_aab2449336fe290292f64260781a4871b}{write\_block}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{block}},\ \&buffer);}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{written}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{writable}};}
\DoxyCodeLine{00756\ \ \ \ \ \}}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \ \ \textcolor{comment}{//\ Clean\ up}}
\DoxyCodeLine{00759\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1filesystem_1_1File_ad49f67cc5e79f5fa95d68a381843cec5}{m\_offset}}\ +=\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{amount}};}
\DoxyCodeLine{00760\ \ \ \ \ m\_volume-\/>\mbox{\hyperlink{classMaxOS_1_1filesystem_1_1format_1_1ext2_1_1Ext2Volume_a07e488e15a650d14870a5d9654b23193}{ext2\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{00761\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{clock_8cpp_source_l00223}{Max\+OS\+::drivers\+::clock\+::\+Clock\+::active\+\_\+clock()}}, \mbox{\hyperlink{ext2_8h_source_l00298}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::block\+\_\+cache}}, \mbox{\hyperlink{ext2_8h_source_l00006}{block\+\_\+size}}, \mbox{\hyperlink{ext2_8h_source_l00247}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::block\+\_\+size}}, \mbox{\hyperlink{buffer_8cpp_source_l00186}{Max\+OS\+::common\+::\+Buffer\+::copy\+\_\+from()}}, \mbox{\hyperlink{icmp_8h_source_l00004}{data}}, \mbox{\hyperlink{ext2_8h_source_l00258}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::ext2\+\_\+lock}}, \mbox{\hyperlink{ext2_8cpp_source_l00655}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::grow()}}, \mbox{\hyperlink{ext2_8h_source_l00297}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::inode}}, \mbox{\hyperlink{spinlock_8cpp_source_l00022}{Max\+OS\+::common\+::\+Spinlock\+::lock()}}, \mbox{\hyperlink{filesystem_8h_source_l00032}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+offset}}, \mbox{\hyperlink{filesystem_8h_source_l00034}{Max\+OS\+::filesystem\+::\+File\+::m\+\_\+size}}, \mbox{\hyperlink{ext2_8cpp_source_l00117}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::read\+\_\+block()}}, \mbox{\hyperlink{ext2_8cpp_source_l00677}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Inode\+Handler\+::save()}}, \mbox{\hyperlink{spinlock_8cpp_source_l00031}{Max\+OS\+::common\+::\+Spinlock\+::unlock()}}, and \mbox{\hyperlink{ext2_8cpp_source_l00068}{Max\+OS\+::filesystem\+::format\+::ext2\+::\+Ext2\+Volume\+::write\+\_\+block()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/filesystem/format/\mbox{\hyperlink{ext2_8h}{ext2.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/filesystem/format/\mbox{\hyperlink{ext2_8cpp}{ext2.\+cpp}}\end{DoxyCompactItemize}
