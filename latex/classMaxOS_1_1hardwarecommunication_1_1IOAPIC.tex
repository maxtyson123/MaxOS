\doxysection{Max\+OS\+::hardwarecommunication\+::IOAPIC Class Reference}
\hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC}{}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC}\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}


Handles the IO APIC in the system (one per system)  




{\ttfamily \#include $<$apic.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_af96fb9be587b8753b64904faf955da41}{IOAPIC}} (\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedConfigurationAndPowerInterface}{Advanced\+Configuration\+And\+Power\+Interface}} \texorpdfstring{$\ast$}{*}acpi)
\begin{DoxyCompactList}\small\item\em Construct a new IO APIC object. Maps the IO APIC registers and reads the \doxylink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT} to get information about the IO APICs and interrupt source overrides. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_aec2c3262b7e6ebf56328706c7a8c8cd2}{read}} (uint32\+\_\+t reg) const
\begin{DoxyCompactList}\small\item\em read a value from a IO Apic register \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a0f5338f88ec6ebd490e657d6a01ce7d3}{write}} (uint32\+\_\+t reg, uint32\+\_\+t value) const
\begin{DoxyCompactList}\small\item\em write a value to an IO Apic register \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a4b794a1a0c15a6262dbd6075961b37c2}{set\+\_\+redirect}} (\mbox{\hyperlink{apic_8h_a277b10c2f263e2d25f434864b883fefa}{interrupt\+\_\+redirect\+\_\+t}} \texorpdfstring{$\ast$}{*}redirect)
\begin{DoxyCompactList}\small\item\em Redirect a system interrupt to a different IRQ. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_ad082ec1b5e7905789976e043b67902ac}{set\+\_\+redirect\+\_\+mask}} (uint8\+\_\+t index, bool mask)
\begin{DoxyCompactList}\small\item\em Enables/\+Disables an interrupt redirect by masking it. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a755e766f9ea8a3d90b9d9ffa8c4bec3e}{get\+\_\+madt\+\_\+item}} (\mbox{\hyperlink{apic_8h_a61a67b8f6beb43e8dbf2ed85e52292b0}{MADT\+\_\+\+TYPE}} type, uint8\+\_\+t index)
\begin{DoxyCompactList}\small\item\em Get an item in the \doxylink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles the IO APIC in the system (one per system) 

Definition at line \mbox{\hyperlink{apic_8h_source_l00193}{193}} of file \mbox{\hyperlink{apic_8h_source}{apic.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_af96fb9be587b8753b64904faf955da41}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_af96fb9be587b8753b64904faf955da41} 
\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}!IOAPIC@{IOAPIC}}
\index{IOAPIC@{IOAPIC}!MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}
\doxysubsubsection{\texorpdfstring{IOAPIC()}{IOAPIC()}}
{\footnotesize\ttfamily IOAPIC\+::\+IOAPIC (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedConfigurationAndPowerInterface}{Advanced\+Configuration\+And\+Power\+Interface}} \texorpdfstring{$\ast$}{*}}]{acpi }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Construct a new IO APIC object. Maps the IO APIC registers and reads the \doxylink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT} to get information about the IO APICs and interrupt source overrides. 


\begin{DoxyParams}{Parameters}
{\em acpi} & The ACPI interface to get the \doxylink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT} from \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{apic_8cpp_source_l00198}{198}} of file \mbox{\hyperlink{apic_8cpp_source}{apic.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ :\ m\_acpi(acpi)}
\DoxyCodeLine{00200\ \{}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ information\ about\ the\ IO\ APIC}}
\DoxyCodeLine{00203\ \ \ \ \ m\_madt\ =\ (\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT}}*)\ m\_acpi-\/>\mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1AdvancedConfigurationAndPowerInterface_a8e9d8bd9fbb18e25419101be8d56aee2}{find}}(\textcolor{stringliteral}{"{}APIC"{}});}
\DoxyCodeLine{00204\ \ \ \ \ \mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}}*\ io\_apic\_item\ =\ \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a755e766f9ea8a3d90b9d9ffa8c4bec3e}{get\_madt\_item}}(MADT\_TYPE::IO\_APIC,\ 0);}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ IO\ APIC}}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keyword}{auto}*\ io\_apic\ =\ (\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADT__IO__APIC}{MADT\_IO\_APIC}}*)\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_a1ad616354df4569df849c6f1331cd4b4}{PhysicalMemoryManager::to\_io\_region}}((uint64\_t)\ io\_apic\_item\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}}));}
\DoxyCodeLine{00208\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_aac616421554f724ac8810d5bff76c3f1}{PhysicalMemoryManager::s\_current\_manager}}-\/>\mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_a732ea9bd93397bbddd596bee127ac8f3}{map}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{physical\_address\_t}}*)\ io\_apic\_item,\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{virtual\_address\_t}}*)\ (io\_apic\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}})),\ PRESENT\ |\ WRITE);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{comment}{//\ Map\ the\ IO\ APIC\ address\ to\ the\ higher\ half}}
\DoxyCodeLine{00211\ \ \ \ \ m\_address\ =\ io\_apic-\/>io\_apic\_address;}
\DoxyCodeLine{00212\ \ \ \ \ m\_address\_high\ =\ (uint64\_t)\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_a1ad616354df4569df849c6f1331cd4b4}{PhysicalMemoryManager::to\_io\_region}}(m\_address);}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_aac616421554f724ac8810d5bff76c3f1}{PhysicalMemoryManager::s\_current\_manager}}-\/>\mbox{\hyperlink{classMaxOS_1_1memory_1_1PhysicalMemoryManager_a732ea9bd93397bbddd596bee127ac8f3}{map}}((\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{physical\_address\_t}}*)\ m\_address,\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{virtual\_address\_t}}*)\ m\_address\_high,\ PRESENT\ |\ WRITE);}
\DoxyCodeLine{00214\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1Logger_a1df434c9cd82457b6830c0500731a601}{Logger::DEBUG}}()\ <<\ \textcolor{stringliteral}{"{}IO\ APIC\ Address:\ phy=0x"{}}\ <<\ m\_address\ <<\ \textcolor{stringliteral}{"{},\ virt=0x"{}}\ <<\ m\_address\_high\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ IO\ APIC\ version\ and\ max\ redirection\ entry}}
\DoxyCodeLine{00217\ \ \ \ \ m\_version\ =\ \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_aec2c3262b7e6ebf56328706c7a8c8cd2}{read}}(0x1);}
\DoxyCodeLine{00218\ \ \ \ \ m\_max\_redirect\_entry\ =\ (uint8\_t)\ (m\_version\ >>\ 16);}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{comment}{//\ Log\ the\ IO\ APIC\ information}}
\DoxyCodeLine{00221\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1Logger_a1df434c9cd82457b6830c0500731a601}{Logger::DEBUG}}()\ <<\ \textcolor{stringliteral}{"{}IO\ APIC\ Version:\ 0x"{}}\ <<\ (uint64\_t)\ (m\_version\ \&\ 0xFF)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00222\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1Logger_a1df434c9cd82457b6830c0500731a601}{Logger::DEBUG}}()\ <<\ \textcolor{stringliteral}{"{}IO\ APIC\ Max\ Redirection\ Entry:\ 0x"{}}\ <<\ (uint64\_t)\ m\_max\_redirect\_entry\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ source\ override\ item}}
\DoxyCodeLine{00225\ \ \ \ \ \mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}}*\ source\_override\_item\ =\ \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a755e766f9ea8a3d90b9d9ffa8c4bec3e}{get\_madt\_item}}(MADT\_TYPE::IO\_APIC,\ m\_override\_array\_size);}
\DoxyCodeLine{00226\ \ \ \ \ uint32\_t\ total\_length\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT}});}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordflow}{while}\ (total\_length\ <\ m\_madt-\/>header.length\ \&\&\ m\_override\_array\_size\ <\ 0x10)\ \{\ \textcolor{comment}{//\ 0x10\ is\ the\ max\ items}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ total\_length\ +=\ source\_override\_item-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry_ac2b72337ca1b563e9f0af618ea6aac08}{length}};}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ there\ is\ an\ override,\ populate\ the\ array}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (source\_override\_item\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ source\_override\_item-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry_a1f1291ec7e038308bcca72341c0d6d86}{type}}\ ==\ 2)\ \{}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ override\ and\ populate\ the\ array}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}*\ \textcolor{keyword}{override}\ =\ (\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override}{Override}}*)\ (source\_override\_item\ +\ 1);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ m\_override\_array[m\_override\_array\_size].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a7a966c37b284b11470c63189098a9b7f}{bus}}\ =\ \textcolor{keyword}{override}-\/>bus;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ m\_override\_array[m\_override\_array\_size].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a392523c46f36a7a67186bfbd29529fd5}{source}}\ =\ \textcolor{keyword}{override}-\/>source;}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ m\_override\_array[m\_override\_array\_size].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a52096e997dedf8c3f6d928cb6b69f0c0}{global\_system\_interrupt}}\ =\ \textcolor{keyword}{override}-\/>global\_system\_interrupt;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ m\_override\_array[m\_override\_array\_size].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a7b2854e157c0cf2293592d280dcffd67}{flags}}\ =\ \textcolor{keyword}{override}-\/>flags;}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ m\_override\_array\_size++;}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ next\ item}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ source\_override\_item\ =\ \mbox{\hyperlink{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a755e766f9ea8a3d90b9d9ffa8c4bec3e}{get\_madt\_item}}(MADT\_TYPE::IO\_APIC,\ m\_override\_array\_size);}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (source\_override\_item\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00247\ \ \ \ \ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1Logger_a1df434c9cd82457b6830c0500731a601}{Logger::DEBUG}}()\ <<\ \textcolor{stringliteral}{"{}IO\ APIC\ Source\ Overrides:\ 0x"{}}\ <<\ m\_override\_array\_size\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00250\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{apic_8h_source_l00182}{Max\+OS\+::hardwarecommunication\+::\+Override\+::bus}}, \mbox{\hyperlink{logger_8cpp_source_l00193}{Max\+OS\+::\+Logger\+::\+DEBUG()}}, \mbox{\hyperlink{acpi_8cpp_source_l00163}{Max\+OS\+::hardwarecommunication\+::\+Advanced\+Configuration\+And\+Power\+Interface\+::find()}}, \mbox{\hyperlink{apic_8h_source_l00185}{Max\+OS\+::hardwarecommunication\+::\+Override\+::flags}}, \mbox{\hyperlink{apic_8cpp_source_l00261}{get\+\_\+madt\+\_\+item()}}, \mbox{\hyperlink{apic_8h_source_l00184}{Max\+OS\+::hardwarecommunication\+::\+Override\+::global\+\_\+system\+\_\+interrupt}}, \mbox{\hyperlink{apic_8h_source_l00070}{Max\+OS\+::hardwarecommunication\+::\+MADTEntry\+::length}}, \mbox{\hyperlink{physical_8cpp_source_l00538}{Max\+OS\+::memory\+::\+Physical\+Memory\+Manager\+::map()}}, \mbox{\hyperlink{physical_8h_source_l00043}{Max\+OS\+::memory\+::\+PRESENT}}, \mbox{\hyperlink{apic_8cpp_source_l00297}{read()}}, \mbox{\hyperlink{physical_8h_source_l00185}{Max\+OS\+::memory\+::\+Physical\+Memory\+Manager\+::s\+\_\+current\+\_\+manager}}, \mbox{\hyperlink{apic_8h_source_l00183}{Max\+OS\+::hardwarecommunication\+::\+Override\+::source}}, \mbox{\hyperlink{physical_8cpp_source_l00915}{Max\+OS\+::memory\+::\+Physical\+Memory\+Manager\+::to\+\_\+io\+\_\+region()}}, \mbox{\hyperlink{apic_8h_source_l00069}{Max\+OS\+::hardwarecommunication\+::\+MADTEntry\+::type}}, and \mbox{\hyperlink{physical_8h_source_l00044}{Max\+OS\+::memory\+::\+WRITE}}.



\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a755e766f9ea8a3d90b9d9ffa8c4bec3e}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a755e766f9ea8a3d90b9d9ffa8c4bec3e} 
\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}!get\_madt\_item@{get\_madt\_item}}
\index{get\_madt\_item@{get\_madt\_item}!MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}
\doxysubsubsection{\texorpdfstring{get\_madt\_item()}{get\_madt\_item()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}} \texorpdfstring{$\ast$}{*} IOAPIC\+::get\+\_\+madt\+\_\+item (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{apic_8h_a61a67b8f6beb43e8dbf2ed85e52292b0}{MADT\+\_\+\+TYPE}}}]{type,  }\item[{uint8\+\_\+t}]{index }\end{DoxyParamCaption})}



Get an item in the \doxylink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT}. 


\begin{DoxyParams}{Parameters}
{\em type} & The type of item \\
\hline
{\em index} & The index of the item \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The item or null if not found 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{apic_8cpp_source_l00261}{261}} of file \mbox{\hyperlink{apic_8cpp_source}{apic.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{comment}{//\ The\ item\ starts\ at\ the\ start\ of\ the\ MADT}}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keyword}{auto}*\ item\ =\ (\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}}*)\ ((uint64\_t)\ m\_madt\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT}}));}
\DoxyCodeLine{00265\ \ \ \ \ uint64\_t\ total\_length\ =\ 0;}
\DoxyCodeLine{00266\ \ \ \ \ uint8\_t\ current\_index\ =\ 0;}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{comment}{//\ Loop\ through\ the\ items}}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{while}\ (total\_length\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADT}{MADT}})\ <\ m\_madt-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADT_aa20ab7143332d812b330ff3efe404529}{header}}.\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1ACPISDTHeader_a9b8a6a7e086a520cf52a4ea1cdc87670}{length}}\ \&\&\ current\_index\ <=\ index)\ \{}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Correct\ type}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (item-\/>type\ ==\ (uint8\_t)type)\ \{}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Correct\ index\ means\ found}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (current\_index\ ==\ index)}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ item;}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Right\ type\ wrong\ index\ so\ move\ on}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ current\_index++;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Increment\ the\ total\ length}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ total\_length\ +=\ item-\/>length;}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ item\ =\ (\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1MADTEntry}{MADTEntry}}*)\ ((uint64\_t)\ item\ +\ item-\/>length);}
\DoxyCodeLine{00285\ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{comment}{//\ No\ item\ found}}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00289\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{apic_8h_source_l00056}{Max\+OS\+::hardwarecommunication\+::\+MADT\+::header}}, \mbox{\hyperlink{acpi_8h_source_l00061}{Max\+OS\+::hardwarecommunication\+::\+ACPISDTHeader\+::length}}, and \mbox{\hyperlink{apic_8h_source_l00070}{Max\+OS\+::hardwarecommunication\+::\+MADTEntry\+::length}}.



Referenced by \mbox{\hyperlink{cpu_8cpp_source_l00527}{Max\+OS\+::system\+::\+CPU\+::find\+\_\+cores()}}, and \mbox{\hyperlink{apic_8cpp_source_l00198}{IOAPIC()}}.

\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_aec2c3262b7e6ebf56328706c7a8c8cd2}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_aec2c3262b7e6ebf56328706c7a8c8cd2} 
\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}!read@{read}}
\index{read@{read}!MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}
\doxysubsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily uint32\+\_\+t IOAPIC\+::read (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{reg }\end{DoxyParamCaption}) const}



read a value from a IO Apic register 


\begin{DoxyParams}{Parameters}
{\em reg} & The register to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value at the register 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{apic_8cpp_source_l00297}{297}} of file \mbox{\hyperlink{apic_8cpp_source}{apic.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{//\ Tell\ the\ APIC\ what\ register\ to\ read\ from}}
\DoxyCodeLine{00300\ \ \ \ \ *(\textcolor{keyword}{volatile}\ uint32\_t*)\ (m\_address\_high\ +\ 0x00)\ =\ reg;}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ value}}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordflow}{return}\ *(\textcolor{keyword}{volatile}\ uint32\_t*)\ (m\_address\_high\ +\ 0x10);}
\DoxyCodeLine{00304\ \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{apic_8cpp_source_l00198}{IOAPIC()}}.

\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a4b794a1a0c15a6262dbd6075961b37c2}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a4b794a1a0c15a6262dbd6075961b37c2} 
\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}!set\_redirect@{set\_redirect}}
\index{set\_redirect@{set\_redirect}!MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}
\doxysubsubsection{\texorpdfstring{set\_redirect()}{set\_redirect()}}
{\footnotesize\ttfamily void IOAPIC\+::set\+\_\+redirect (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{apic_8h_a277b10c2f263e2d25f434864b883fefa}{interrupt\+\_\+redirect\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{redirect }\end{DoxyParamCaption})}



Redirect a system interrupt to a different IRQ. 


\begin{DoxyParams}{Parameters}
{\em redirect} & The redirection entry \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{apic_8cpp_source_l00365}{365}} of file \mbox{\hyperlink{apic_8cpp_source}{apic.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{comment}{//\ Create\ the\ redirection\ entry}}
\DoxyCodeLine{00368\ \ \ \ \ \mbox{\hyperlink{unionMaxOS_1_1hardwarecommunication_1_1RedirectionEntry}{RedirectionEntry}}\ entry\ =\ \{\};}
\DoxyCodeLine{00369\ \ \ \ \ entry.\mbox{\hyperlink{unionMaxOS_1_1hardwarecommunication_1_1RedirectionEntry_aa32d100a3e49b6c0f5b07d1566415dc2}{raw}}\ =\ redirect-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a66e385615027b38ab772dfa150053ade}{flags}}\ |\ (redirect-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a28f96793915501b0a202a4e34e9f1426}{interrupt}}\ \&\ 0xFF);}
\DoxyCodeLine{00370\ \ \ \ \ entry.destination\ =\ redirect-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_abae45c69e03fe32708e2e795526e34b8}{destination}};}
\DoxyCodeLine{00371\ \ \ \ \ entry.mask\ =\ redirect-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a74924917fd3f253b298c092e1b5fc719}{mask}};}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ a\ global\ system\ interrupt\ is\ used}}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{for}\ (uint8\_t\ i\ =\ 0;\ i\ <\ m\_override\_array\_size;\ i++)\ \{}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_override\_array[i].source\ !=\ redirect-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a76765f5aa84e5fb559be5ec37eb8d5d8}{type}})}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ lower\ 4\ bits\ of\ the\ pin}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ entry.pin\_polarity\ =\ ((m\_override\_array[i].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a7b2854e157c0cf2293592d280dcffd67}{flags}}\ \&\ 0b11)\ ==\ 2)\ ?\ 0b1\ :\ 0b0;}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ entry.pin\_polarity\ =\ (((m\_override\_array[i].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a7b2854e157c0cf2293592d280dcffd67}{flags}}\ >>\ 2)\ \&\ 0b11)\ ==\ 2)\ ?\ 0b1\ :\ 0b0;}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ trigger\ mode}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ entry.trigger\_mode\ =\ (((m\_override\_array[i].\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1Override_a7b2854e157c0cf2293592d280dcffd67}{flags}}\ >>\ 2)\ \&\ 0b11)\ ==\ 2);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ redirect}}
\DoxyCodeLine{00390\ \ \ \ \ write\_redirect(redirect-\/>\mbox{\hyperlink{structMaxOS_1_1hardwarecommunication_1_1InterruptRedirect_a2053b8d74b7cd332244eab0ea86aa656}{index}},\ \&entry);}
\DoxyCodeLine{00391\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{apic_8h_source_l00167}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::destination}}, \mbox{\hyperlink{apic_8h_source_l00168}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::flags}}, \mbox{\hyperlink{apic_8h_source_l00185}{Max\+OS\+::hardwarecommunication\+::\+Override\+::flags}}, \mbox{\hyperlink{apic_8h_source_l00165}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::index}}, \mbox{\hyperlink{apic_8h_source_l00166}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::interrupt}}, \mbox{\hyperlink{apic_8h_source_l00169}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::mask}}, \mbox{\hyperlink{apic_8h_source_l00137}{Max\+OS\+::hardwarecommunication\+::\+Redirection\+Entry\+::raw}}, and \mbox{\hyperlink{apic_8h_source_l00164}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Redirect\+::type}}.



Referenced by \mbox{\hyperlink{interrupts_8cpp_source_l00024}{Max\+OS\+::hardwarecommunication\+::\+Interrupt\+Handler\+::\+Interrupt\+Handler()}}.

\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_ad082ec1b5e7905789976e043b67902ac}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_ad082ec1b5e7905789976e043b67902ac} 
\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}!set\_redirect\_mask@{set\_redirect\_mask}}
\index{set\_redirect\_mask@{set\_redirect\_mask}!MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}
\doxysubsubsection{\texorpdfstring{set\_redirect\_mask()}{set\_redirect\_mask()}}
{\footnotesize\ttfamily void IOAPIC\+::set\+\_\+redirect\+\_\+mask (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{index,  }\item[{bool}]{mask }\end{DoxyParamCaption})}



Enables/\+Disables an interrupt redirect by masking it. 


\begin{DoxyParams}{Parameters}
{\em index} & The index of the redirect mask \\
\hline
{\em mask} & True = masked = disabled, False = unmasked = enabled \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{apic_8cpp_source_l00399}{399}} of file \mbox{\hyperlink{apic_8cpp_source}{apic.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ current\ entry}}
\DoxyCodeLine{00402\ \ \ \ \ \mbox{\hyperlink{unionMaxOS_1_1hardwarecommunication_1_1RedirectionEntry}{RedirectionEntry}}\ entry\ =\ \{\};}
\DoxyCodeLine{00403\ \ \ \ \ read\_redirect(index,\ \&entry);}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ mask}}
\DoxyCodeLine{00406\ \ \ \ \ entry.mask\ =\ mask;}
\DoxyCodeLine{00407\ \ \ \ \ write\_redirect(index,\ \&entry);}
\DoxyCodeLine{00408\ \}}

\end{DoxyCode}
\Hypertarget{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a0f5338f88ec6ebd490e657d6a01ce7d3}\label{classMaxOS_1_1hardwarecommunication_1_1IOAPIC_a0f5338f88ec6ebd490e657d6a01ce7d3} 
\index{MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}!write@{write}}
\index{write@{write}!MaxOS::hardwarecommunication::IOAPIC@{MaxOS::hardwarecommunication::IOAPIC}}
\doxysubsubsection{\texorpdfstring{write()}{write()}}
{\footnotesize\ttfamily void IOAPIC\+::write (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{reg,  }\item[{uint32\+\_\+t}]{value }\end{DoxyParamCaption}) const}



write a value to an IO Apic register 


\begin{DoxyParams}{Parameters}
{\em reg} & The register to write to \\
\hline
{\em value} & The value to set the register to \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{apic_8cpp_source_l00312}{312}} of file \mbox{\hyperlink{apic_8cpp_source}{apic.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ register}}
\DoxyCodeLine{00315\ \ \ \ \ *(\textcolor{keyword}{volatile}\ uint32\_t*)\ (m\_address\_high\ +\ 0x00)\ =\ reg;}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ value}}
\DoxyCodeLine{00318\ \ \ \ \ *(\textcolor{keyword}{volatile}\ uint32\_t*)\ (m\_address\_high\ +\ 0x10)\ =\ value;}
\DoxyCodeLine{00319\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/hardwarecommunication/\mbox{\hyperlink{apic_8h}{apic.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/hardwarecommunication/\mbox{\hyperlink{apic_8cpp}{apic.\+cpp}}\end{DoxyCompactItemize}
