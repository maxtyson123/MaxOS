\hypertarget{classMaxOS_1_1processes_1_1IPC}{}\doxysection{Max\+OS\+::processes\+::I\+PC Class Reference}
\label{classMaxOS_1_1processes_1_1IPC}\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}}


Handles Inter \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} Communication.  




{\ttfamily \#include $<$ipc.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a0a5158a361abb5a79cc36edbd8691e51}{I\+PC}} ()
\begin{DoxyCompactList}\small\item\em Creates a new \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC}{I\+PC}} handler. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a3fb6d83264099113bd5dbe4335815d64}{$\sim$\+I\+PC}} ()
\item 
\mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\+\_\+shared\+\_\+memory\+\_\+t}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a7a84fd2462f6dde7b3d02a8507babf36}{alloc\+\_\+shared\+\_\+memory}} (size\+\_\+t \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}}, \mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}})
\begin{DoxyCompactList}\small\item\em Creates a new shared memory block. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\+\_\+shared\+\_\+memory\+\_\+t}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a1d30e314818d217f118206c4d6e3af63}{get\+\_\+shared\+\_\+memory}} (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}})
\begin{DoxyCompactList}\small\item\em Gets a shared memory block by name. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a78ed192a2a3ccf5adf62b0da158e6cf4}{free\+\_\+shared\+\_\+memory}} (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}})
\begin{DoxyCompactList}\small\item\em Deletes a shared memory block by name. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a48cff6f1c5d3c02660a7992f22956a83}{free\+\_\+shared\+\_\+memory}} (uintptr\+\_\+t \mbox{\hyperlink{physical_8h_a069784144afa0b45c14ce1788adb541a}{physical\+\_\+address}})
\begin{DoxyCompactList}\small\item\em Deletes a shared memory block by physical address. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ac998b6244bb23dbc1bb7f512deeca1f0}{free\+\_\+shared\+\_\+memory}} (\mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\+\_\+shared\+\_\+memory\+\_\+t}} $\ast$block)
\begin{DoxyCompactList}\small\item\em Deletes a shared memory block. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a1c52e342829c31824807764c1bb12212}{create\+\_\+message\+\_\+endpoint}} (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}})
\begin{DoxyCompactList}\small\item\em Creates a endpoint for message passing. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$ \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a1477ee935d9fea46245a87cd0ae6064f}{get\+\_\+message\+\_\+endpoint}} (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}})
\begin{DoxyCompactList}\small\item\em Gets a message endpoint by name. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ae5f931c3d0f6263aab2184f666f59cf3}{free\+\_\+message\+\_\+endpoint}} (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}})
\begin{DoxyCompactList}\small\item\em Deletes a message endpoint by name, all messages will be lost. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ac8ef1fa507c027239331f48f32c34472}{free\+\_\+message\+\_\+endpoint}} (\mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$endpoint)
\begin{DoxyCompactList}\small\item\em Deletes a message endpoint, all messages will be lost. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ae5cb0f1d442e889b85ecc9dc2db18125}{send\+\_\+message}} (\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}} \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}, void $\ast$message, size\+\_\+t \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}})
\begin{DoxyCompactList}\small\item\em Finds the endpoint by name and adds a message to it\textquotesingle{}s queue. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ae4b289955f0dbdfa36ee7911d71e8a9c}{send\+\_\+message}} (\mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$endpoint, void $\ast$message, size\+\_\+t \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles Inter \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} Communication. 

Definition at line 53 of file ipc.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a0a5158a361abb5a79cc36edbd8691e51}\label{classMaxOS_1_1processes_1_1IPC_a0a5158a361abb5a79cc36edbd8691e51}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!IPC@{IPC}}
\index{IPC@{IPC}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{IPC()}{IPC()}}
{\footnotesize\ttfamily I\+P\+C\+::\+I\+PC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Creates a new \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC}{I\+PC}} handler. 



Definition at line 16 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{16          \{}
\DoxyCodeLine{17 }
\DoxyCodeLine{18   \textcolor{comment}{// Clear the spinlock}}
\DoxyCodeLine{19   m\_lock = \mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock}{Spinlock}}();}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a3fb6d83264099113bd5dbe4335815d64}\label{classMaxOS_1_1processes_1_1IPC_a3fb6d83264099113bd5dbe4335815d64}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!````~IPC@{$\sim$IPC}}
\index{````~IPC@{$\sim$IPC}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{$\sim$IPC()}{~IPC()}}
{\footnotesize\ttfamily I\+P\+C\+::$\sim$\+I\+PC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 24 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{24           \{}
\DoxyCodeLine{25 }
\DoxyCodeLine{26   \textcolor{comment}{// Free all the shared memory}}
\DoxyCodeLine{27   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} block : m\_shared\_memory\_blocks)\{}
\DoxyCodeLine{28         \textcolor{keyword}{delete} block -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}};}
\DoxyCodeLine{29         \textcolor{keyword}{delete} block;}
\DoxyCodeLine{30   \}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \}}

\end{DoxyCode}


References name.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a7a84fd2462f6dde7b3d02a8507babf36}\label{classMaxOS_1_1processes_1_1IPC_a7a84fd2462f6dde7b3d02a8507babf36}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!alloc\_shared\_memory@{alloc\_shared\_memory}}
\index{alloc\_shared\_memory@{alloc\_shared\_memory}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{alloc\_shared\_memory()}{alloc\_shared\_memory()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\+\_\+shared\+\_\+memory\+\_\+t}} $\ast$ I\+P\+C\+::alloc\+\_\+shared\+\_\+memory (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{size,  }\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name }\end{DoxyParamCaption})}



Creates a new shared memory block. 


\begin{DoxyParams}{Parameters}
{\em size} & The size of the block \\
\hline
{\em name} & The name of the block \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The shared memory block 
\end{DoxyReturn}


Definition at line 41 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{41                                                                       \{}
\DoxyCodeLine{42 }
\DoxyCodeLine{43   \textcolor{comment}{// Wait for the lock}}
\DoxyCodeLine{44   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   \textcolor{comment}{// Make sure the name is unique}}
\DoxyCodeLine{47   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} endpoint : m\_message\_endpoints)\{}
\DoxyCodeLine{48     \textcolor{keywordflow}{if}(endpoint -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}} -\/> \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebca0d26bc92125bc5319c2e929ab6e06079}{equals}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}))\{}
\DoxyCodeLine{49       m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{50       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{51     \}}
\DoxyCodeLine{52   \}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{comment}{// Create the shared memory block}}
\DoxyCodeLine{55   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory}{ipc\_shared\_memory\_t}}* block = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\_shared\_memory\_t}};}
\DoxyCodeLine{56   block -\/> \mbox{\hyperlink{physical_8h_a069784144afa0b45c14ce1788adb541a}{physical\_address}}  = (uintptr\_t)PhysicalMemoryManager::s\_current\_manager -\/> allocate\_area(0, \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}});}
\DoxyCodeLine{57   block -\/> \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}}              = \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}};}
\DoxyCodeLine{58   block -\/> use\_count         = 1;}
\DoxyCodeLine{59   block -\/> owner\_pid         = \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ab49af6f7dc81af748175b2578b179ff5}{Scheduler::get\_current\_process}}()-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_a56b7359906f289d7054247885002e2e5}{get\_pid}}();}
\DoxyCodeLine{60   block -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}              = \textcolor{keyword}{new} \mbox{\hyperlink{classMaxOS_1_1String}{String}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}});}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \textcolor{comment}{// Add the block to the list}}
\DoxyCodeLine{63   m\_shared\_memory\_blocks.push\_back(block);}
\DoxyCodeLine{64 }
\DoxyCodeLine{65   \textcolor{comment}{// Clear the lock}}
\DoxyCodeLine{66   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"Created shared memory block \%s at 0x\%x\(\backslash\)n"}, \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}.c\_str(), block -\/> \mbox{\hyperlink{physical_8h_a069784144afa0b45c14ce1788adb541a}{physical\_address}});}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{comment}{// Return the block}}
\DoxyCodeLine{71   \textcolor{keywordflow}{return} block;}
\DoxyCodeLine{72 \}}

\end{DoxyCode}


References \+\_\+kprintf, Max\+O\+S\+::drivers\+::peripherals\+::equals, Max\+O\+S\+::processes\+::\+Scheduler\+::get\+\_\+current\+\_\+process(), Max\+O\+S\+::processes\+::\+Process\+::get\+\_\+pid(), name, physical\+\_\+address, and size.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a1c52e342829c31824807764c1bb12212}\label{classMaxOS_1_1processes_1_1IPC_a1c52e342829c31824807764c1bb12212}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!create\_message\_endpoint@{create\_message\_endpoint}}
\index{create\_message\_endpoint@{create\_message\_endpoint}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{create\_message\_endpoint()}{create\_message\_endpoint()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$ I\+P\+C\+::create\+\_\+message\+\_\+endpoint (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name }\end{DoxyParamCaption})}



Creates a endpoint for message passing. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the endpoint \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The endpoint 
\end{DoxyReturn}


Definition at line 175 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{175                                                                 \{}
\DoxyCodeLine{176 }
\DoxyCodeLine{177   \textcolor{comment}{// Wait for the lock}}
\DoxyCodeLine{178   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{179 }
\DoxyCodeLine{180   \textcolor{comment}{// Make sure the name is unique}}
\DoxyCodeLine{181   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageEndpoint}{ipc\_message\_endpoint\_t}}* existing = \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a1477ee935d9fea46245a87cd0ae6064f}{get\_message\_endpoint}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}});}
\DoxyCodeLine{182   \textcolor{keywordflow}{if}(existing != \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{183       m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{184       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{185   \}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187   \textcolor{comment}{// Create the endpoint (With the queue on in the user's memory space)}}
\DoxyCodeLine{188   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageEndpoint}{ipc\_message\_endpoint\_t}}* endpoint = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\_message\_endpoint\_t}};}
\DoxyCodeLine{189   endpoint -\/> queue = (\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageQueue}{ipc\_message\_queue\_t}}*)MemoryManager::malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageQueue}{ipc\_message\_queue\_t}}));}
\DoxyCodeLine{190   endpoint -\/> queue -\/> messages = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{191   endpoint -\/> owner\_pid = \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ab49af6f7dc81af748175b2578b179ff5}{Scheduler::get\_current\_process}}() -\/> get\_pid();}
\DoxyCodeLine{192   endpoint -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}} = \textcolor{keyword}{new} \mbox{\hyperlink{classMaxOS_1_1String}{String}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}});}
\DoxyCodeLine{193 }
\DoxyCodeLine{194   \textcolor{comment}{// Add the endpoint to the list}}
\DoxyCodeLine{195   m\_message\_endpoints.push\_back(endpoint);}
\DoxyCodeLine{196 }
\DoxyCodeLine{197   \textcolor{comment}{// Free the lock}}
\DoxyCodeLine{198   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{199 }
\DoxyCodeLine{200   \textcolor{comment}{// Return the endpoint}}
\DoxyCodeLine{201   \textcolor{keywordflow}{return} endpoint;}
\DoxyCodeLine{202 \}}

\end{DoxyCode}


References Max\+O\+S\+::processes\+::\+Scheduler\+::get\+\_\+current\+\_\+process(), and name.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_ac8ef1fa507c027239331f48f32c34472}\label{classMaxOS_1_1processes_1_1IPC_ac8ef1fa507c027239331f48f32c34472}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!free\_message\_endpoint@{free\_message\_endpoint}}
\index{free\_message\_endpoint@{free\_message\_endpoint}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{free\_message\_endpoint()}{free\_message\_endpoint()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void I\+P\+C\+::free\+\_\+message\+\_\+endpoint (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$}]{endpoint }\end{DoxyParamCaption})}



Deletes a message endpoint, all messages will be lost. 


\begin{DoxyParams}{Parameters}
{\em endpoint} & \\
\hline
\end{DoxyParams}


Definition at line 241 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{241                                                                 \{}
\DoxyCodeLine{242 }
\DoxyCodeLine{243   \textcolor{comment}{// Make sure the endpoint exists}}
\DoxyCodeLine{244   \textcolor{keywordflow}{if}(endpoint == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{245      \textcolor{keywordflow}{return};}
\DoxyCodeLine{246 }
\DoxyCodeLine{247   \textcolor{comment}{// Make sure the endpoint is owned by the current process}}
\DoxyCodeLine{248   \textcolor{keywordflow}{if}(endpoint -\/> owner\_pid != \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ab49af6f7dc81af748175b2578b179ff5}{Scheduler::get\_current\_process}}() -\/> get\_pid())}
\DoxyCodeLine{249       \textcolor{keywordflow}{return};}
\DoxyCodeLine{250 }
\DoxyCodeLine{251   \textcolor{comment}{// Wait for the lock}}
\DoxyCodeLine{252   endpoint -\/> message\_lock.lock();}
\DoxyCodeLine{253 }
\DoxyCodeLine{254   \textcolor{comment}{// Delete the messages}}
\DoxyCodeLine{255   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}* message = endpoint -\/> queue -\/> messages;}
\DoxyCodeLine{256   \textcolor{keywordflow}{while}(message != \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{257       \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}* \mbox{\hyperlink{virtual_8h_a20e8ff4d4c943d29eee7cfd80a5ff0f3}{next}} = (\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}*)message -\/> next\_message;}
\DoxyCodeLine{258       \textcolor{keyword}{delete} message;}
\DoxyCodeLine{259       message = \mbox{\hyperlink{virtual_8h_a20e8ff4d4c943d29eee7cfd80a5ff0f3}{next}};}
\DoxyCodeLine{260   \}}
\DoxyCodeLine{261   \textcolor{keyword}{delete} endpoint -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}};}
\DoxyCodeLine{262 }
\DoxyCodeLine{263   \textcolor{comment}{// Free the lock (nothing can be done to it now that the name isn't there)}}
\DoxyCodeLine{264   endpoint -\/> message\_lock.unlock();}
\DoxyCodeLine{265 }
\DoxyCodeLine{266   \textcolor{comment}{// Delete the endpoint}}
\DoxyCodeLine{267   \textcolor{keyword}{delete} endpoint;}
\DoxyCodeLine{268 }
\DoxyCodeLine{269 \}}

\end{DoxyCode}


References Max\+O\+S\+::processes\+::\+Scheduler\+::get\+\_\+current\+\_\+process(), name, and next.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_ae5f931c3d0f6263aab2184f666f59cf3}\label{classMaxOS_1_1processes_1_1IPC_ae5f931c3d0f6263aab2184f666f59cf3}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!free\_message\_endpoint@{free\_message\_endpoint}}
\index{free\_message\_endpoint@{free\_message\_endpoint}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{free\_message\_endpoint()}{free\_message\_endpoint()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void I\+P\+C\+::free\+\_\+message\+\_\+endpoint (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name }\end{DoxyParamCaption})}



Deletes a message endpoint by name, all messages will be lost. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the endpoint \\
\hline
\end{DoxyParams}


Definition at line 227 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{227                                            \{}
\DoxyCodeLine{228 }
\DoxyCodeLine{229   \textcolor{comment}{// Find the endpoint}}
\DoxyCodeLine{230   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageEndpoint}{ipc\_message\_endpoint\_t}}* endpoint = \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a1477ee935d9fea46245a87cd0ae6064f}{get\_message\_endpoint}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}});}
\DoxyCodeLine{231 }
\DoxyCodeLine{232   \textcolor{comment}{// Free the endpoint}}
\DoxyCodeLine{233   \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ae5f931c3d0f6263aab2184f666f59cf3}{free\_message\_endpoint}}(endpoint);}
\DoxyCodeLine{234 }
\DoxyCodeLine{235 \}}

\end{DoxyCode}


References name.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_ac998b6244bb23dbc1bb7f512deeca1f0}\label{classMaxOS_1_1processes_1_1IPC_ac998b6244bb23dbc1bb7f512deeca1f0}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!free\_shared\_memory@{free\_shared\_memory}}
\index{free\_shared\_memory@{free\_shared\_memory}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{free\_shared\_memory()}{free\_shared\_memory()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void I\+P\+C\+::free\+\_\+shared\+\_\+memory (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\+\_\+shared\+\_\+memory\+\_\+t}} $\ast$}]{block }\end{DoxyParamCaption})}



Deletes a shared memory block. 


\begin{DoxyParams}{Parameters}
{\em block} & The block to delete (will only free memory if no one is using it) \\
\hline
\end{DoxyParams}


Definition at line 143 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{143                                                        \{}
\DoxyCodeLine{144 }
\DoxyCodeLine{145   \textcolor{comment}{// Wait for the lock}}
\DoxyCodeLine{146   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{147 }
\DoxyCodeLine{148   \textcolor{comment}{// Decrement the use count}}
\DoxyCodeLine{149   block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_ac3823e1763f5c8db75ae189cd17a3b30}{use\_count}}-\/-\/;}
\DoxyCodeLine{150 }
\DoxyCodeLine{151   \textcolor{comment}{// If the block is still in use}}
\DoxyCodeLine{152   \textcolor{keywordflow}{if} (block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_ac3823e1763f5c8db75ae189cd17a3b30}{use\_count}} > 0) \{}
\DoxyCodeLine{153     m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{154     \textcolor{keywordflow}{return};}
\DoxyCodeLine{155   \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157   \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\_kprintf}}(\textcolor{stringliteral}{"Deleting shared memory block \%s at 0x\%x\(\backslash\)n"}, block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_a7f49b6936d9f0d7d556ad0a2376f37de}{name}}-\/>\mbox{\hyperlink{classMaxOS_1_1String_a2af521b9de69dcbe3f1125390fbb3b5a}{c\_str}}(), block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_a1f60d921fae8fb9aa8991215561b6674}{physical\_address}});}
\DoxyCodeLine{158 }
\DoxyCodeLine{159   \textcolor{comment}{// Free the block}}
\DoxyCodeLine{160   PhysicalMemoryManager::s\_current\_manager-\/>free\_area(block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_a1f60d921fae8fb9aa8991215561b6674}{physical\_address}}, block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_a6d1434ed1aae638f2d3bd3a209ddfe01}{size}});}
\DoxyCodeLine{161   \textcolor{keyword}{delete} block-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCSharedMemory_a7f49b6936d9f0d7d556ad0a2376f37de}{name}};}
\DoxyCodeLine{162   \textcolor{keyword}{delete} block;}
\DoxyCodeLine{163 }
\DoxyCodeLine{164   \textcolor{comment}{// Clear the lock}}
\DoxyCodeLine{165   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 \}}

\end{DoxyCode}


References \+\_\+kprintf, Max\+O\+S\+::\+String\+::c\+\_\+str(), Max\+O\+S\+::processes\+::\+I\+P\+C\+Shared\+Memory\+::name, Max\+O\+S\+::processes\+::\+I\+P\+C\+Shared\+Memory\+::physical\+\_\+address, Max\+O\+S\+::processes\+::\+I\+P\+C\+Shared\+Memory\+::size, and Max\+O\+S\+::processes\+::\+I\+P\+C\+Shared\+Memory\+::use\+\_\+count.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a78ed192a2a3ccf5adf62b0da158e6cf4}\label{classMaxOS_1_1processes_1_1IPC_a78ed192a2a3ccf5adf62b0da158e6cf4}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!free\_shared\_memory@{free\_shared\_memory}}
\index{free\_shared\_memory@{free\_shared\_memory}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{free\_shared\_memory()}{free\_shared\_memory()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void I\+P\+C\+::free\+\_\+shared\+\_\+memory (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name }\end{DoxyParamCaption})}



Deletes a shared memory block by name. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the block \\
\hline
\end{DoxyParams}


Definition at line 122 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{122                                         \{}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{comment}{// Find the block}}
\DoxyCodeLine{126   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} block : m\_shared\_memory\_blocks) \{}
\DoxyCodeLine{127 }
\DoxyCodeLine{128     \textcolor{comment}{// Check if the block is the one we are looking for}}
\DoxyCodeLine{129     \textcolor{keywordflow}{if} (!block-\/>name-\/>equals(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}))}
\DoxyCodeLine{130       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{131 }
\DoxyCodeLine{132     \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a78ed192a2a3ccf5adf62b0da158e6cf4}{free\_shared\_memory}}(block);}
\DoxyCodeLine{133 }
\DoxyCodeLine{134   \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 }
\DoxyCodeLine{137 \}}

\end{DoxyCode}


References name.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a48cff6f1c5d3c02660a7992f22956a83}\label{classMaxOS_1_1processes_1_1IPC_a48cff6f1c5d3c02660a7992f22956a83}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!free\_shared\_memory@{free\_shared\_memory}}
\index{free\_shared\_memory@{free\_shared\_memory}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{free\_shared\_memory()}{free\_shared\_memory()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void I\+P\+C\+::free\+\_\+shared\+\_\+memory (\begin{DoxyParamCaption}\item[{uintptr\+\_\+t}]{physical\+\_\+address }\end{DoxyParamCaption})}



Deletes a shared memory block by physical address. 


\begin{DoxyParams}{Parameters}
{\em physical\+\_\+address} & The physical address of the block \\
\hline
\end{DoxyParams}


Definition at line 105 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{105                                                        \{}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{comment}{// Find the block}}
\DoxyCodeLine{108     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} block : m\_shared\_memory\_blocks)\{}
\DoxyCodeLine{109 }
\DoxyCodeLine{110         \textcolor{keywordflow}{if}(block -\/> \mbox{\hyperlink{physical_8h_a069784144afa0b45c14ce1788adb541a}{physical\_address}} == \mbox{\hyperlink{physical_8h_a069784144afa0b45c14ce1788adb541a}{physical\_address}})\{}
\DoxyCodeLine{111             \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a78ed192a2a3ccf5adf62b0da158e6cf4}{free\_shared\_memory}}(block);}
\DoxyCodeLine{112             \textcolor{keywordflow}{return};}
\DoxyCodeLine{113         \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \}}
\DoxyCodeLine{116 \}}

\end{DoxyCode}


References physical\+\_\+address.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a1477ee935d9fea46245a87cd0ae6064f}\label{classMaxOS_1_1processes_1_1IPC_a1477ee935d9fea46245a87cd0ae6064f}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!get\_message\_endpoint@{get\_message\_endpoint}}
\index{get\_message\_endpoint@{get\_message\_endpoint}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{get\_message\_endpoint()}{get\_message\_endpoint()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$ I\+P\+C\+::get\+\_\+message\+\_\+endpoint (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name }\end{DoxyParamCaption})}



Gets a message endpoint by name. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the endpoint \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The endpoint or nullptr if not found 
\end{DoxyReturn}


Definition at line 210 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{210                                                              \{}
\DoxyCodeLine{211 }
\DoxyCodeLine{212   \textcolor{comment}{// Try to find the endpoint}}
\DoxyCodeLine{213   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} endpoint : m\_message\_endpoints)\{}
\DoxyCodeLine{214       \textcolor{keywordflow}{if}(endpoint -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}} -\/> \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebca0d26bc92125bc5319c2e929ab6e06079}{equals}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}))}
\DoxyCodeLine{215         \textcolor{keywordflow}{return} endpoint;}
\DoxyCodeLine{216   \}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218   \textcolor{comment}{// Not found}}
\DoxyCodeLine{219   \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{220 }
\DoxyCodeLine{221 \}}

\end{DoxyCode}


References Max\+O\+S\+::drivers\+::peripherals\+::equals, and name.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_a1d30e314818d217f118206c4d6e3af63}\label{classMaxOS_1_1processes_1_1IPC_a1d30e314818d217f118206c4d6e3af63}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!get\_shared\_memory@{get\_shared\_memory}}
\index{get\_shared\_memory@{get\_shared\_memory}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{get\_shared\_memory()}{get\_shared\_memory()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_1_1processes_ad2fdd6fa127f86549146d7b6a4c8e2ce}{ipc\+\_\+shared\+\_\+memory\+\_\+t}} $\ast$ I\+P\+C\+::get\+\_\+shared\+\_\+memory (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name }\end{DoxyParamCaption})}



Gets a shared memory block by name. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the block \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The shared memory block or nullptr if not found 
\end{DoxyReturn}


Definition at line 79 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{79                                                        \{}
\DoxyCodeLine{80 }
\DoxyCodeLine{81   \textcolor{comment}{// Wait for the lock}}
\DoxyCodeLine{82   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{83 }
\DoxyCodeLine{84   \textcolor{comment}{// Find the block}}
\DoxyCodeLine{85   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} block : m\_shared\_memory\_blocks)\{}
\DoxyCodeLine{86       \textcolor{keywordflow}{if}(block -\/> \mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}} -\/> \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebca0d26bc92125bc5319c2e929ab6e06079}{equals}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}}))\{}
\DoxyCodeLine{87         block -\/> use\_count++;}
\DoxyCodeLine{88         m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{89         \textcolor{keywordflow}{return} block;}
\DoxyCodeLine{90       \}}
\DoxyCodeLine{91   \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93   \textcolor{comment}{// Clear the lock}}
\DoxyCodeLine{94   m\_lock.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{comment}{// Not found}}
\DoxyCodeLine{97   \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \}}

\end{DoxyCode}


References Max\+O\+S\+::drivers\+::peripherals\+::equals, and name.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_ae4b289955f0dbdfa36ee7911d71e8a9c}\label{classMaxOS_1_1processes_1_1IPC_ae4b289955f0dbdfa36ee7911d71e8a9c}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!send\_message@{send\_message}}
\index{send\_message@{send\_message}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{send\_message()}{send\_message()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void I\+P\+C\+::send\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_1_1processes_a1ad72215b1069f4fe18a04cf8990e8a3}{ipc\+\_\+message\+\_\+endpoint\+\_\+t}} $\ast$}]{endpoint,  }\item[{void $\ast$}]{message,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}



Definition at line 291 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{291                                                                                    \{}
\DoxyCodeLine{292 }
\DoxyCodeLine{293   \textcolor{comment}{// Wait for the endpoint lock}}
\DoxyCodeLine{294   endpoint -\/> message\_lock.lock();}
\DoxyCodeLine{295 }
\DoxyCodeLine{296   \textcolor{comment}{// Copy the buffer into the kernel so that the endpoint can access it}}
\DoxyCodeLine{297   \textcolor{keywordtype}{void}* kernel\_copy = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[\mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}}];}
\DoxyCodeLine{298   \mbox{\hyperlink{memoryIO_8h_aa9250664b209e69cb6aec30d9b7da564}{memcpy}}(kernel\_copy, message, \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}});}
\DoxyCodeLine{299 }
\DoxyCodeLine{300   \textcolor{comment}{//Switch to endpoint's memory space}}
\DoxyCodeLine{301   MemoryManager::switch\_active\_memory\_manager(\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a51b58af8b283f0f98131dd2d6ce51540}{Scheduler::get\_process}}(endpoint -\/> owner\_pid) -\/> memory\_manager);}
\DoxyCodeLine{302 }
\DoxyCodeLine{303   \textcolor{comment}{// Create the message \& copy it into the endpoint's memory space}}
\DoxyCodeLine{304   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}* new\_message = (\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}*)MemoryManager::malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}));}
\DoxyCodeLine{305   \textcolor{keywordtype}{void}* new\_buffer = MemoryManager::malloc(\mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}});}
\DoxyCodeLine{306   new\_message -\/> message\_buffer = \mbox{\hyperlink{memoryIO_8h_aa9250664b209e69cb6aec30d9b7da564}{memcpy}}(new\_buffer, kernel\_copy, \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}});}
\DoxyCodeLine{307   new\_message -\/> message\_size = \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}};}
\DoxyCodeLine{308   new\_message -\/> next\_message = 0;}
\DoxyCodeLine{309 }
\DoxyCodeLine{310   \textcolor{comment}{// Add the message to the end of the queue}}
\DoxyCodeLine{311   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}* current = endpoint -\/> queue -\/> messages;}
\DoxyCodeLine{312   \textcolor{keywordflow}{while}(current != \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{313     \textcolor{keywordflow}{if}(current -\/> next\_message == 0)\{}
\DoxyCodeLine{314       current -\/> next\_message = (uintptr\_t)new\_message;}
\DoxyCodeLine{315       \textcolor{keywordflow}{break};}
\DoxyCodeLine{316     \}}
\DoxyCodeLine{317     current = (\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessage}{ipc\_message\_t}}*)current -\/> next\_message;}
\DoxyCodeLine{318   \}}
\DoxyCodeLine{319 }
\DoxyCodeLine{320   \textcolor{comment}{// If it was the first message}}
\DoxyCodeLine{321   \textcolor{keywordflow}{if} (current == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{322     endpoint-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageEndpoint_a038c4efd6d3a0929934bce566ba5f9bc}{queue}}-\/>\mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageQueue_ae57b53545fbfbc9d3c805d8672fb72b7}{messages}} = new\_message;}
\DoxyCodeLine{323 }
\DoxyCodeLine{324   \textcolor{comment}{//Switch back from endpoint's memory space}}
\DoxyCodeLine{325   MemoryManager::switch\_active\_memory\_manager(\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ab49af6f7dc81af748175b2578b179ff5}{Scheduler::get\_current\_process}}() -\/> memory\_manager);}
\DoxyCodeLine{326 }
\DoxyCodeLine{327   \textcolor{comment}{// Free the lock \& kernel copy}}
\DoxyCodeLine{328   \textcolor{keyword}{delete} kernel\_copy;}
\DoxyCodeLine{329   endpoint -\/> message\_lock.unlock();}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 \}}

\end{DoxyCode}


References Max\+O\+S\+::processes\+::\+Scheduler\+::get\+\_\+current\+\_\+process(), Max\+O\+S\+::processes\+::\+Scheduler\+::get\+\_\+process(), memcpy(), Max\+O\+S\+::processes\+::\+I\+P\+C\+Message\+Queue\+::messages, Max\+O\+S\+::processes\+::\+I\+P\+C\+Message\+Endpoint\+::queue, and size.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1IPC_ae5cb0f1d442e889b85ecc9dc2db18125}\label{classMaxOS_1_1processes_1_1IPC_ae5cb0f1d442e889b85ecc9dc2db18125}} 
\index{MaxOS::processes::IPC@{MaxOS::processes::IPC}!send\_message@{send\_message}}
\index{send\_message@{send\_message}!MaxOS::processes::IPC@{MaxOS::processes::IPC}}
\doxysubsubsection{\texorpdfstring{send\_message()}{send\_message()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void I\+P\+C\+::send\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespaceMaxOS_afa22b691550d34d82dd6a5e3f77b31cb}{string}}}]{name,  }\item[{void $\ast$}]{message,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}



Finds the endpoint by name and adds a message to it\textquotesingle{}s queue. 


\begin{DoxyParams}{Parameters}
{\em name} & The name of the endpoint \\
\hline
{\em message} & The message to send \\
\hline
{\em size} & The size of the message \\
\hline
\end{DoxyParams}


Definition at line 277 of file ipc.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{277                                                               \{}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 }
\DoxyCodeLine{280   \textcolor{comment}{// Find the endpoint}}
\DoxyCodeLine{281   \mbox{\hyperlink{structMaxOS_1_1processes_1_1IPCMessageEndpoint}{ipc\_message\_endpoint\_t}}* endpoint = \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_a1477ee935d9fea46245a87cd0ae6064f}{get\_message\_endpoint}}(\mbox{\hyperlink{fat32_8h_abfa8a0ef7b1321866a7c4099554fdfb0}{name}});}
\DoxyCodeLine{282   \textcolor{keywordflow}{if}(endpoint == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{283       \textcolor{keywordflow}{return};}
\DoxyCodeLine{284 }
\DoxyCodeLine{285 }
\DoxyCodeLine{286   \textcolor{comment}{// Send the message}}
\DoxyCodeLine{287   \mbox{\hyperlink{classMaxOS_1_1processes_1_1IPC_ae5cb0f1d442e889b85ecc9dc2db18125}{send\_message}}(endpoint, message, \mbox{\hyperlink{fat32_8h_ab2c6b258f02add8fdf4cfc7c371dd772}{size}});}
\DoxyCodeLine{288 }
\DoxyCodeLine{289 }
\DoxyCodeLine{290 \}}

\end{DoxyCode}


References name, and size.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/processes/\mbox{\hyperlink{ipc_8h}{ipc.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/processes/\mbox{\hyperlink{ipc_8cpp}{ipc.\+cpp}}\end{DoxyCompactItemize}
