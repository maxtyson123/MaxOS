\hypertarget{classmaxOS_1_1system_1_1ThreadManager}{}\doxysection{max\+OS\+::system\+::Thread\+Manager Class Reference}
\label{classmaxOS_1_1system_1_1ThreadManager}\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}


Manages the scheduling of threads.  




{\ttfamily \#include $<$multithreading.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_a613b13ebf45502e4d86c2f9317ec5871}{Thread\+Manager}} ()
\item 
\mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_a4583df9128ae79a4f9b1b419db80fbbe}{Thread\+Manager}} (\mbox{\hyperlink{classmaxOS_1_1system_1_1GlobalDescriptorTable}{system\+::\+Global\+Descriptor\+Table}} $\ast$gdt)
\item 
\mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_a18eb12d3d752075318c3672c8efffd5b}{$\sim$\+Thread\+Manager}} ()
\item 
int \mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_ac7bad00a6e546e8e40ccaeb6c6563464}{create\+\_\+thread}} (void entrypoint())
\begin{DoxyCompactList}\small\item\em Add a thread to an empty place in the array. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structmaxOS_1_1system_1_1CPUState}{C\+P\+U\+State}} $\ast$ \mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_adb9a4c54a2bb144b4d50cae4ca6a6066}{schedule}} (\mbox{\hyperlink{structmaxOS_1_1system_1_1CPUState}{C\+P\+U\+State}} $\ast$cpu\+\_\+state)
\begin{DoxyCompactList}\small\item\em Schedules the next thread to be executed by checking its yields\+Status. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_abb113874c6b8d0f021cdd0b54249d4eb}{terminate\+\_\+thread}} (int tid)
\begin{DoxyCompactList}\small\item\em Terminates a thread. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Manages the scheduling of threads. 

Definition at line 40 of file multithreading.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classmaxOS_1_1system_1_1ThreadManager_a613b13ebf45502e4d86c2f9317ec5871}\label{classmaxOS_1_1system_1_1ThreadManager_a613b13ebf45502e4d86c2f9317ec5871}} 
\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}!ThreadManager@{ThreadManager}}
\index{ThreadManager@{ThreadManager}!maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}
\doxysubsubsection{\texorpdfstring{ThreadManager()}{ThreadManager()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Thread\+Manager\+::\+Thread\+Manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 40 of file multithreading.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{41 \{}
\DoxyCodeLine{42 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmaxOS_1_1system_1_1ThreadManager_a4583df9128ae79a4f9b1b419db80fbbe}\label{classmaxOS_1_1system_1_1ThreadManager_a4583df9128ae79a4f9b1b419db80fbbe}} 
\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}!ThreadManager@{ThreadManager}}
\index{ThreadManager@{ThreadManager}!maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}
\doxysubsubsection{\texorpdfstring{ThreadManager()}{ThreadManager()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Thread\+Manager\+::\+Thread\+Manager (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmaxOS_1_1system_1_1GlobalDescriptorTable}{system\+::\+Global\+Descriptor\+Table}} $\ast$}]{gdt }\end{DoxyParamCaption})}



Definition at line 44 of file multithreading.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{45 \{ m\_gdt = gdt;}
\DoxyCodeLine{46 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmaxOS_1_1system_1_1ThreadManager_a18eb12d3d752075318c3672c8efffd5b}\label{classmaxOS_1_1system_1_1ThreadManager_a18eb12d3d752075318c3672c8efffd5b}} 
\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}!````~ThreadManager@{$\sim$ThreadManager}}
\index{````~ThreadManager@{$\sim$ThreadManager}!maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}
\doxysubsubsection{\texorpdfstring{$\sim$ThreadManager()}{~ThreadManager()}}
{\footnotesize\ttfamily Thread\+Manager\+::$\sim$\+Thread\+Manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 48 of file multithreading.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{49 \{}
\DoxyCodeLine{50 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmaxOS_1_1system_1_1ThreadManager_ac7bad00a6e546e8e40ccaeb6c6563464}\label{classmaxOS_1_1system_1_1ThreadManager_ac7bad00a6e546e8e40ccaeb6c6563464}} 
\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}!create\_thread@{create\_thread}}
\index{create\_thread@{create\_thread}!maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}
\doxysubsubsection{\texorpdfstring{create\_thread()}{create\_thread()}}
{\footnotesize\ttfamily int Thread\+Manager\+::create\+\_\+thread (\begin{DoxyParamCaption}\item[{void }]{entrypoint() }\end{DoxyParamCaption})}



Add a thread to an empty place in the array. 


\begin{DoxyParams}{Parameters}
{\em \mbox{\hyperlink{classmaxOS_1_1system_1_1Thread}{Thread}}} & thread to add \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if successfully added 

false if error 
\end{DoxyReturn}


Definition at line 59 of file multithreading.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{60 \{}
\DoxyCodeLine{61     \textcolor{comment}{// Create a new thread}}
\DoxyCodeLine{62     \mbox{\hyperlink{classmaxOS_1_1system_1_1Thread}{Thread}}* new\_thread = \textcolor{keyword}{new} \mbox{\hyperlink{classmaxOS_1_1system_1_1Thread}{Thread}}();}
\DoxyCodeLine{63     new\_thread -\/> init(m\_gdt, entrypoint);}
\DoxyCodeLine{64     new\_thread -\/> m\_tid = m\_threads.size();}
\DoxyCodeLine{65     new\_thread -\/> m\_cpu\_state -\/> \mbox{\hyperlink{multitasking_8h_a8519dc239502dfcbac171b3128dc7054}{cs}} = m\_gdt-\/> code\_segment\_selector();}
\DoxyCodeLine{66 }
\DoxyCodeLine{67     \textcolor{comment}{// Add the thread to the array}}
\DoxyCodeLine{68     m\_threads.push\_back(new\_thread);}
\DoxyCodeLine{69     \textcolor{keywordflow}{return} new\_thread -\/> m\_tid;}
\DoxyCodeLine{70 \}}

\end{DoxyCode}


References cs.

\mbox{\Hypertarget{classmaxOS_1_1system_1_1ThreadManager_adb9a4c54a2bb144b4d50cae4ca6a6066}\label{classmaxOS_1_1system_1_1ThreadManager_adb9a4c54a2bb144b4d50cae4ca6a6066}} 
\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}!schedule@{schedule}}
\index{schedule@{schedule}!maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}
\doxysubsubsection{\texorpdfstring{schedule()}{schedule()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmaxOS_1_1system_1_1CPUState}{C\+P\+U\+State}} $\ast$ Thread\+Manager\+::schedule (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmaxOS_1_1system_1_1CPUState}{C\+P\+U\+State}} $\ast$}]{cpu\+\_\+state }\end{DoxyParamCaption})}



Schedules the next thread to be executed by checking its yields\+Status. 


\begin{DoxyParams}{Parameters}
{\em cpu\+\_\+state} & state \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
C\+P\+U\+State$\ast$ The state of the next thread to be executed 
\end{DoxyReturn}


Definition at line 78 of file multithreading.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{79 \{}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{comment}{// If the eax register is 37, terminate the thread}}
\DoxyCodeLine{82     \textcolor{keywordflow}{if}(cpu\_state-\/> \mbox{\hyperlink{multitasking_8h_a93d929ad1fc57af9d4f1793c361fb4f2}{eax}} == 37)}
\DoxyCodeLine{83       \mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_abb113874c6b8d0f021cdd0b54249d4eb}{terminate\_thread}}(m\_current\_thread);}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     \textcolor{comment}{// If there are no threads to schedule, return the current state}}
\DoxyCodeLine{86     \textcolor{keywordflow}{if} (m\_threads.size() <= 0 || m\_threads[m\_current\_thread] == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{87         \textcolor{keywordflow}{return} cpu\_state;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \textcolor{comment}{// Save the current state}}
\DoxyCodeLine{90     m\_threads[m\_current\_thread]-\/>m\_cpu\_state = cpu\_state;}
\DoxyCodeLine{91 }
\DoxyCodeLine{92     \textcolor{comment}{// Switch to the next thread}}
\DoxyCodeLine{93     \textcolor{keywordflow}{if}(++m\_current\_thread >= m\_threads.size())}
\DoxyCodeLine{94       m\_current\_thread \%= m\_threads.size();}
\DoxyCodeLine{95 }
\DoxyCodeLine{96     \textcolor{comment}{// If this thread is yielded then skip it}}
\DoxyCodeLine{97     \textcolor{keywordflow}{if}(m\_threads[m\_current\_thread]-\/>m\_yield\_status)\{}
\DoxyCodeLine{98       m\_threads[m\_current\_thread]-\/>m\_yield\_status = \textcolor{keyword}{false};}
\DoxyCodeLine{99         \textcolor{keywordflow}{return} \mbox{\hyperlink{classmaxOS_1_1system_1_1ThreadManager_adb9a4c54a2bb144b4d50cae4ca6a6066}{schedule}}(cpu\_state);}
\DoxyCodeLine{100     \}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102     \textcolor{comment}{// Return the next thread's state}}
\DoxyCodeLine{103     \textcolor{keywordflow}{return} m\_threads[m\_current\_thread]-\/>m\_cpu\_state;}
\DoxyCodeLine{104 \}}

\end{DoxyCode}


References eax, and terminate\+\_\+thread().



Referenced by max\+O\+S\+::hardwarecommunication\+::\+Interrupt\+Manager\+::handle\+\_\+interrupt\+\_\+request().

\mbox{\Hypertarget{classmaxOS_1_1system_1_1ThreadManager_abb113874c6b8d0f021cdd0b54249d4eb}\label{classmaxOS_1_1system_1_1ThreadManager_abb113874c6b8d0f021cdd0b54249d4eb}} 
\index{maxOS::system::ThreadManager@{maxOS::system::ThreadManager}!terminate\_thread@{terminate\_thread}}
\index{terminate\_thread@{terminate\_thread}!maxOS::system::ThreadManager@{maxOS::system::ThreadManager}}
\doxysubsubsection{\texorpdfstring{terminate\_thread()}{terminate\_thread()}}
{\footnotesize\ttfamily bool Thread\+Manager\+::terminate\+\_\+thread (\begin{DoxyParamCaption}\item[{int}]{tid }\end{DoxyParamCaption})}



Terminates a thread. 


\begin{DoxyParams}{Parameters}
{\em tid} & thread id to terminate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if successfully terminated thread or false if error 
\end{DoxyReturn}


Definition at line 112 of file multithreading.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{113 \{}
\DoxyCodeLine{114     \textcolor{comment}{// Check if the thread is actually running}}
\DoxyCodeLine{115     \textcolor{keywordflow}{if} (tid < 0 || tid >= m\_threads.size())}
\DoxyCodeLine{116         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{comment}{// Delete the thread}}
\DoxyCodeLine{119     \textcolor{keyword}{delete} m\_threads[tid];}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{// Erase the thread from the array}}
\DoxyCodeLine{122     m\_threads.erase(m\_threads.begin() + tid);}
\DoxyCodeLine{123     \textcolor{comment}{// TODO: Thread ID needs to be updated}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{126 \}}

\end{DoxyCode}


Referenced by schedule().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/max-\/os/max-\/os/kernel/include/system/\mbox{\hyperlink{multithreading_8h}{multithreading.\+h}}\item 
/home/runner/work/max-\/os/max-\/os/kernel/src/system/\mbox{\hyperlink{multithreading_8cpp}{multithreading.\+cpp}}\end{DoxyCompactItemize}
