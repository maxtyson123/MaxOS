\doxysection{Max\+OS\+::processes\+::Thread Class Reference}
\hypertarget{classMaxOS_1_1processes_1_1Thread}{}\label{classMaxOS_1_1processes_1_1Thread}\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}}


The execution context of a sub-\/process thread.  




{\ttfamily \#include $<$process.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a1287ab4dd0133b3e7065a177717cdf77}{Thread}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}}(\texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{\+\_\+entry\+\_\+point}})(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \texorpdfstring{$\ast$}{*}), \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{args}}, \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{int}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{arg\+\_\+amount}}, \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}})
\begin{DoxyCompactList}\small\item\em Constructor for the \doxylink{classMaxOS_1_1processes_1_1Thread}{Thread} class. \end{DoxyCompactList}\item 
\Hypertarget{classMaxOS_1_1processes_1_1Thread_a37d9edd3a1a776cbc27dedff949c9726}\label{classMaxOS_1_1processes_1_1Thread_a37d9edd3a1a776cbc27dedff949c9726} 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Thread} ()
\begin{DoxyCompactList}\small\item\em Destructor for the \doxylink{classMaxOS_1_1processes_1_1Thread}{Thread} class. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_ae937dce97b101125ab01bfb592cf059f}{sleep}} (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{milliseconds}})
\begin{DoxyCompactList}\small\item\em Sleeps the thread for a certain amount of time. \end{DoxyCompactList}\item 
uintptr\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a9baa5fdcd84593974738c3f62f050283}{tss\+\_\+pointer}} () const
\begin{DoxyCompactList}\small\item\em Gets the stack pointer to use for the TSS when switching to this thread. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a21abe4a5d20033649696849094c415d0}{save\+\_\+sse\+\_\+state}} ()
\begin{DoxyCompactList}\small\item\em Saves the SSE, x87 FPU, and MMX states from memory to the thread. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_acd31b38f01bba4e58e8426f5f0be25f7}{restore\+\_\+sse\+\_\+state}} ()
\begin{DoxyCompactList}\small\item\em Restores the SSE, x87 FPU, and MMX states from the thread to memory. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a66d10fe387b6743ee1a76e6bbff69023}{save\+\_\+cpu\+\_\+state}} ()
\begin{DoxyCompactList}\small\item\em Saves the CPU state into the thread\textquotesingle{}s execution\+\_\+state structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}{tid}}
\begin{DoxyCompactList}\small\item\em The thread ID. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}{parent\+\_\+pid}}
\begin{DoxyCompactList}\small\item\em The parent process ID. \end{DoxyCompactList}\item 
system\+::cpu\+\_\+status\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The CPU state of the thread. \end{DoxyCompactList}\item 
thread\+\_\+state\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The current state of the thread. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}{ticks}}
\begin{DoxyCompactList}\small\item\em The number of ticks the thread has run for. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\+\_\+time}}
\begin{DoxyCompactList}\small\item\em The time at which the thread should wake up (if sleeping) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The execution context of a sub-\/process thread. 

Definition at line \mbox{\hyperlink{process_8h_source_l00047}{47}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1processes_1_1Thread_a1287ab4dd0133b3e7065a177717cdf77}\label{classMaxOS_1_1processes_1_1Thread_a1287ab4dd0133b3e7065a177717cdf77} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!Thread@{Thread}}
\index{Thread@{Thread}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{Thread()}{Thread()}}
{\footnotesize\ttfamily Thread\+::\+Thread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}}(\texorpdfstring{$\ast$}{*})(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \texorpdfstring{$\ast$}{*})}]{\+\_\+entry\+\_\+point,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} \texorpdfstring{$\ast$}{*}}]{args,  }\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{int}}}]{arg\+\_\+amount,  }\item[{\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}}]{parent }\end{DoxyParamCaption})}



Constructor for the \doxylink{classMaxOS_1_1processes_1_1Thread}{Thread} class. 



Definition at line \mbox{\hyperlink{process_8cpp_source_l00021}{21}} of file \mbox{\hyperlink{process_8cpp_source}{process.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{comment}{//\ Basic\ setup}}
\DoxyCodeLine{00024\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}}\ =\ ThreadState::NEW;}
\DoxyCodeLine{00025\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\_time}}\ =\ 0;}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}{ticks}}\ =\ 0;}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{//\ Create\ the\ stack}}
\DoxyCodeLine{00029\ \ \ \ \ m\_stack\_pointer\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uintptr\_t}})\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a90f2d5bec98f1e6cdd71c87853baaab9}{MemoryManager::malloc}}(STACK\_SIZE);}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ Create\ the\ TSS\ stack}}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}}-\/>is\_kernel)\ \{}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ the\ kernel\ stack}}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ m\_tss\_stack\_pointer\ =\ \mbox{\hyperlink{classMaxOS_1_1system_1_1CPU_adf91af6b880b57ae580a0a91ed4b71f7}{CPU::executing\_core}}()\ -\/>\ tss.rsp0;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ m\_tss\_stack\_pointer\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uintptr\_t}})\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a983c849ff604367f7c8a0e70172bb331}{MemoryManager::kmalloc}}(STACK\_SIZE)\ +\ STACK\_SIZE;}
\DoxyCodeLine{00039\ \ \ \ \ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ Mak\ sure\ there\ is\ a\ stack}}
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{logger_8h_adf7b5d69e4c25995b3211b91b27f33b6}{ASSERT}}(m\_stack\_pointer\ !=\ 0\ \&\&\ m\_tss\_stack\_pointer\ !=\ 0,\ \textcolor{stringliteral}{"{}Failed\ to\ allocate\ stack\ for\ thread"{}});}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{comment}{//\ Set\ up\ the\ execution\ state}}
\DoxyCodeLine{00045\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}\ =\ \{\};}
\DoxyCodeLine{00046\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.rip\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}})\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{\_entry\_point}};}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.ss\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}}-\/>is\_kernel\ ?\ 0x10\ :\ 0x23;}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.cs\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}}-\/>is\_kernel\ ?\ 0x8\ :\ 0x1B;}
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.rflags\ =\ 0x202;}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.interrupt\_number\ =\ 0;}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.error\_code\ =\ 0;}
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.rsp\ =\ m\_stack\_pointer;}
\DoxyCodeLine{00053\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.rbp\ =\ 0;}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ Copy\ the\ args\ into\ userspace}}
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}}\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{argc}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{arg\_amount}};}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{argv}}\ =\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a90f2d5bec98f1e6cdd71c87853baaab9}{MemoryManager::malloc}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{arg\_amount}}\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*));}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{memoryIO_8h_a5d860365491e432b125606a6f8e464bc}{memcpy}}(\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{argv}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{args}},\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{arg\_amount}}\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*));}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.rdi\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{argc}};}
\DoxyCodeLine{00061\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}.rsi\ =\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{uint64\_t}})\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{argv}};}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//execution\_state-\/>rdx\ =\ (uint64\_t)env\_args;}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}{parent\_pid}}\ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{parent}}-\/>pid();}
\DoxyCodeLine{00065\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{logger_8h_source_l00095}{ASSERT}}, \mbox{\hyperlink{cpu_8cpp_source_l00620}{Max\+OS\+::system\+::\+CPU\+::executing\+\_\+core()}}, \mbox{\hyperlink{process_8h_source_l00065}{execution\+\_\+state}}, \mbox{\hyperlink{memorymanagement_8cpp_source_l00083}{Max\+OS\+::memory\+::\+Memory\+Manager\+::kmalloc()}}, \mbox{\hyperlink{memorymanagement_8cpp_source_l00068}{Max\+OS\+::memory\+::\+Memory\+Manager\+::malloc()}}, \mbox{\hyperlink{memoryIO_8cpp_source_l00165}{memcpy()}}, \mbox{\hyperlink{process_8h_source_l00063}{parent\+\_\+pid}}, \mbox{\hyperlink{process_8h_source_l00066}{thread\+\_\+state}}, \mbox{\hyperlink{process_8h_source_l00068}{ticks}}, and \mbox{\hyperlink{process_8h_source_l00069}{wakeup\+\_\+time}}.



\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1processes_1_1Thread_acd31b38f01bba4e58e8426f5f0be25f7}\label{classMaxOS_1_1processes_1_1Thread_acd31b38f01bba4e58e8426f5f0be25f7} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!restore\_sse\_state@{restore\_sse\_state}}
\index{restore\_sse\_state@{restore\_sse\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{restore\_sse\_state()}{restore\_sse\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Thread\+::restore\+\_\+sse\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Restores the SSE, x87 FPU, and MMX states from the thread to memory. 



Definition at line \mbox{\hyperlink{process_8cpp_source_l00100}{100}} of file \mbox{\hyperlink{process_8cpp_source}{process.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{comment}{//\ Ensure\ the\ state\ saving\ is\ enabled}}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classMaxOS_1_1system_1_1CPU_adf91af6b880b57ae580a0a91ed4b71f7}{CPU::executing\_core}}()-\/>xsave\_enabled)}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ Restore\ the\ state}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{asm}\ \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}fxrstor\ \%0"{}}\ :\ :\ \textcolor{stringliteral}{"{}m"{}}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{m\_sse\_save\_region}}));}
\DoxyCodeLine{00108\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{cpu_8cpp_source_l00620}{Max\+OS\+::system\+::\+CPU\+::executing\+\_\+core()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a66d10fe387b6743ee1a76e6bbff69023}\label{classMaxOS_1_1processes_1_1Thread_a66d10fe387b6743ee1a76e6bbff69023} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!save\_cpu\_state@{save\_cpu\_state}}
\index{save\_cpu\_state@{save\_cpu\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{save\_cpu\_state()}{save\_cpu\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Thread\+::save\+\_\+cpu\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Saves the CPU state into the thread\textquotesingle{}s execution\+\_\+state structure. 



Definition at line \mbox{\hyperlink{process_8cpp_source_l00113}{113}} of file \mbox{\hyperlink{process_8cpp_source}{process.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{asm}\ \textcolor{keyword}{volatile}(}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ return\ address\ before\ stack\ is\ modified}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ (\%\%rsp),\ \%\%rax\(\backslash\)n"{}}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ RDI\ before\ stack\ is\ modified}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pushq\ \%\%rdi\(\backslash\)n"{}}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%0,\ \%\%rdi\(\backslash\)n"{}}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ general\ purpose}}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r15,\ 0x00(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r14,\ 0x08(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r13,\ 0x10(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r12,\ 0x18(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r11,\ 0x20(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r10,\ 0x28(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r9,\ \ 0x30(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%r8,\ \ 0x38(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rdi,\ 0x40(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rsi,\ 0x48(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rbp,\ 0x50(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rdx,\ 0x58(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rcx,\ 0x60(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rbx,\ 0x68(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rax,\ 0x70(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reserved}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \$0,\ \ \ \ 0x78(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \$0,\ \ \ \ 0x80(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ RIP\ from\ earlier}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rax,\ 0x88(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ cs}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}xorq\ \%\%rax,\ \%\%rax\(\backslash\)n"{}}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movw\ \%\%cs,\ \%\%ax\(\backslash\)n"{}}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rax,\ 0x90(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ flags}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pushfq\(\backslash\)n"{}}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}popq\ \%\%rax\(\backslash\)n"{}}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rax,\ 0x98(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ RSP\ and\ SS}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rsp,\ 0xA0(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}xorq\ \%\%rax,\ \%\%rax\(\backslash\)n"{}}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movw\ \%\%ss,\ \%\%ax\(\backslash\)n"{}}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}movq\ \%\%rax,\ 0xA8(\%\%rdi)\(\backslash\)n"{}}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Restore\ RDI}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}popq\ \%\%rdi\(\backslash\)n"{}}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}r"{}}\ (\&\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}})}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}rax"{}},\ \textcolor{stringliteral}{"{}cc"{}},\ \textcolor{stringliteral}{"{}memory"{}}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00168\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{process_8h_source_l00065}{execution\+\_\+state}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a21abe4a5d20033649696849094c415d0}\label{classMaxOS_1_1processes_1_1Thread_a21abe4a5d20033649696849094c415d0} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!save\_sse\_state@{save\_sse\_state}}
\index{save\_sse\_state@{save\_sse\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{save\_sse\_state()}{save\_sse\_state()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Thread\+::save\+\_\+sse\+\_\+state (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Saves the SSE, x87 FPU, and MMX states from memory to the thread. 



Definition at line \mbox{\hyperlink{process_8cpp_source_l00087}{87}} of file \mbox{\hyperlink{process_8cpp_source}{process.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ Ensure\ the\ state\ saving\ is\ enabled}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classMaxOS_1_1system_1_1CPU_adf91af6b880b57ae580a0a91ed4b71f7}{CPU::executing\_core}}()-\/>xsave\_enabled)}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ state}}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{asm}\ \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}fxsave\ \%0"{}}\ :\ \textcolor{stringliteral}{"{}=m"{}}\ (\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{m\_sse\_save\_region}}));}
\DoxyCodeLine{00095\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{cpu_8cpp_source_l00620}{Max\+OS\+::system\+::\+CPU\+::executing\+\_\+core()}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00413}{Max\+OS\+::processes\+::\+Scheduler\+::schedule\+\_\+next()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_ae937dce97b101125ab01bfb592cf059f}\label{classMaxOS_1_1processes_1_1Thread_ae937dce97b101125ab01bfb592cf059f} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!sleep@{sleep}}
\index{sleep@{sleep}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{sleep()}{sleep()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{void}} Thread\+::sleep (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{size\+\_\+t}}}]{milliseconds }\end{DoxyParamCaption})}



Sleeps the thread for a certain amount of time. 


\begin{DoxyParams}{Parameters}
{\em milliseconds} & The amount of time to sleep for \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{process_8cpp_source_l00077}{77}} of file \mbox{\hyperlink{process_8cpp_source}{process.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{//\ Update\ the\ state}}
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}}\ =\ ThreadState::SLEEPING;}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\_time}}\ \ =\ \mbox{\hyperlink{classMaxOS_1_1common_1_1Rectangle}{milliseconds}};}
\DoxyCodeLine{00082\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{process_8h_source_l00066}{thread\+\_\+state}}, and \mbox{\hyperlink{process_8h_source_l00069}{wakeup\+\_\+time}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a9baa5fdcd84593974738c3f62f050283}\label{classMaxOS_1_1processes_1_1Thread_a9baa5fdcd84593974738c3f62f050283} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!tss\_pointer@{tss\_pointer}}
\index{tss\_pointer@{tss\_pointer}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{tss\_pointer()}{tss\_pointer()}}
{\footnotesize\ttfamily uintptr\+\_\+t Max\+OS\+::processes\+::\+Thread\+::tss\+\_\+pointer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Gets the stack pointer to use for the TSS when switching to this thread. 



Definition at line \mbox{\hyperlink{process_8h_source_l00071}{71}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



\doxysubsection{Member Data Documentation}
\Hypertarget{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}\label{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!execution\_state@{execution\_state}}
\index{execution\_state@{execution\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{execution\_state}{execution\_state}}
{\footnotesize\ttfamily system\+::cpu\+\_\+status\+\_\+t Max\+OS\+::processes\+::\+Thread\+::execution\+\_\+state}



The CPU state of the thread. 



Definition at line \mbox{\hyperlink{process_8h_source_l00065}{65}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



Referenced by \mbox{\hyperlink{process_8cpp_source_l00113}{save\+\_\+cpu\+\_\+state()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00413}{Max\+OS\+::processes\+::\+Scheduler\+::schedule\+\_\+next()}}, \mbox{\hyperlink{process_8cpp_source_l00021}{Thread()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00550}{Max\+OS\+::processes\+::\+Scheduler\+::yield()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00078}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::yield()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}\label{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!parent\_pid@{parent\_pid}}
\index{parent\_pid@{parent\_pid}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{parent\_pid}{parent\_pid}}
{\footnotesize\ttfamily uint64\+\_\+t Max\+OS\+::processes\+::\+Thread\+::parent\+\_\+pid}



The parent process ID. 



Definition at line \mbox{\hyperlink{process_8h_source_l00063}{63}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00642}{Max\+OS\+::processes\+::\+Scheduler\+::current\+\_\+process()}}, and \mbox{\hyperlink{process_8cpp_source_l00021}{Thread()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}\label{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!thread\_state@{thread\_state}}
\index{thread\_state@{thread\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{thread\_state}{thread\_state}}
{\footnotesize\ttfamily thread\+\_\+state\+\_\+t Max\+OS\+::processes\+::\+Thread\+::thread\+\_\+state}



The current state of the thread. 



Definition at line \mbox{\hyperlink{process_8h_source_l00066}{66}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00579}{Max\+OS\+::processes\+::\+Scheduler\+::remove\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00413}{Max\+OS\+::processes\+::\+Scheduler\+::schedule\+\_\+next()}}, \mbox{\hyperlink{process_8cpp_source_l00077}{sleep()}}, \mbox{\hyperlink{process_8cpp_source_l00021}{Thread()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00550}{Max\+OS\+::processes\+::\+Scheduler\+::yield()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}\label{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!ticks@{ticks}}
\index{ticks@{ticks}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{ticks}{ticks}}
{\footnotesize\ttfamily size\+\_\+t Max\+OS\+::processes\+::\+Thread\+::ticks}



The number of ticks the thread has run for. 



Definition at line \mbox{\hyperlink{process_8h_source_l00068}{68}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00384}{Max\+OS\+::processes\+::\+Scheduler\+::schedule()}}, and \mbox{\hyperlink{process_8cpp_source_l00021}{Thread()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}\label{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!tid@{tid}}
\index{tid@{tid}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{tid}{tid}}
{\footnotesize\ttfamily uint64\+\_\+t Max\+OS\+::processes\+::\+Thread\+::tid}



The thread ID. 



Definition at line \mbox{\hyperlink{process_8h_source_l00062}{62}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00502}{Max\+OS\+::processes\+::\+Scheduler\+::add\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00524}{Max\+OS\+::processes\+::\+Scheduler\+::add\+\_\+thread()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00614}{Max\+OS\+::processes\+::\+Scheduler\+::force\+\_\+remove\+\_\+process()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00713}{Max\+OS\+::processes\+::\+Scheduler\+::get\+\_\+thread()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}\label{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!wakeup\_time@{wakeup\_time}}
\index{wakeup\_time@{wakeup\_time}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{wakeup\_time}{wakeup\_time}}
{\footnotesize\ttfamily size\+\_\+t Max\+OS\+::processes\+::\+Thread\+::wakeup\+\_\+time}



The time at which the thread should wake up (if sleeping) 



Definition at line \mbox{\hyperlink{process_8h_source_l00069}{69}} of file \mbox{\hyperlink{process_8h_source}{process.\+h}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00413}{Max\+OS\+::processes\+::\+Scheduler\+::schedule\+\_\+next()}}, \mbox{\hyperlink{process_8cpp_source_l00077}{sleep()}}, and \mbox{\hyperlink{process_8cpp_source_l00021}{Thread()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/processes/\mbox{\hyperlink{process_8h}{process.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/processes/\mbox{\hyperlink{process_8cpp}{process.\+cpp}}\end{DoxyCompactItemize}
