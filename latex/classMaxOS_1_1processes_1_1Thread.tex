\hypertarget{classMaxOS_1_1processes_1_1Thread}{}\doxysection{Max\+OS\+::processes\+::Thread Class Reference}
\label{classMaxOS_1_1processes_1_1Thread}\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}}


{\ttfamily \#include $<$process.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a1287ab4dd0133b3e7065a177717cdf77}{Thread}} (void($\ast$\+\_\+entry\+\_\+point)(void $\ast$), void $\ast$args, int arg\+\_\+amount, \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} $\ast$parent)
\begin{DoxyCompactList}\small\item\em Constructor for the \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} class. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a37d9edd3a1a776cbc27dedff949c9726}{$\sim$\+Thread}} ()
\begin{DoxyCompactList}\small\item\em Destructor for the \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} class. \end{DoxyCompactList}\item 
system\+::cpu\+\_\+status\+\_\+t $\ast$ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a77cbad5ef66a0daf6f0f5bebb8ded39b}{sleep}} (size\+\_\+t milliseconds)
\begin{DoxyCompactList}\small\item\em Sleeps the thread for a certain amount of time (Yields the thread) \end{DoxyCompactList}\item 
uintptr\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a481f7dd08b6060645c93919018f64fe4}{get\+\_\+tss\+\_\+pointer}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}{tid}}
\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}{parent\+\_\+pid}}
\item 
system\+::cpu\+\_\+status\+\_\+t $\ast$ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\+\_\+state}}
\item 
\mbox{\hyperlink{namespaceMaxOS_1_1processes_a00379181a9892760100d025d5d9b6a90}{thread\+\_\+state\+\_\+t}} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\+\_\+state}}
\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}{ticks}}
\item 
size\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\+\_\+time}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 36 of file process.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a1287ab4dd0133b3e7065a177717cdf77}\label{classMaxOS_1_1processes_1_1Thread_a1287ab4dd0133b3e7065a177717cdf77}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!Thread@{Thread}}
\index{Thread@{Thread}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{Thread()}{Thread()}}
{\footnotesize\ttfamily Thread\+::\+Thread (\begin{DoxyParamCaption}\item[{void($\ast$)(void $\ast$)}]{\+\_\+entry\+\_\+point,  }\item[{void $\ast$}]{args,  }\item[{int}]{arg\+\_\+amount,  }\item[{\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} $\ast$}]{parent }\end{DoxyParamCaption})}



Constructor for the \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} class. 



Definition at line 18 of file process.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{18                                                                                         \{}
\DoxyCodeLine{19 }
\DoxyCodeLine{20     \textcolor{comment}{// Basic setup}}
\DoxyCodeLine{21     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}} = \mbox{\hyperlink{namespaceMaxOS_1_1processes_ac30559a70f01633a1d96a916375bbcf6a3195a4effaa582ba0523a5208e945cbd}{ThreadState::NEW}};}
\DoxyCodeLine{22     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\_time}} = 0;}
\DoxyCodeLine{23     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}{ticks}} = 0;}
\DoxyCodeLine{24 }
\DoxyCodeLine{25     \textcolor{comment}{// Create the stack}}
\DoxyCodeLine{26     m\_stack\_pointer = (uintptr\_t)MemoryManager::malloc(s\_stack\_size);}
\DoxyCodeLine{27 }
\DoxyCodeLine{28     \textcolor{comment}{// Create the TSS stack}}
\DoxyCodeLine{29     \textcolor{keywordflow}{if}(parent -\/> is\_kernel) \{}
\DoxyCodeLine{30 }
\DoxyCodeLine{31         \textcolor{comment}{// Use the kernel stack}}
\DoxyCodeLine{32         m\_tss\_stack\_pointer = CPU::get\_instance() -\/> \mbox{\hyperlink{structMaxOS_1_1system_1_1tss}{tss}}.\mbox{\hyperlink{structMaxOS_1_1system_1_1tss_a5719c6cb9ae842f74c0e1eccc4f89f3b}{rsp0}};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \} \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{35         m\_tss\_stack\_pointer = (uintptr\_t)MemoryManager::kmalloc(s\_stack\_size) + s\_stack\_size;}
\DoxyCodeLine{36     \}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{comment}{// Mak sure there is a stack}}
\DoxyCodeLine{39     \mbox{\hyperlink{kprint_8h_adf7b5d69e4c25995b3211b91b27f33b6}{ASSERT}}(m\_stack\_pointer != 0 \&\& m\_tss\_stack\_pointer != 0, \textcolor{stringliteral}{"Failed to allocate stack for thread"});}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{// Set up the execution state}}
\DoxyCodeLine{42     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}} = \textcolor{keyword}{new} cpu\_status\_t();}
\DoxyCodeLine{43     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>rip = (uint64\_t)\_entry\_point;}
\DoxyCodeLine{44     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>ss = parent -\/> is\_kernel ? 0x10 : 0x23;}
\DoxyCodeLine{45     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>cs = parent -\/> is\_kernel ? 0x8  : 0x1B;}
\DoxyCodeLine{46     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>rflags = 0x202;}
\DoxyCodeLine{47     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>interrupt\_number = 0;}
\DoxyCodeLine{48     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>error\_code = 0;}
\DoxyCodeLine{49     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>rsp = (uint64\_t)m\_stack\_pointer;}
\DoxyCodeLine{50     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>rbp = 0;}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{comment}{// Copy the args into user space using memcopy}}
\DoxyCodeLine{53     uint64\_t  argc = arg\_amount;}
\DoxyCodeLine{54     \textcolor{keywordtype}{void}* argv = MemoryManager::malloc(arg\_amount * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*));}
\DoxyCodeLine{55     \mbox{\hyperlink{memoryIO_8h_aa9250664b209e69cb6aec30d9b7da564}{memcpy}}(argv, args, arg\_amount * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*));}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 }
\DoxyCodeLine{58     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>rdi = argc;}
\DoxyCodeLine{59     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}{execution\_state}}-\/>rsi = (uint64\_t)argv;}
\DoxyCodeLine{60     \textcolor{comment}{//execution\_state-\/>rdx = (uint64\_t)env\_args;}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     \textcolor{comment}{// Begin scheduling this thread}}
\DoxyCodeLine{63     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}{parent\_pid}} = parent-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_a56b7359906f289d7054247885002e2e5}{get\_pid}}();}
\DoxyCodeLine{64     \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}{tid}} = \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ac85b93968affc260d78005549dc3c08f}{Scheduler::get\_system\_scheduler}}() -\/> add\_thread(\textcolor{keyword}{this});}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \}}

\end{DoxyCode}


References A\+S\+S\+E\+RT, Max\+O\+S\+::system\+::\+C\+P\+U\+::get\+\_\+instance(), Max\+O\+S\+::processes\+::\+Process\+::get\+\_\+pid(), memcpy(), Max\+O\+S\+::processes\+::\+N\+EW, and Max\+O\+S\+::system\+::tss\+::rsp0.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a37d9edd3a1a776cbc27dedff949c9726}\label{classMaxOS_1_1processes_1_1Thread_a37d9edd3a1a776cbc27dedff949c9726}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!````~Thread@{$\sim$Thread}}
\index{````~Thread@{$\sim$Thread}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{$\sim$Thread()}{~Thread()}}
{\footnotesize\ttfamily Thread\+::$\sim$\+Thread (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Destructor for the \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} class. 



Definition at line 71 of file process.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{71                 \{}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a481f7dd08b6060645c93919018f64fe4}\label{classMaxOS_1_1processes_1_1Thread_a481f7dd08b6060645c93919018f64fe4}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!get\_tss\_pointer@{get\_tss\_pointer}}
\index{get\_tss\_pointer@{get\_tss\_pointer}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{get\_tss\_pointer()}{get\_tss\_pointer()}}
{\footnotesize\ttfamily uintptr\+\_\+t Max\+O\+S\+::processes\+::\+Thread\+::get\+\_\+tss\+\_\+pointer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 60 of file process.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{60 \{ \textcolor{keywordflow}{return} m\_tss\_stack\_pointer; \}}

\end{DoxyCode}


Referenced by Max\+O\+S\+::processes\+::\+Scheduler\+::schedule\+\_\+next().

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a77cbad5ef66a0daf6f0f5bebb8ded39b}\label{classMaxOS_1_1processes_1_1Thread_a77cbad5ef66a0daf6f0f5bebb8ded39b}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!sleep@{sleep}}
\index{sleep@{sleep}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{sleep()}{sleep()}}
{\footnotesize\ttfamily cpu\+\_\+status\+\_\+t $\ast$ Thread\+::sleep (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{milliseconds }\end{DoxyParamCaption})}



Sleeps the thread for a certain amount of time (Yields the thread) 


\begin{DoxyParams}{Parameters}
{\em milliseconds} & The amount of time to sleep for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The status of the C\+PU for the next thread to run 
\end{DoxyReturn}


Definition at line 81 of file process.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{81                                                \{}
\DoxyCodeLine{82 }
\DoxyCodeLine{83   \textcolor{comment}{// Update the vars}}
\DoxyCodeLine{84   \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}} = \mbox{\hyperlink{namespaceMaxOS_1_1processes_ac30559a70f01633a1d96a916375bbcf6aa7c0931b486735232aaaf97e696ea8a5}{ThreadState::SLEEPING}};}
\DoxyCodeLine{85   \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\_time}} = \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ac85b93968affc260d78005549dc3c08f}{Scheduler::get\_system\_scheduler}}() -\/> get\_ticks() + milliseconds;}
\DoxyCodeLine{86 }
\DoxyCodeLine{87   \textcolor{comment}{// Yield}}
\DoxyCodeLine{88   \textcolor{keywordflow}{return} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ac85b93968affc260d78005549dc3c08f}{Scheduler::get\_system\_scheduler}}() -\/> yield();}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \}}

\end{DoxyCode}


References Max\+O\+S\+::processes\+::\+S\+L\+E\+E\+P\+I\+NG.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}\label{classMaxOS_1_1processes_1_1Thread_afcde2d4d3ee4c3540120034dbbff1807}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!execution\_state@{execution\_state}}
\index{execution\_state@{execution\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{execution\_state}{execution\_state}}
{\footnotesize\ttfamily system\+::cpu\+\_\+status\+\_\+t$\ast$ Max\+O\+S\+::processes\+::\+Thread\+::execution\+\_\+state}



Definition at line 54 of file process.\+h.



Referenced by Max\+O\+S\+::processes\+::\+Scheduler\+::schedule\+\_\+next(), and Max\+O\+S\+::processes\+::\+Scheduler\+::yield().

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}\label{classMaxOS_1_1processes_1_1Thread_a130e3726d7c4912ab2fdf6bf587f757f}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!parent\_pid@{parent\_pid}}
\index{parent\_pid@{parent\_pid}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{parent\_pid}{parent\_pid}}
{\footnotesize\ttfamily uint64\+\_\+t Max\+O\+S\+::processes\+::\+Thread\+::parent\+\_\+pid}



Definition at line 52 of file process.\+h.



Referenced by Max\+O\+S\+::processes\+::\+Scheduler\+::add\+\_\+thread(), and Max\+O\+S\+::processes\+::\+Process\+::add\+\_\+thread().

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}\label{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!thread\_state@{thread\_state}}
\index{thread\_state@{thread\_state}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{thread\_state}{thread\_state}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespaceMaxOS_1_1processes_a00379181a9892760100d025d5d9b6a90}{thread\+\_\+state\+\_\+t}} Max\+O\+S\+::processes\+::\+Thread\+::thread\+\_\+state}



Definition at line 55 of file process.\+h.



Referenced by Max\+O\+S\+::processes\+::\+Scheduler\+::schedule\+\_\+next().

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}\label{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!ticks@{ticks}}
\index{ticks@{ticks}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{ticks}{ticks}}
{\footnotesize\ttfamily size\+\_\+t Max\+O\+S\+::processes\+::\+Thread\+::ticks}



Definition at line 57 of file process.\+h.



Referenced by Max\+O\+S\+::processes\+::\+Scheduler\+::schedule().

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}\label{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!tid@{tid}}
\index{tid@{tid}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{tid}{tid}}
{\footnotesize\ttfamily uint64\+\_\+t Max\+O\+S\+::processes\+::\+Thread\+::tid}



Definition at line 51 of file process.\+h.

\mbox{\Hypertarget{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}\label{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}} 
\index{MaxOS::processes::Thread@{MaxOS::processes::Thread}!wakeup\_time@{wakeup\_time}}
\index{wakeup\_time@{wakeup\_time}!MaxOS::processes::Thread@{MaxOS::processes::Thread}}
\doxysubsubsection{\texorpdfstring{wakeup\_time}{wakeup\_time}}
{\footnotesize\ttfamily size\+\_\+t Max\+O\+S\+::processes\+::\+Thread\+::wakeup\+\_\+time}



Definition at line 58 of file process.\+h.



Referenced by Max\+O\+S\+::processes\+::\+Scheduler\+::schedule\+\_\+next().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/processes/\mbox{\hyperlink{process_8h}{process.\+h}}\item 
/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/src/processes/\mbox{\hyperlink{process_8cpp}{process.\+cpp}}\end{DoxyCompactItemize}
