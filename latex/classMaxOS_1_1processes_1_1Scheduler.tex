\doxysection{Max\+OS\+::processes\+::Scheduler Class Reference}
\hypertarget{classMaxOS_1_1processes_1_1Scheduler}{}\label{classMaxOS_1_1processes_1_1Scheduler}\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}


Schedules processes to run on the core via their threads.  




{\ttfamily \#include $<$scheduler.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a3b61aac11466cd45ae42ab8c2b0013f6}{Scheduler}} ()
\begin{DoxyCompactList}\small\item\em Constructs a new \doxylink{classMaxOS_1_1processes_1_1Scheduler}{Scheduler} object and creates the idle process. \end{DoxyCompactList}\item 
system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a85c82e3f0b71fd6e7d570594ea7be397}{schedule}} (system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*}cpu\+\_\+state)
\begin{DoxyCompactList}\small\item\em Schedules the next thread to run. \end{DoxyCompactList}\item 
system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_af0094b696d420844c5475311e556dd70}{schedule\+\_\+next}} (system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*}status)
\begin{DoxyCompactList}\small\item\em Schedules the next thread to run. \end{DoxyCompactList}\item 
system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4e3cb6c6cc95d62dc6149c0ec934c723}{yield}} ()
\begin{DoxyCompactList}\small\item\em Pass execution to the next thread. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a57f5f5eecb3fbbc693b6462c880129b0}{add\+\_\+process}} (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}process)
\begin{DoxyCompactList}\small\item\em Adds a process to the scheduler. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a00c2995b3a91021eb4f278a591ff994f}{remove\+\_\+process}} (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}process)
\begin{DoxyCompactList}\small\item\em Removes a process from the scheduler if the process has no threads, if it does then the threads are stopped but the process is not removed (this will be done automatically when all threads are stopped) \end{DoxyCompactList}\item 
system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a501213a82c4fa7c7aa8bc6ff39377c0f}{force\+\_\+remove\+\_\+process}} (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}process)
\begin{DoxyCompactList}\small\item\em Removes a process from the scheduler and deletes all threads, begins running the next process. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a85c088e0e4d5e5d6fb646c842127c36c}{add\+\_\+thread}} (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} \texorpdfstring{$\ast$}{*}thread)
\begin{DoxyCompactList}\small\item\em Adds a thread to the scheduler. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}{current\+\_\+process}} ()
\begin{DoxyCompactList}\small\item\em Gets the current process. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a51b58af8b283f0f98131dd2d6ce51540}{get\+\_\+process}} (uint64\+\_\+t pid)
\begin{DoxyCompactList}\small\item\em Gets a process by its PID. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ab16bfaa6ff6992298aa292a22ebe8397}{process\+\_\+amount}} ()
\begin{DoxyCompactList}\small\item\em Gets how processes are running on this scheduler. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\+\_\+thread}} ()
\begin{DoxyCompactList}\small\item\em Gets the currently executing thread. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a73cf68e70de225ce465f249989766468}{get\+\_\+thread}} (uint64\+\_\+t tid)
\begin{DoxyCompactList}\small\item\em Gets a thread by its TID. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a3ce2093679daf9acde62bbabc020728e}{thread\+\_\+amount}} ()
\begin{DoxyCompactList}\small\item\em Gets how many threads are running on this scheduler. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a349f28166719d94bd978439f24cd2448}{ticks}} () const
\begin{DoxyCompactList}\small\item\em Gets how long the system has been running for. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ad7bd11e0611b0cad2fc18e3499d82dec}{activate}} ()
\begin{DoxyCompactList}\small\item\em Activates the scheduler. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_af4792bed046b34d0010412e336ec2970}{deactivate}} ()
\begin{DoxyCompactList}\small\item\em Deactivates the scheduler. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Schedules processes to run on the core via their threads. 

Definition at line \mbox{\hyperlink{scheduler_8h_source_l00085}{85}} of file \mbox{\hyperlink{scheduler_8h_source}{scheduler.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a3b61aac11466cd45ae42ab8c2b0013f6}\label{classMaxOS_1_1processes_1_1Scheduler_a3b61aac11466cd45ae42ab8c2b0013f6} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!Scheduler@{Scheduler}}
\index{Scheduler@{Scheduler}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{Scheduler()}{Scheduler()}}
{\footnotesize\ttfamily Scheduler\+::\+Scheduler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Constructs a new \doxylink{classMaxOS_1_1processes_1_1Scheduler}{Scheduler} object and creates the idle process. 



Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00362}{362}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00363\ :\ m\_next\_thread\_index(0),}
\DoxyCodeLine{00364\ \ \ m\_active(\textcolor{keyword}{false}),}
\DoxyCodeLine{00365\ \ \ m\_ticks(0)}
\DoxyCodeLine{00366\ \{}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{comment}{//\ Create\ this\ idle\ process}}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keyword}{auto}*\ idle\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}}(\textcolor{stringliteral}{"{}Idle"{}},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ 0,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00370\ \ \ \ \ idle-\/>memory\_manager\ =\ \mbox{\hyperlink{classMaxOS_1_1memory_1_1MemoryManager_a80d8e713d6ad371a4b564a5202542d48}{MemoryManager::s\_kernel\_memory\_manager}};}
\DoxyCodeLine{00371\ \ \ \ \ idle-\/>set\_pid(0);}
\DoxyCodeLine{00372\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a57f5f5eecb3fbbc693b6462c880129b0}{add\_process}}(idle);}
\DoxyCodeLine{00373\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00502}{add\+\_\+process()}}, and \mbox{\hyperlink{memorymanagement_8h_source_l00053}{Max\+OS\+::memory\+::\+Memory\+Manager\+::s\+\_\+kernel\+\_\+memory\+\_\+manager}}.



\doxysubsection{Member Function Documentation}
\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_ad7bd11e0611b0cad2fc18e3499d82dec}\label{classMaxOS_1_1processes_1_1Scheduler_ad7bd11e0611b0cad2fc18e3499d82dec} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!activate@{activate}}
\index{activate@{activate}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{activate()}{activate()}}
{\footnotesize\ttfamily void Scheduler\+::activate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Activates the scheduler. 



Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00568}{568}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ m\_active\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00571\ \}}

\end{DoxyCode}
\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a57f5f5eecb3fbbc693b6462c880129b0}\label{classMaxOS_1_1processes_1_1Scheduler_a57f5f5eecb3fbbc693b6462c880129b0} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!add\_process@{add\_process}}
\index{add\_process@{add\_process}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{add\_process()}{add\_process()}}
{\footnotesize\ttfamily uint64\+\_\+t Scheduler\+::add\+\_\+process (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}}]{process }\end{DoxyParamCaption})}



Adds a process to the scheduler. 


\begin{DoxyParams}{Parameters}
{\em process} & The process to add \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The process ID (will be assigned during add) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00502}{502}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ next\ process\ ID}}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keyword}{auto}\ pid\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1GlobalScheduler_a06e979b83c4cd3db3eed8b333188d037}{GlobalScheduler::next\_pid}}();}
\DoxyCodeLine{00506\ \ \ \ \ process-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_ad8173b9cedf33f4f14536985edc5a509}{set\_pid}}(pid);}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{comment}{//\ Add\ the\ process\ to\ the\ list}}
\DoxyCodeLine{00509\ \ \ \ \ m\_processes.push\_back(process);}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{comment}{//\ Add\ the\ threads\ to\ the\ list}}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ thread\ :\ process-\/>threads())}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ thread-\/>tid\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a85c088e0e4d5e5d6fb646c842127c36c}{add\_thread}}(thread);}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{return}\ pid;}
\DoxyCodeLine{00516\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00524}{add\+\_\+thread()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00304}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::next\+\_\+pid()}}, \mbox{\hyperlink{process_8cpp_source_l00291}{Max\+OS\+::processes\+::\+Process\+::set\+\_\+pid()}}, \mbox{\hyperlink{process_8cpp_source_l00309}{Max\+OS\+::processes\+::\+Process\+::threads()}}, and \mbox{\hyperlink{process_8h_source_l00062}{Max\+OS\+::processes\+::\+Thread\+::tid}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00183}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::add\+\_\+process()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00362}{Scheduler()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a85c088e0e4d5e5d6fb646c842127c36c}\label{classMaxOS_1_1processes_1_1Scheduler_a85c088e0e4d5e5d6fb646c842127c36c} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!add\_thread@{add\_thread}}
\index{add\_thread@{add\_thread}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{add\_thread()}{add\_thread()}}
{\footnotesize\ttfamily uint64\+\_\+t Scheduler\+::add\+\_\+thread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} \texorpdfstring{$\ast$}{*}}]{thread }\end{DoxyParamCaption})}



Adds a thread to the scheduler. 


\begin{DoxyParams}{Parameters}
{\em thread} & The thread to add \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The thread ID 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00524}{524}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00525\ }
\DoxyCodeLine{00526\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ next\ thread\ ID}}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{keyword}{auto}\ tid\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1GlobalScheduler_a6197a324f9a16fdf1b3990df4eb7ddd3}{GlobalScheduler::next\_tid}}();}
\DoxyCodeLine{00528\ \ \ \ \ thread-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a29d70fe3b961ad7389f00976bc5f7e0b}{tid}}\ =\ tid;}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{comment}{//\ Add\ the\ thread\ to\ the\ list}}
\DoxyCodeLine{00531\ \ \ \ \ m\_threads.push\_back(thread);}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{comment}{//\ Return\ the\ thread\ ID}}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{keywordflow}{return}\ tid;}
\DoxyCodeLine{00535\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00337}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::next\+\_\+tid()}}, and \mbox{\hyperlink{process_8h_source_l00062}{Max\+OS\+::processes\+::\+Thread\+::tid}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00502}{add\+\_\+process()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00214}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::add\+\_\+thread()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}\label{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!current\_process@{current\_process}}
\index{current\_process@{current\_process}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{current\_process()}{current\_process()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*} Scheduler\+::current\+\_\+process (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets the current process. 

\begin{DoxyReturn}{Returns}
The current process, or nullptr if not found 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00642}{642}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}}*\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}{current\_process}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ process\ that\ has\ the\ thread\ being\ executed}}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ process:\ m\_processes)}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ if\ (process-\/>pid()\ ==\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}()-\/>parent\_pid)\ \{}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}{current\_process}}\ =\ process;}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}{current\_process}};}
\DoxyCodeLine{00654\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00642}{current\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00686}{current\+\_\+thread()}}, \mbox{\hyperlink{process_8h_source_l00063}{Max\+OS\+::processes\+::\+Thread\+::parent\+\_\+pid}}, and \mbox{\hyperlink{process_8cpp_source_l00319}{Max\+OS\+::processes\+::\+Process\+::pid()}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00277}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::current\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00642}{current\+\_\+process()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00413}{schedule\+\_\+next()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}\label{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!current\_thread@{current\_thread}}
\index{current\_thread@{current\_thread}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{current\_thread()}{current\_thread()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} \texorpdfstring{$\ast$}{*} Scheduler\+::current\+\_\+thread (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets the currently executing thread. 

\begin{DoxyReturn}{Returns}
The currently executing thread 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00686}{686}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_threads[m\_next\_thread\_index];}
\DoxyCodeLine{00689\ \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00642}{current\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00313}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::current\+\_\+thread()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00614}{force\+\_\+remove\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00384}{schedule()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00413}{schedule\+\_\+next()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00550}{yield()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_af4792bed046b34d0010412e336ec2970}\label{classMaxOS_1_1processes_1_1Scheduler_af4792bed046b34d0010412e336ec2970} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!deactivate@{deactivate}}
\index{deactivate@{deactivate}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{deactivate()}{deactivate()}}
{\footnotesize\ttfamily void Scheduler\+::deactivate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Deactivates the scheduler. 



Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00702}{702}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \ \ m\_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00705\ \}}

\end{DoxyCode}
\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a501213a82c4fa7c7aa8bc6ff39377c0f}\label{classMaxOS_1_1processes_1_1Scheduler_a501213a82c4fa7c7aa8bc6ff39377c0f} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!force\_remove\_process@{force\_remove\_process}}
\index{force\_remove\_process@{force\_remove\_process}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{force\_remove\_process()}{force\_remove\_process()}}
{\footnotesize\ttfamily cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} Scheduler\+::force\+\_\+remove\+\_\+process (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}}]{process }\end{DoxyParamCaption})}



Removes a process from the scheduler and deletes all threads, begins running the next process. 


\begin{DoxyParams}{Parameters}
{\em process} & The process to remove \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The status of the CPU for the next process to run or nullptr if the process was not found 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00614}{614}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{comment}{//\ If\ there\ is\ no\ process,\ fail}}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keywordflow}{if}\ (!process)}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{comment}{//\ Remove\ all\ the\ threads}}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ thread:\ process-\/>threads())\ \{}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ the\ thread\ from\ the\ scheduler}}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ m\_threads.find(thread)\ -\/\ m\_threads.begin();}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ m\_threads.erase(m\_threads.begin()\ +\ index);}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Delete\ the\ thread}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ process-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_af57385b2fab714504b20e95ceb0a8bbd}{remove\_thread}}(thread-\/>tid);}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \ \ \}}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{comment}{//\ Process\ will\ be\ dead\ now\ so\ run\ the\ next\ process\ (don't\ care\ about\ the\ execution\ state\ being\ outdated\ as\ it\ is\ being}}
\DoxyCodeLine{00633\ \ \ \ \ \textcolor{comment}{//\ removed\ regardless)}}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_af0094b696d420844c5475311e556dd70}{schedule\_next}}(\&\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}()-\/>execution\_state);}
\DoxyCodeLine{00635\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00686}{current\+\_\+thread()}}, \mbox{\hyperlink{process_8cpp_source_l00267}{Max\+OS\+::processes\+::\+Process\+::remove\+\_\+thread()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00413}{schedule\+\_\+next()}}, \mbox{\hyperlink{process_8cpp_source_l00309}{Max\+OS\+::processes\+::\+Process\+::threads()}}, and \mbox{\hyperlink{process_8h_source_l00062}{Max\+OS\+::processes\+::\+Thread\+::tid}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a51b58af8b283f0f98131dd2d6ce51540}\label{classMaxOS_1_1processes_1_1Scheduler_a51b58af8b283f0f98131dd2d6ce51540} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!get\_process@{get\_process}}
\index{get\_process@{get\_process}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{get\_process()}{get\_process()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*} Scheduler\+::get\+\_\+process (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{pid }\end{DoxyParamCaption})}



Gets a process by its PID. 


\begin{DoxyParams}{Parameters}
{\em pid} & The process ID \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The process or nullptr if not found 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00662}{662}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00664\ \ \ \ \ \textcolor{comment}{//\ Try\ to\ find\ the\ process}}
\DoxyCodeLine{00665\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ process:\ m\_processes)}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ if\ (process-\/>pid()\ ==\ pid)}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \ \ \ \ return\ process;}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{comment}{//\ Not\ found}}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00671\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{process_8cpp_source_l00319}{Max\+OS\+::processes\+::\+Process\+::pid()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a73cf68e70de225ce465f249989766468}\label{classMaxOS_1_1processes_1_1Scheduler_a73cf68e70de225ce465f249989766468} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!get\_thread@{get\_thread}}
\index{get\_thread@{get\_thread}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{get\_thread()}{get\_thread()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}} \texorpdfstring{$\ast$}{*} Scheduler\+::get\+\_\+thread (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{tid }\end{DoxyParamCaption})}



Gets a thread by its TID. 


\begin{DoxyParams}{Parameters}
{\em tid} & The thread ID \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The thread or nullptr if not found 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00713}{713}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ \ \ \textcolor{comment}{//\ Try\ to\ find\ the\ thread}}
\DoxyCodeLine{00716\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ thread:\ m\_threads)}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ if\ (thread-\/>tid\ ==\ tid)}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \ \ return\ thread;}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00721\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{process_8h_source_l00062}{Max\+OS\+::processes\+::\+Thread\+::tid}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_ab16bfaa6ff6992298aa292a22ebe8397}\label{classMaxOS_1_1processes_1_1Scheduler_ab16bfaa6ff6992298aa292a22ebe8397} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!process\_amount@{process\_amount}}
\index{process\_amount@{process\_amount}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{process\_amount()}{process\_amount()}}
{\footnotesize\ttfamily uint64\+\_\+t Scheduler\+::process\+\_\+amount (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets how processes are running on this scheduler. 

\begin{DoxyReturn}{Returns}
The amount 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00677}{677}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_processes.size();}
\DoxyCodeLine{00679\ \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00183}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::add\+\_\+process()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a00c2995b3a91021eb4f278a591ff994f}\label{classMaxOS_1_1processes_1_1Scheduler_a00c2995b3a91021eb4f278a591ff994f} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!remove\_process@{remove\_process}}
\index{remove\_process@{remove\_process}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{remove\_process()}{remove\_process()}}
{\footnotesize\ttfamily uint64\+\_\+t Scheduler\+::remove\+\_\+process (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}} \texorpdfstring{$\ast$}{*}}]{process }\end{DoxyParamCaption})}



Removes a process from the scheduler if the process has no threads, if it does then the threads are stopped but the process is not removed (this will be done automatically when all threads are stopped) 


\begin{DoxyParams}{Parameters}
{\em process} & The process to remove \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 if the process has threads, 0 otherwise 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00579}{579}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ process\ has\ no\ threads}}
\DoxyCodeLine{00582\ \ \ \ \ \textcolor{keywordflow}{if}\ (!process-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_a8595e1ab73f585be41005a6bbd88eb2f}{threads}}().empty())\ \{}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ threads\ to\ stopped\ or\ remove\ them\ if\ forced}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ thread:\ process-\/>threads())}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ thread-\/>thread\_state\ =\ ThreadState::STOPPED;}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Need\ to\ wait\ until\ the\ threads\ are\ stopped\ before\ removing\ the\ process\ (this\ will\ be\ called\ again\ when\ all\ threads\ are\ stopped)}}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \ \ \}}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{comment}{//\ Remove\ the\ process}}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{keywordflow}{for}\ (uint32\_t\ i\ =\ 0;\ i\ <\ m\_processes.size();\ i++)\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_processes[i]\ ==\ process)\ \{}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ m\_processes.erase(m\_processes.begin()\ +\ i);}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Delete\ the\ process\ mem}}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ process;}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00602\ \ \ \ \ \}}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{comment}{//\ Process\ not\ found}}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00606\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{process_8h_source_l00066}{Max\+OS\+::processes\+::\+Thread\+::thread\+\_\+state}}, and \mbox{\hyperlink{process_8cpp_source_l00309}{Max\+OS\+::processes\+::\+Process\+::threads()}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00413}{schedule\+\_\+next()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a85c82e3f0b71fd6e7d570594ea7be397}\label{classMaxOS_1_1processes_1_1Scheduler_a85c82e3f0b71fd6e7d570594ea7be397} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!schedule@{schedule}}
\index{schedule@{schedule}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{schedule()}{schedule()}}
{\footnotesize\ttfamily cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} Scheduler\+::schedule (\begin{DoxyParamCaption}\item[{system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*}}]{cpu\+\_\+state }\end{DoxyParamCaption})}



Schedules the next thread to run. 


\begin{DoxyParams}{Parameters}
{\em cpu\+\_\+state} & The current CPU state \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The next CPU state 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00384}{384}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{comment}{//\ Scheduler\ cant\ schedule\ anything}}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_threads.empty()\ ||\ !m\_active)}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cpu\_state;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{comment}{//\ Thread\ that\ we\ are\ dealing\ with}}
\DoxyCodeLine{00391\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}}*\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}\ =\ m\_threads[m\_next\_thread\_index];}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{comment}{//\ Ticked}}
\DoxyCodeLine{00394\ \ \ \ \ m\_ticks++;}
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}{ticks}}++;}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{comment}{//\ Thread\ hasn't\ used\ its\ time\ slot\ yet}}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_adac2079967569c8686ab0d05631065bc}{ticks}}\ \%\ TICKS\_PER\_EVENT)}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cpu\_state;}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Schedule\ the\ next\ thread}}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_af0094b696d420844c5475311e556dd70}{schedule\_next}}(cpu\_state);}
\DoxyCodeLine{00403\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00686}{current\+\_\+thread()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00413}{schedule\+\_\+next()}}, \mbox{\hyperlink{process_8h_source_l00068}{Max\+OS\+::processes\+::\+Thread\+::ticks}}, and \mbox{\hyperlink{scheduler_8h_source_l00079}{Max\+OS\+::processes\+::\+TICKS\+\_\+\+PER\+\_\+\+EVENT}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00062}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::handle\+\_\+interrupt()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_af0094b696d420844c5475311e556dd70}\label{classMaxOS_1_1processes_1_1Scheduler_af0094b696d420844c5475311e556dd70} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!schedule\_next@{schedule\_next}}
\index{schedule\_next@{schedule\_next}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{schedule\_next()}{schedule\_next()}}
{\footnotesize\ttfamily cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} Scheduler\+::schedule\+\_\+next (\begin{DoxyParamCaption}\item[{system\+::cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*}}]{status }\end{DoxyParamCaption})}



Schedules the next thread to run. 


\begin{DoxyParams}{Parameters}
{\em status} & The current CPU status of the thread \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The next CPU status
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000074}{Todo}}]Remove by reference where possible \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00413}{413}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ current\ state}}
\DoxyCodeLine{00416\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread}{Thread}}*\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}\ =\ m\_threads[m\_next\_thread\_index];}
\DoxyCodeLine{00417\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Process}{Process}}*\ owner\_process\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}{current\_process}}();}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keyword}{auto}\ old\_tid\ =\ m\_next\_thread\_index;}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ executing\ thread\ state}}
\DoxyCodeLine{00421\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}}\ =\ *cpu\_state;}
\DoxyCodeLine{00422\ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a21abe4a5d20033649696849094c415d0}{save\_sse\_state}}();}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}}\ ==\ ThreadState::RUNNING)}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}}\ =\ ThreadState::READY;}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{comment}{//\ Find\ a\ free\ thread\ to\ run}}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordflow}{while}\ ((++m\_next\_thread\_index)\ !=\ old\_tid)\{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ m\_next\_thread\_index\ \%=\ m\_threads.size();}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ current\ thread}}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}\ =\ m\_threads[m\_next\_thread\_index];}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ owner\_process\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_ae6984a0be65698916c382ed9abd9fc79}{current\_process}}();}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Handle\ state\ changes}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a07fecafeda2dc5867ef07db926de4617}{thread\_state}})\ \{}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ThreadState::SLEEPING:}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ wake-\/up\ time\ hasn't\ occurred\ yet,\ run\ the\ next\ thread}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\_time}}\ >\ TICKS\_PER\_EVENT)\{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a2cda049e10651cb61318f38cd88f22e2}{wakeup\_time}}\ -\/=\ \mbox{\hyperlink{scheduler_8h_a16e9836793c1567dfa036940aef3db6d}{TICKS\_PER\_EVENT}};}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ThreadState::STOPPED:}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ the\ process\ that\ has\ the\ thread\ and\ remove\ it}}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ thread:\ owner\_process-\/>threads())\ \{}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (thread\ ==\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}})\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ owner\_process-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_af57385b2fab714504b20e95ceb0a8bbd}{remove\_thread}}(thread-\/>tid);}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ the\ thread}}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_threads.erase(m\_threads.begin()\ +\ m\_next\_thread\_index);}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(owner\_process-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Process_a8595e1ab73f585be41005a6bbd88eb2f}{threads}}().empty())}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a00c2995b3a91021eb4f278a591ff994f}{remove\_process}}(owner\_process);}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ThreadState::WAITING:}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00470\ \ \ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{comment}{//\ Load\ the\ thread's\ state}}
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{return}\ load\_process(owner\_process,\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}});}
\DoxyCodeLine{00474\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00642}{current\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00686}{current\+\_\+thread()}}, \mbox{\hyperlink{process_8h_source_l00065}{Max\+OS\+::processes\+::\+Thread\+::execution\+\_\+state}}, \mbox{\hyperlink{scheduler_8cpp_source_l00579}{remove\+\_\+process()}}, \mbox{\hyperlink{process_8cpp_source_l00267}{Max\+OS\+::processes\+::\+Process\+::remove\+\_\+thread()}}, \mbox{\hyperlink{process_8cpp_source_l00087}{Max\+OS\+::processes\+::\+Thread\+::save\+\_\+sse\+\_\+state()}}, \mbox{\hyperlink{process_8h_source_l00066}{Max\+OS\+::processes\+::\+Thread\+::thread\+\_\+state}}, \mbox{\hyperlink{process_8cpp_source_l00309}{Max\+OS\+::processes\+::\+Process\+::threads()}}, \mbox{\hyperlink{scheduler_8h_source_l00079}{Max\+OS\+::processes\+::\+TICKS\+\_\+\+PER\+\_\+\+EVENT}}, and \mbox{\hyperlink{process_8h_source_l00069}{Max\+OS\+::processes\+::\+Thread\+::wakeup\+\_\+time}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00614}{force\+\_\+remove\+\_\+process()}}, \mbox{\hyperlink{scheduler_8cpp_source_l00384}{schedule()}}, and \mbox{\hyperlink{scheduler_8cpp_source_l00550}{yield()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a3ce2093679daf9acde62bbabc020728e}\label{classMaxOS_1_1processes_1_1Scheduler_a3ce2093679daf9acde62bbabc020728e} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!thread\_amount@{thread\_amount}}
\index{thread\_amount@{thread\_amount}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{thread\_amount()}{thread\_amount()}}
{\footnotesize\ttfamily uint64\+\_\+t Scheduler\+::thread\+\_\+amount (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Gets how many threads are running on this scheduler. 

\begin{DoxyReturn}{Returns}
The amount 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00695}{695}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00696\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_threads.size();}
\DoxyCodeLine{00697\ \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00214}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::add\+\_\+thread()}}.

\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a349f28166719d94bd978439f24cd2448}\label{classMaxOS_1_1processes_1_1Scheduler_a349f28166719d94bd978439f24cd2448} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!ticks@{ticks}}
\index{ticks@{ticks}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{ticks()}{ticks()}}
{\footnotesize\ttfamily uint64\+\_\+t Scheduler\+::ticks (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Gets how long the system has been running for. 

\begin{DoxyReturn}{Returns}
The number of ticks 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00542}{542}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_ticks;}
\DoxyCodeLine{00545\ \}}

\end{DoxyCode}
\Hypertarget{classMaxOS_1_1processes_1_1Scheduler_a4e3cb6c6cc95d62dc6149c0ec934c723}\label{classMaxOS_1_1processes_1_1Scheduler_a4e3cb6c6cc95d62dc6149c0ec934c723} 
\index{MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}!yield@{yield}}
\index{yield@{yield}!MaxOS::processes::Scheduler@{MaxOS::processes::Scheduler}}
\doxysubsubsection{\texorpdfstring{yield()}{yield()}}
{\footnotesize\ttfamily cpu\+\_\+status\+\_\+t \texorpdfstring{$\ast$}{*} Scheduler\+::yield (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Pass execution to the next thread. 



Definition at line \mbox{\hyperlink{scheduler_8cpp_source_l00550}{550}} of file \mbox{\hyperlink{scheduler_8cpp_source}{scheduler.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{comment}{//\ If\ this\ is\ the\ only\ thread,\ can't\ yield}}
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_threads.size()\ <=\ 1)}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}()-\/>\mbox{\hyperlink{classMaxOS_1_1processes_1_1Thread_a920e84f873b5ad33355fbde1fb2d8047}{execution\_state}};}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ current\ thread\ to\ waiting\ if\ running}}
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keyword}{auto}\ thread\ =\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_a4b29a981d21849fa08d64a51a5111932}{current\_thread}}();}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread-\/>thread\_state\ ==\ ThreadState::RUNNING)}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ thread-\/>thread\_state\ =\ ThreadState::READY;}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \textcolor{comment}{//\ Schedule\ the\ next\ thread}}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMaxOS_1_1processes_1_1Scheduler_af0094b696d420844c5475311e556dd70}{schedule\_next}}(\&thread-\/>execution\_state);}
\DoxyCodeLine{00563\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{scheduler_8cpp_source_l00686}{current\+\_\+thread()}}, \mbox{\hyperlink{process_8h_source_l00065}{Max\+OS\+::processes\+::\+Thread\+::execution\+\_\+state}}, \mbox{\hyperlink{scheduler_8cpp_source_l00413}{schedule\+\_\+next()}}, and \mbox{\hyperlink{process_8h_source_l00066}{Max\+OS\+::processes\+::\+Thread\+::thread\+\_\+state}}.



Referenced by \mbox{\hyperlink{scheduler_8cpp_source_l00078}{Max\+OS\+::processes\+::\+Global\+Scheduler\+::yield()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/include/processes/\mbox{\hyperlink{scheduler_8h}{scheduler.\+h}}\item 
/home/runner/work/\+Max\+OS/\+Max\+OS/kernel/src/processes/\mbox{\hyperlink{scheduler_8cpp}{scheduler.\+cpp}}\end{DoxyCompactItemize}
