\hypertarget{kprint_8h}{}\doxysection{/home/runner/work/\+Max\+O\+S/\+Max\+O\+S/kernel/include/common/kprint.h File Reference}
\label{kprint_8h}\index{/home/runner/work/MaxOS/MaxOS/kernel/include/common/kprint.h@{/home/runner/work/MaxOS/MaxOS/kernel/include/common/kprint.h}}
{\ttfamily \#include $<$drivers/console/serial.\+h$>$}\newline
{\ttfamily \#include $<$system/cpu.\+h$>$}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
{\ttfamily \#include $<$common/spinlock.\+h$>$}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}{\+\_\+kprintf}}(format, ...)~\mbox{\hyperlink{kprint_8cpp_a14f76df54d232b9ef72faeed9b247350}{\+\_\+kprintf\+\_\+internal}}(0, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+\_\+, format, \#\#\+\_\+\+\_\+\+V\+A\+\_\+\+A\+R\+G\+S\+\_\+\+\_\+)
\item 
\#define \mbox{\hyperlink{kprint_8h_ad17f4069242d16af16fc559e667f26e1}{\+\_\+kpanicf}}(format, ...)~\mbox{\hyperlink{kprint_8cpp_a14f76df54d232b9ef72faeed9b247350}{\+\_\+kprintf\+\_\+internal}}(2, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+\_\+, format, \#\#\+\_\+\+\_\+\+V\+A\+\_\+\+A\+R\+G\+S\+\_\+\+\_\+)
\item 
\#define \mbox{\hyperlink{kprint_8h_adf7b5d69e4c25995b3211b91b27f33b6}{A\+S\+S\+E\+RT}}(condition,  format, ...)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{kprint_8h_a14f76df54d232b9ef72faeed9b247350}{\+\_\+kprintf\+\_\+internal}} (uint8\+\_\+t \mbox{\hyperlink{icmp_8h_a1d127017fb298b889f4ba24752d08b8e}{type}}, const char $\ast$file, int line, const char $\ast$func, const char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Prints a formatted string to the serial output. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{kprint_8h_ad17f4069242d16af16fc559e667f26e1}\label{kprint_8h_ad17f4069242d16af16fc559e667f26e1}} 
\index{kprint.h@{kprint.h}!\_kpanicf@{\_kpanicf}}
\index{\_kpanicf@{\_kpanicf}!kprint.h@{kprint.h}}
\doxysubsubsection{\texorpdfstring{\_kpanicf}{\_kpanicf}}
{\footnotesize\ttfamily \#define \+\_\+kpanicf(\begin{DoxyParamCaption}\item[{}]{format,  }\item[{}]{... }\end{DoxyParamCaption})~\mbox{\hyperlink{kprint_8cpp_a14f76df54d232b9ef72faeed9b247350}{\+\_\+kprintf\+\_\+internal}}(2, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+\_\+, format, \#\#\+\_\+\+\_\+\+V\+A\+\_\+\+A\+R\+G\+S\+\_\+\+\_\+)}



Definition at line 17 of file kprint.\+h.

\mbox{\Hypertarget{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}\label{kprint_8h_ad0dbdc0814f8a967875ad592df02a663}} 
\index{kprint.h@{kprint.h}!\_kprintf@{\_kprintf}}
\index{\_kprintf@{\_kprintf}!kprint.h@{kprint.h}}
\doxysubsubsection{\texorpdfstring{\_kprintf}{\_kprintf}}
{\footnotesize\ttfamily \#define \+\_\+kprintf(\begin{DoxyParamCaption}\item[{}]{format,  }\item[{}]{... }\end{DoxyParamCaption})~\mbox{\hyperlink{kprint_8cpp_a14f76df54d232b9ef72faeed9b247350}{\+\_\+kprintf\+\_\+internal}}(0, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+\_\+, format, \#\#\+\_\+\+\_\+\+V\+A\+\_\+\+A\+R\+G\+S\+\_\+\+\_\+)}



Definition at line 14 of file kprint.\+h.

\mbox{\Hypertarget{kprint_8h_adf7b5d69e4c25995b3211b91b27f33b6}\label{kprint_8h_adf7b5d69e4c25995b3211b91b27f33b6}} 
\index{kprint.h@{kprint.h}!ASSERT@{ASSERT}}
\index{ASSERT@{ASSERT}!kprint.h@{kprint.h}}
\doxysubsubsection{\texorpdfstring{ASSERT}{ASSERT}}
{\footnotesize\ttfamily \#define A\+S\+S\+E\+RT(\begin{DoxyParamCaption}\item[{}]{condition,  }\item[{}]{format,  }\item[{}]{... }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{    \textcolor{keywordflow}{if}(!(condition)) \(\backslash\)}
\DoxyCodeLine{        \_kprintf\_internal(3, \_\_FILE\_\_, \_\_LINE\_\_, \_\_FUNCTION\_\_, format, \#\#\_\_VA\_ARGS\_\_);}

\end{DoxyCode}


Definition at line 20 of file kprint.\+h.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{kprint_8h_a14f76df54d232b9ef72faeed9b247350}\label{kprint_8h_a14f76df54d232b9ef72faeed9b247350}} 
\index{kprint.h@{kprint.h}!\_kprintf\_internal@{\_kprintf\_internal}}
\index{\_kprintf\_internal@{\_kprintf\_internal}!kprint.h@{kprint.h}}
\doxysubsubsection{\texorpdfstring{\_kprintf\_internal()}{\_kprintf\_internal()}}
{\footnotesize\ttfamily void \+\_\+kprintf\+\_\+internal (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{type,  }\item[{const char $\ast$}]{file,  }\item[{int}]{line,  }\item[{const char $\ast$}]{func,  }\item[{const char $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})}



Prints a formatted string to the serial output. 

A\+R\+G\+U\+M\+E\+N\+TS\+:
\begin{DoxyItemize}
\item d for decimal
\item x for hex
\item u for unsigned decimal
\item s for string
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em format} & The formatted string \\
\hline
{\em ...} & The data to pass into the string \\
\hline
\end{DoxyParams}


Definition at line 170 of file kprint.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{171 \{}
\DoxyCodeLine{172 }
\DoxyCodeLine{173   \textcolor{comment}{// wait for the lock}}
\DoxyCodeLine{174   \mbox{\hyperlink{kprint_8cpp_a3487c372392ab5759655b8843f4b7cf1}{kprintf\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a27a03c3d6b4cdd677e7d16e59689e38e}{lock}}();}
\DoxyCodeLine{175 }
\DoxyCodeLine{176   \textcolor{comment}{// Create a pointer to the data}}
\DoxyCodeLine{177   va\_list parameters;}
\DoxyCodeLine{178   va\_start(parameters, format);}
\DoxyCodeLine{179 }
\DoxyCodeLine{180   \textcolor{comment}{// Print the header if the first two are not \%h}}
\DoxyCodeLine{181   \textcolor{keywordflow}{if}(*format != \textcolor{charliteral}{'\%'} \&\& *(format + 1) != \textcolor{charliteral}{'h'})}
\DoxyCodeLine{182     \mbox{\hyperlink{kprint_8cpp_a1eac1ff253b261e89fa89e29c6bd6c24}{pre\_kprintf}}(file, line,func, \mbox{\hyperlink{apic_8h_a1d127017fb298b889f4ba24752d08b8e}{type}});}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 }
\DoxyCodeLine{185   \textcolor{comment}{// Loop through the format string}}
\DoxyCodeLine{186   \textcolor{keywordflow}{for} (; *format != \textcolor{charliteral}{'\(\backslash\)0'}; format++)}
\DoxyCodeLine{187   \{}
\DoxyCodeLine{188 }
\DoxyCodeLine{189     \textcolor{comment}{// If it is not a \%, print the character}}
\DoxyCodeLine{190     \textcolor{keywordflow}{if} (*format != \textcolor{charliteral}{'\%'})}
\DoxyCodeLine{191     \{}
\DoxyCodeLine{192       putchar(*format, \mbox{\hyperlink{apic_8h_a1d127017fb298b889f4ba24752d08b8e}{type}} == 2);}
\DoxyCodeLine{193       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{194     \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196     \textcolor{comment}{// Move to the next character}}
\DoxyCodeLine{197     format++;}
\DoxyCodeLine{198 }
\DoxyCodeLine{199     \textcolor{keywordflow}{switch} (*format)}
\DoxyCodeLine{200     \{}
\DoxyCodeLine{201       \textcolor{keywordflow}{case} \textcolor{charliteral}{'d'}:}
\DoxyCodeLine{202       \{}
\DoxyCodeLine{203         \textcolor{comment}{// Print a decimal}}
\DoxyCodeLine{204         \textcolor{keywordtype}{int} number = va\_arg (parameters, \textcolor{keywordtype}{int});}
\DoxyCodeLine{205         \textcolor{keywordtype}{char}* str = \mbox{\hyperlink{kprint_8cpp_a61162f966722da75c036049e8ca8bf8b}{itoa}}(10, number);}
\DoxyCodeLine{206         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} = 0; \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} < \mbox{\hyperlink{kprint_8cpp_ae6c8de953239811a34eeeab09458e55e}{strlen}}(str); \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}++)}
\DoxyCodeLine{207           putchar(str[\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}], \mbox{\hyperlink{apic_8h_a1d127017fb298b889f4ba24752d08b8e}{type}} == 2);}
\DoxyCodeLine{208         \textcolor{keywordflow}{break};}
\DoxyCodeLine{209       \}}
\DoxyCodeLine{210       \textcolor{keywordflow}{case} \textcolor{charliteral}{'x'}:}
\DoxyCodeLine{211       \{}
\DoxyCodeLine{212         \textcolor{comment}{// Print a hex}}
\DoxyCodeLine{213         uint64\_t  number = va\_arg (parameters, uint64\_t );}
\DoxyCodeLine{214         \textcolor{keywordtype}{char}* str = \mbox{\hyperlink{kprint_8cpp_a61162f966722da75c036049e8ca8bf8b}{itoa}}(16, number);}
\DoxyCodeLine{215         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} = 0; \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} < \mbox{\hyperlink{kprint_8cpp_ae6c8de953239811a34eeeab09458e55e}{strlen}}(str); \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}++)}
\DoxyCodeLine{216           putchar(str[\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}], \mbox{\hyperlink{apic_8h_a1d127017fb298b889f4ba24752d08b8e}{type}} == 2);}
\DoxyCodeLine{217         \textcolor{keywordflow}{break};}
\DoxyCodeLine{218       \}}
\DoxyCodeLine{219       \textcolor{keywordflow}{case} \textcolor{charliteral}{'s'}:}
\DoxyCodeLine{220       \{}
\DoxyCodeLine{221         \textcolor{comment}{// Print a string}}
\DoxyCodeLine{222         \textcolor{keywordtype}{char}* str = va\_arg (parameters, \textcolor{keywordtype}{char}*);}
\DoxyCodeLine{223         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} = 0; \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}} < \mbox{\hyperlink{kprint_8cpp_ae6c8de953239811a34eeeab09458e55e}{strlen}}(str); \mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}++)}
\DoxyCodeLine{224           putchar(str[\mbox{\hyperlink{namespaceMaxOS_1_1drivers_1_1peripherals_a891861cdf457ecedb7e3a5fa56515ebcaf552e09750e0ce71af8fc4fa0b32b8ff}{i}}], \mbox{\hyperlink{apic_8h_a1d127017fb298b889f4ba24752d08b8e}{type}} == 2);}
\DoxyCodeLine{225         \textcolor{keywordflow}{break};}
\DoxyCodeLine{226       \}}
\DoxyCodeLine{227     \}}
\DoxyCodeLine{228   \}}
\DoxyCodeLine{229 }
\DoxyCodeLine{230   \mbox{\hyperlink{kprint_8cpp_a3487c372392ab5759655b8843f4b7cf1}{kprintf\_lock}}.\mbox{\hyperlink{classMaxOS_1_1common_1_1Spinlock_a7c26334ccfa43ef932ef3c73e2c11492}{unlock}}();}
\DoxyCodeLine{231 }
\DoxyCodeLine{232   \textcolor{comment}{// If it is type 3 panic}}
\DoxyCodeLine{233   \textcolor{keywordflow}{if}(\mbox{\hyperlink{apic_8h_a1d127017fb298b889f4ba24752d08b8e}{type}} == 3)}
\DoxyCodeLine{234      CPU::PANIC(\textcolor{stringliteral}{"Check the serial output for more information"});}
\DoxyCodeLine{235 \}}

\end{DoxyCode}


References kprintf\+\_\+lock, Max\+O\+S\+::common\+::\+Spinlock\+::lock(), pre\+\_\+kprintf(), and type.

